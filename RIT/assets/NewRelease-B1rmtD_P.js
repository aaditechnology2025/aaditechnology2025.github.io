import{u as f,A as U,a as l,b as D,r,c as p,t as c,d as g,g as N,e as h,j as t,f as d}from"./index-CpZD2H93.js";import x from"./UpgradeApp-BZLkTvFx.js";import"./CardStyle-CBuNm0_N.js";import"./Card-B0aZ7mGs.js";const C=()=>{const o=f(),i=U();let u=window.localStorage.getItem("deviceType")==="ios"?l:D;const[I,S]=r.useState(!1),e=p(s=>s.NewRelease.Release),a=p(s=>s.userLoginExpires.UserLoginExpires),m="https://apps.apple.com/in/app/riteschool/id1036759360",n=localStorage.getItem("localSchoolId"),w=sessionStorage.getItem("RoleId"),V=sessionStorage.getItem("Id"),L=sessionStorage.getItem("AcademicYearId"),A=sessionStorage.getItem("LastPasswordChangeDate"),R=localStorage.getItem("LoginVersion");return r.useEffect(()=>{a!=null&&(a.IsLogoutRequired=="Y"&&(c.success(a.Message,{toastId:"success1"}),o(g()),sessionStorage.clear(),localStorage.removeItem("auth"),i("/")),o(g()));const s={asDeviceType:d,asUserCurrentVersion:d=="iOS"?l:u,aiSchoolId:parseInt(n),asOldLoginVersion:R};o(N(s))},[a]),r.useEffect(()=>{o(h({asSchoolId:n,asUserId:V,asAcademicYearId:L,asUserRoleId:w,asLastPasswordChangeDate:A}))},[]),r.useEffect(()=>{if((e==null?void 0:e.GetNewAppVersionDetailsResult)!=null){e.GetNewAppVersionDetailsResult.Version!=null&&e.GetNewAppVersionDetailsResult.Version!=""&&S(!0),localStorage.setItem("NewVersionDetails",JSON.stringify(e.GetNewAppVersionDetailsResult)),e.GetNewAppVersionDetailsResult.IsForceUpdate==="True"&&i("../../../UpgradeApp");let s=e.LoginVersionDetails.LatestLoginVersion;s!==localStorage.getItem("LoginVersion")||localStorage.getItem("LoginVersion")===null?(c.success("Please login again",{toastId:"success1"}),localStorage.clear(),sessionStorage.clear(),localStorage.setItem("LoginVersion",s),i("/")):localStorage.setItem("LoginVersion",s)}},[e]),t.jsx(t.Fragment,{children:I&&e.GetNewAppVersionDetailsResult.DeviceType.toLowerCase()===(window.localStorage.getItem("deviceType")==="ios"?"APPLE":"android").toLowerCase()&&t.jsx(t.Fragment,{children:t.jsx(x,{IsForceUpdate:e.GetNewAppVersionDetailsResult.IsForceUpdate,AppStoreUrl:window.localStorage.getItem("deviceType")==="ios"?m:e.GetNewAppVersionDetailsResult.AppStoreUrl,ReleaseNotes:e.GetNewAppVersionDetailsResult.ReleaseNotes})})})};export{C as default};

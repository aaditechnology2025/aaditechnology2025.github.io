import{cj as Ts,j as e,B as p,G as n,q as Bs,bR as ge,aI as zs,H as B,I as U,du as $s,A as ze,u as $e,ag as Ps,r as o,c as v,an as Us,al as Pe,am as x,as as re,at as fe,T as me,L as Ue,a2 as Fs,a3 as Es,bl as Ys,a5 as Hs,dF as Os,ai as Vs,c8 as Ws,aj as qs,ak as Ns,V as oe,W as ne,a8 as O,bv as ae,s as Fe,S as Ee,E as Gs,dG as Ks,t as V,dH as Js,dI as M,dJ as Qs,dK as Xs,F as Zs,J as se,K as et,bf as st,C as Ae,n as tt,dL as rt,di as at,dM as ot,dN as nt,dO as _e,dP as lt}from"./index-d5YOjbb6.js";import{d as Le}from"./AddCircle-8gfCxOOJ.js";import{d as it}from"./KeyboardArrowUpRounded-Ddmjzrt1.js";import{d as ct}from"./Refresh-BEEftxLF.js";import{M as dt}from"./MoveToTrash-CffFWm0b.js";import{d as J}from"./ArrowCircleUp-BmCXupv-.js";import{C as Ye}from"./CheckboxImg-DSBDgE-_.js";import{d as xt}from"./Attachment-DgcWq5kr.js";import{d as He}from"./Drafts-D2zBX4QU.js";import{d as ht}from"./Schedule-BBlNlsPv.js";import{b as ut,m as pt,C as gt,L as mt,R as ft}from"./CardStyle-B9qFmFtz.js";import{A as Q}from"./ArrowCircleDown-BpJDJL07.js";import{T as jt,D as It}from"./CommonStyle-DTS3LGaG.js";import{d as St}from"./MarkEmailRead-DAHwT9Xj.js";import{d as Ct}from"./Inbox-CbNHDRfn.js";import{d as Dt}from"./Send-DezDvM8X.js";import{C as je}from"./Card-BrM9kpJu.js";import{B as Te}from"./Badge-pVfrdshX.js";import bt from"./EmailSetting-BE_DRcbu.js";import{H as Be}from"./Hidden-CZZHX81z.js";import"./RadioButtonUnchecked-DyWPxD5p.js";import"./Errormessage-RPRSgLGN.js";import"./BackButton-BE5_8L9j.js";const wt=Ts(e.jsx("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"}),"Email"),vt=({AcademicYearList:a,MonthYearList:h,operatorArray:t,clickSearch:g,academicYear:d,monthYear:c,operator:m,searchDate:j,searchText:R,clickAcademicYear:l,clickMonthYear:k,clickOperator:i,clickDate:f,textOnChange:y,isSearchClicked:r,CloseSearchBar:C,activeTab:A})=>{const _=I=>{d=I,l(I)},z=I=>{c=I,k(I)},$=()=>{g(R,d,c,m,j,!r)};return e.jsx(e.Fragment,{children:A!="Draft"&&e.jsx(p,{sx:{p:2,backgroundColor:"white",mb:1},children:e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:12,md:12,children:e.jsx(Bs,{id:"standard-basic",label:"Name / Subject / Message Body ",fullWidth:!0,onChange:y,value:R,inputProps:{maxLength:50},size:"medium",onKeyDown:I=>{(I.key==="Enter"||I.key==="Tab")&&$()}})}),e.jsx(n,{item:!0,xs:12,md:2.8,children:e.jsx(ge,{ItemList:a,onChange:_,label:"Select Academic Year",defaultValue:d,size:"medium",sx:{width:"100%"}})}),e.jsx(n,{item:!0,xs:12,md:2.8,children:e.jsx(ge,{ItemList:h,onChange:z,label:"Month",defaultValue:c,size:"medium",sx:{width:"100%"}})}),e.jsx(n,{item:!0,xs:12,md:2.8,children:e.jsx(p,{children:e.jsx(ge,{ItemList:t,onChange:i,label:"Operator",defaultValue:m,size:"medium",sx:{width:"100%"}})})}),e.jsx(n,{item:!0,xs:9,sm:2.8,children:e.jsx(zs,{DateValue:j,onDateChange:f,label:"",size:"medium"})}),e.jsx(n,{item:!0,xs:1,sm:.8,children:e.jsx(B,{title:"Search",children:e.jsx(U,{onClick:$,sx:{background:I=>I.palette.primary.main,color:"white",mt:1,ml:2,"&:hover":{backgroundColor:I=>I.palette.primary.dark}},children:e.jsx($s,{})})})})]})})})},kt=({text1:a,text2:h})=>e.jsxs(p,{p:1,children:[e.jsxs(ut,{children:[" ",e.jsxs(pt,{children:[e.jsx("b",{children:"User Name: "}),h]})]}),e.jsxs(gt,{children:[e.jsx("b",{children:"Read Date/Time: "}),a," "]})]});function yt({header:a,text1:h,text2:t,text3:g,DetailsId:d,ActiveTab:c,IsRead:m,IsSchedule:j,IsAttachmentExist:R,HasReadReceipt:l,RequestReadReceipt:k,NavPath:i,Id:f,isActive:y,onChange:r,DeleteDraft:C}){const A=ze(),_=$e(),z=Ps(),$=localStorage.getItem("localSchoolId"),I=sessionStorage.getItem("AcademicYearId"),[F,P]=o.useState(!1),[le,W]=o.useState(!0),b=v(D=>D.MessageCenter.ReadReceiptDetails),E={aiSchoolId:$,aiAcademicYearId:I,aiMessageDetailId:d},ie=D=>{D.stopPropagation(),P(!0),_(Os(E)),W(!1)},q=D=>{P(!1)},L=()=>{le&&A("/"+z.pathname.split("/")[1]+"/MessageCenter/viewMSg/"+i),W(!0)};let ce=(c=="Inbox"||c=="Trash")&&m=="N"||c=="Sent"&&j?"blue":"";return e.jsx(Us,{children:e.jsxs(Pe,{children:[e.jsx(x,{sx:{textAlign:"left",width:"40px",py:.5},children:c!=="Draft"?e.jsx(Ye,{name:f,value:f,checked:y,onChange:r}):e.jsx(B,{title:"Delete",children:e.jsx(U,{onClick:()=>C(f),sx:{color:"#38548A",cursor:"pointer","&:hover":{color:"red",backgroundColor:re[100]}},children:e.jsx(fe,{})})})}),e.jsx(x,{onClick:L,sx:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"150px"},children:e.jsx(B,{title:a,sx:{py:.5},children:e.jsx(me,{sx:{color:ce,fontSize:{xs:"14px",sm:"14px"},fontFamily:"Roboto"},children:a.length>20?`${a.substring(0,20)}...`:a})})}),e.jsx(x,{onClick:L,sx:{py:.5,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"150px"},children:h}),(c==="Trash"||c==="Sent")&&e.jsx(x,{onClick:L,sx:{py:.5,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"150px"},children:g}),c==="Inbox"&&e.jsxs(x,{onClick:L,sx:{py:.5,textAlign:"center"},children:[" ",R?e.jsx(xt,{}):"-"," "]}),c==="Sent"&&e.jsx(x,{sx:{py:.5,textAlign:"center"},children:k==="True"&&l?e.jsxs(e.Fragment,{children:[e.jsx(B,{title:"View",children:e.jsx(U,{onClick:D=>ie(D),sx:{color:"#38548A","&:hover":{color:"green",backgroundColor:Ue[100]}},children:e.jsx(He,{fontSize:"small"})})}),e.jsxs(Fs,{open:F,maxWidth:"md",onClose:()=>P(!1),PaperProps:{sx:{borderRadius:"15px"}},children:[e.jsx(Es,{sx:{bgcolor:"#223354",color:D=>D.palette.common.white},children:e.jsx(Ys,{onClick:q,sx:{color:"white",borderRadius:"7px",position:"absolute",top:"5px",right:"7px",cursor:"pointer","&:hover":{color:"red"}}})}),e.jsx(Hs,{children:e.jsx(p,{sx:{maxHeight:"300px",position:"relative",background:"white"},children:b.map((D,X)=>e.jsx("div",{children:e.jsx(kt,{text1:D.ReadingDateTime,text2:D.UserName})},X))})})]})]}):k==="True"&&e.jsx(B,{title:"Requested",children:e.jsxs(U,{children:[" ",e.jsx(wt,{fontSize:"small",color:"error"})," "]})})}),e.jsxs(x,{onClick:L,sx:{py:.5,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"150px"},children:[t,j&&e.jsx(ht,{fontSize:"small",color:"primary"})]})]})})}const Mt=({Itemlist:a,refreshData:h,ActiveTab:t,DeleteDraft:g,clickSortExp:d,clickSortDirection:c,SortExp:m,SortDirection:j})=>{const R=r=>{a=a.map(C=>C.Id===r.name?{...C,isActive:r.checked}:C),h(a)},[l,k]=o.useState("");o.useEffect(()=>{t==="Inbox"||t==="Trash"?k("Received Date"):t==="Sent"?k("Sent Date"):t==="Draft"&&k("Draft Date")},[t]);const i=r=>{if(r==="Subject")return!0;if(r==="Cc"){if(t==="Sent")return!0}else if(r==="Cc1"){if(t==="Trash")return!0}else{if(r==="Attachment"&&t==="Inbox")return!0;if(r==="Date")return!0;if(r==="From"){if(t==="Inbox")return!0}else if(r==="From1"){if(t==="Trash")return!0}else if(r==="To"){if(t==="Sent")return!0}else if(r==="Read Receipt Information"){if(t==="Sent")return!0}else if(r==="Message Body"){if(t==="Draft")return!0}else if(r==="Delete"){if(t==="Draft")return!0}else if(r==="Received Date"){if(t==="Inbox")return!0}else if(r==="Received Date1"){if(t==="Trash")return!0}else if(r==="Draft Date"){if(t==="Draft")return!0}else if(r==="Sent Date"&&t==="Sent")return!0}return!1},f=r=>{c(j=="ASC"?"DESC":"ASC"),d(r)},y=r=>{a=a.map(C=>({...C,isActive:r})),h(a)};return e.jsx(p,{sx:{textAlign:"center",backgroundColor:"white"},children:e.jsx(Vs,{component:Ws,children:e.jsxs(qs,{sx:{border:r=>`1px solid ${r.palette.grey[300]}`,overflow:"hidden"},children:[e.jsx(Ns,{children:e.jsxs(Pe,{sx:{background:r=>r.palette.secondary.main},children:[t!=="Draft"&&e.jsx(x,{sx:{color:"white",py:1.5,whiteSpace:"nowrap"},children:e.jsx(Ye,{name:"All",value:"All",checked:a.every(r=>r.isActive===!0),onChange:r=>{y(r.checked)}})}),i("Delete")&&e.jsx(x,{sx:{color:"white",py:1.5,whiteSpace:"nowrap",cursor:"default"},children:e.jsx("strong",{children:"Delete"})}),i("Subject")&&e.jsx(x,{onClick:()=>{f("Subject")},sx:{color:"white",py:1.5,whiteSpace:"nowrap",cursor:"pointer"},children:e.jsxs(p,{sx:{display:"flex",alignItems:"center"},children:[e.jsx("strong",{children:"Subject"}),m==="Subject"?j==="ASC"?e.jsx(Q,{sx:{ml:.5}}):e.jsx(J,{sx:{ml:.5}}):null]})}),i("To")&&e.jsx(x,{sx:{color:"white",py:1.5,whiteSpace:"nowrap",cursor:"default"},children:e.jsx("strong",{children:"To"})}),i("Cc")&&e.jsxs(x,{sx:{color:"white",py:1.5,whiteSpace:"nowrap",cursor:"default"},children:[" ",e.jsx("strong",{children:"Cc"})," "]}),i("Read Receipt Information")&&e.jsxs(x,{sx:{color:"white",py:1.5,textAlign:"center",cursor:"default"},children:[" ",e.jsx("strong",{children:"Read Receipt Information"})," "]}),i("Message Body")&&e.jsx(x,{sx:{color:"white",py:1.5,width:"60%",whiteSpace:"nowrap",cursor:"default"},children:e.jsx("strong",{children:" Message Body"})}),i("From")&&e.jsxs(x,{sx:{color:"white",py:1.5,whiteSpace:"nowrap",cursor:"default"},children:[" ",e.jsx("strong",{children:"From"})," "]}),i("From1")&&e.jsxs(x,{sx:{color:"white",py:1.5,whiteSpace:"nowrap",cursor:"default"},children:[" ",e.jsx("strong",{children:"From"})," "]}),i("Cc1")&&e.jsxs(x,{sx:{color:"white",py:1.5,whiteSpace:"nowrap",cursor:"default"},children:[" ",e.jsx("strong",{children:"Cc"})," "]}),i("Attachment")&&e.jsxs(x,{sx:{color:"white",py:1.5,textAlign:"center",whiteSpace:"nowrap",cursor:"default"},children:[e.jsx("strong",{children:" Attachment"})," "]}),i("Received Date")&&e.jsx(x,{onClick:()=>{f("Insert_Date")},sx:{color:"white",py:1.5,whiteSpace:"nowrap",cursor:"pointer"},children:e.jsxs(p,{sx:{display:"flex",alignItems:"center"},children:[" ",e.jsx("strong",{children:"Received Date"}),m==="Insert_Date"?j==="ASC"?e.jsx(Q,{sx:{ml:.5}}):e.jsx(J,{sx:{ml:.5}}):null]})}),i("Received Date1")&&e.jsx(x,{onClick:()=>{f("Insert_Date")},sx:{color:"white",py:1.5,whiteSpace:"nowrap",cursor:"pointer"},children:e.jsxs(p,{sx:{display:"flex",alignItems:"center"},children:[e.jsx("strong",{children:" Received Date"}),m==="Insert_Date"?j==="ASC"?e.jsx(Q,{sx:{ml:.5}}):e.jsx(J,{sx:{ml:.5}}):null]})}),i("Sent Date")&&e.jsx(x,{onClick:()=>{f("Insert_Date")},sx:{color:"white",py:1.5,whiteSpace:"nowrap",cursor:"pointer"},children:e.jsxs(p,{sx:{display:"flex",alignItems:"center"},children:[e.jsx("strong",{children:" Sent Date"}),m==="Insert_Date"?j==="ASC"?e.jsx(Q,{sx:{ml:.5}}):e.jsx(J,{sx:{ml:.5}}):null]})}),i("Draft Date")&&e.jsx(x,{onClick:()=>{f("Insert_Date")},sx:{color:"white",py:1.5,whiteSpace:"nowrap",cursor:"pointer"},children:e.jsxs(p,{sx:{display:"flex",alignItems:"center"},children:[" ",e.jsx("strong",{children:"Draft Date"}),m==="Insert_Date"?j==="ASC"?e.jsx(Q,{sx:{ml:.5}}):e.jsx(J,{sx:{ml:.5}}):null]})})]})}),a.map((r,C)=>e.jsx(yt,{header:r.text1,text1:r.text2,text2:r.text3,text3:r.text4,ActiveTab:t,IsRead:r.IsRead,IsSchedule:r.IsSchedule,HasReadReceipt:r.HasReadReceipt,RequestReadReceipt:r.RequestReadReceipt,IsAttachmentExist:r.IsAttachmentExist,DetailsId:r.DetailsId,NavPath:r.NavPath,Id:r.Id,isActive:r.isActive,onChange:R,DeleteDraft:g},C))]})})})};var Ie={},Rt=ne;Object.defineProperty(Ie,"__esModule",{value:!0});var Oe=Ie.default=void 0,At=Rt(oe()),_t=e,Lt=(0,At.default)((0,_t.jsx)("path",{d:"M5 13h14v-2H5v2zm-2 4h14v-2H3v2zM7 7v2h14V7H7z"}),"ClearAll");Oe=Ie.default=Lt;var Se={},Tt=ne;Object.defineProperty(Se,"__esModule",{value:!0});var Ve=Se.default=void 0,Bt=Tt(oe()),zt=e,$t=(0,Bt.default)((0,zt.jsx)("path",{d:"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z"}),"Markunread");Ve=Se.default=$t;var Ce={},Pt=ne;Object.defineProperty(Ce,"__esModule",{value:!0});var We=Ce.default=void 0,Ut=Pt(oe()),Ft=e,Et=(0,Ut.default)((0,Ft.jsx)("path",{d:"M19 4h-3.5l-1-1h-5l-1 1H5v2h14zM6 7v12c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zm8 7v4h-4v-4H8l4-4 4 4h-2z"}),"RestoreFromTrash");We=Ce.default=Et;var De={},Yt=ne;Object.defineProperty(De,"__esModule",{value:!0});var qe=De.default=void 0,Ht=Yt(oe()),Ot=e,Vt=(0,Ht.default)((0,Ot.jsx)("path",{d:"M7.11 8.53 5.7 7.11C4.8 8.27 4.24 9.61 4.07 11h2.02c.14-.87.49-1.72 1.02-2.47zM6.09 13H4.07c.17 1.39.72 2.73 1.62 3.89l1.41-1.42c-.52-.75-.87-1.59-1.01-2.47zm1.01 5.32c1.16.9 2.51 1.44 3.9 1.61V17.9c-.87-.15-1.71-.49-2.46-1.03L7.1 18.32zM13 4.07V1L8.45 5.55 13 10V6.09c2.84.48 5 2.94 5 5.91s-2.16 5.43-5 5.91v2.02c3.95-.49 7-3.85 7-7.93s-3.05-7.44-7-7.93z"}),"RotateLeft");qe=De.default=Vt;function Wt({TrashDelete:a,clickReset:h,activeTab:t,ConfirmUndelete:g,DeletePermanent:d,clickDelete:c,clickReadUnread:m}){return e.jsx(p,{children:e.jsxs(n,{gap:1,sx:{p:1,display:"flex",backgroundColor:"white",borderRadius:"10px"},children:[t=="Sent"?e.jsx(n,{item:!0,xs:5.5,sm:6,md:0,lg:2,children:e.jsx(O,{onClick:t=="Sent"&&d,endIcon:e.jsx(Oe,{}),fullWidth:!0,sx:{color:"#38548A",width:"210px","&:hover":{color:"red",backgroundColor:re[100]}},children:"Delete From Everyone"})}):t=="Trash"&&e.jsx(n,{item:!0,xs:5.5,sm:6,md:3,lg:1.5,children:e.jsx(O,{onClick:g,endIcon:e.jsx(We,{}),fullWidth:!0,sx:{borderRadius:"0px",color:"#38548A","&:hover":{color:"red",backgroundColor:re[100]}},children:"Un-Delete"})}),e.jsx(n,{item:!0,xs:3.5,sm:3,md:1.5,lg:1,pl:1,children:e.jsx(O,{fullWidth:!0,onClick:t=="Trash"?a:c,endIcon:e.jsx(fe,{}),sx:{color:"#38548A","&:hover":{color:"red",backgroundColor:re[100]}},children:"Delete"})}),e.jsx(n,{item:!0,xs:3,sm:3,md:1.5,lg:1,children:e.jsx(O,{fullWidth:!0,onClick:h,endIcon:e.jsx(qe,{}),sx:{color:"#38548A","&:hover":{color:"blue",backgroundColor:ae[100]}},children:"Reset"})}),e.jsx(n,{children:(t==="Inbox"||t==="Trash")&&e.jsxs(n,{children:[e.jsxs(O,{endIcon:e.jsx(Ve,{}),onClick:()=>{m("Unread")},sx:{color:"#38548A","&:hover":{color:"blue",backgroundColor:ae[100]}},children:[" ","Mark as Unread"," "]}),e.jsxs(O,{endIcon:e.jsx(St,{}),onClick:()=>{m("Read")},sx:{color:"#38548A","&:hover":{color:"green",backgroundColor:Ue[100]}},children:[" ","Mark as Read"]})]})})]})})}Fe(je)(({theme:a})=>({backgroundColor:a.palette.mode==="dark"?"#1A2027":"#fff",...a.typography.body2,padding:a.spacing(1),textAlign:"center",height:"61px",boxShadow:" 5px 5px 10px rgba(163, 177, 198, 0.3), -5px -5px 10px rgba(255, 255, 255, 0.2)",color:a.palette.text.secondary}));const te=({ButtonType:a,clickTab:h,activeTab:t,MarkAsRead:g,TrashReadMessage:d})=>{const c=Ee();return window.location.pathname.replace("/RITeSchool/MessageCenter/msgCenter/",""),e.jsx(e.Fragment,{children:e.jsxs(mt,{color:t==a?"secondary":"primary",onClick:()=>{h(a)},sx:jt,children:[a==="Inbox"?e.jsx(Te,{badgeContent:g,color:"error",children:e.jsx(Ct,{className:c.IconSize})}):a==="Sent"?e.jsx(Dt,{className:c.IconSize}):a==="Trash"?e.jsx(Te,{badgeContent:d,color:"error",children:e.jsx(fe,{className:c.IconSize})}):a==="Draft"?e.jsx(He,{className:c.IconSize}):null,e.jsx("br",{}),e.jsx("b",{children:a})]})})},qt=({activeTab:a,clickTab:h,MarkAsRead:t,TrashReadMessage:g})=>e.jsx("div",{children:e.jsxs(n,{container:!0,spacing:{xs:1,sm:0},direction:{xs:"row",sm:"column"},children:[e.jsx(n,{item:!0,xs:3,sx:{textAlign:"center",color:"#38548A",cursor:"pointer"},children:e.jsx(te,{ButtonType:"Inbox",clickTab:h,activeTab:a,MarkAsRead:t,TrashReadMessage:g})}),e.jsx(n,{item:!0,xs:3,sx:{textAlign:"center",color:"#38548A",cursor:"pointer"},children:e.jsx(te,{ButtonType:"Sent",clickTab:h,activeTab:a,MarkAsRead:t,TrashReadMessage:g})}),e.jsx(n,{item:!0,xs:3,sx:{textAlign:"center",color:"#38548A",cursor:"pointer"},children:e.jsx(te,{ButtonType:"Trash",clickTab:h,activeTab:a,MarkAsRead:t,TrashReadMessage:g})}),e.jsx(n,{item:!0,xs:3,sx:{textAlign:"center",color:"#38548A",cursor:"pointer"},children:e.jsx(te,{ButtonType:"Draft",clickTab:h,activeTab:a,MarkAsRead:t,TrashReadMessage:g})})]})});function Nt({activeTab:a,clickSearchIcon:h,clickTab:t,MarkAsRead:g,TrashReadMessage:d}){return e.jsx("div",{children:e.jsx(n,{container:!0,children:e.jsx(n,{item:!0,xs:10,sm:12,children:e.jsx(qt,{activeTab:a,clickTab:t,MarkAsRead:g,TrashReadMessage:d})})})})}const Gt=Fe(je)(({theme:a})=>({backgroundColor:a.palette.mode==="dark"?"#1A2027":"#fff",...a.typography.body2,padding:a.spacing(1),textAlign:"center",height:"61px",color:"black",boxShadow:"0px 8px 15px rgba(0, 0, 0, 0.1)"})),Kt=2,Sr=()=>{var Me,Re;const a=window.location.pathname,h=a.indexOf("/RITeSchool/MessageCenter/msgCenter/")===-1?a.replace("/RITeSchool/MessageCenter/msgCenter",""):a.replace("/RITeSchool/MessageCenter/msgCenter/",""),t=$e(),g=Ee(),d=localStorage.getItem("localSchoolId"),c=sessionStorage.getItem("AcademicYearId"),m=sessionStorage.getItem("Id"),[j,R]=o.useState(Kt),[l,k]=o.useState(""),[i,f]=o.useState(""),[y,r]=o.useState(""),[C,A]=o.useState(""),[_,z]=o.useState("="),[$,I]=o.useState(!1),[F,P]=o.useState(""),[le,W]=o.useState(!1),[b,E]=o.useState([]);o.useState(!1),o.useState(),o.useState(!0);const[ie,q]=o.useState("none"),[L,ce]=o.useState(!1),[D,X]=o.useState(!1),[Jt,be]=o.useState(!1),{showAlert:Z,closeAlert:T}=o.useContext(Gs),Ne=v(s=>s.MessageCenter.YearsList),Ge=v(s=>s.MessageCenter.AllMonthList),N=v(s=>s.InboxMessage.InboxList),Ke=v(s=>s.InboxMessage.UnReadMessage),de=v(s=>s.InboxMessage.trashUnReadMessage),ee=v(s=>s.InboxMessage.TotalCountLabel),xe=v(s=>s.MessageCenter.ReadUnReadStatus),he=v(s=>s.InboxMessage.NextPageList),Je=v(s=>s.InboxMessage.Loading);v(s=>s.DeleteMessagePermanetly.DeleteMessagePermanentlyList);const ue=v(s=>s.DraftMessages.DeleteDraftMessage),Qe=y==""?"0":y;let Y=0;switch(l){case"Inbox":Y=ee||0;break;case"Sent":Y=((Me=b[0])==null?void 0:Me.TotalCountLabel)||0;break;case"Trash":Y=((Re=b[0])==null?void 0:Re.TotalCountLabel)||ee||0;break;case"Draft":Y=ee||0;break;default:Y=ee||0}const[G,Xe]=o.useState("Insert_Date"),[K,Ze]=o.useState("DESC"),H={asSchoolId:d,asAcademicYearId:i,asUserId:sessionStorage.getItem("Id"),asUserRoleId:sessionStorage.getItem("RoleId"),abIsSMSCenter:"0",asFilter:C,asPageIndex:1,asMonthId:Qe,asOperator:_,asDate:F,asSortExp:G,asSortDirection:K},es=s=>{Xe(s)},ss=s=>{Ze(s)},ts=(s,u)=>({asSchoolId:d,asAcademicYearId:i,asUserId:sessionStorage.getItem("Id"),asUserRoleId:sessionStorage.getItem("RoleId"),abIsSMSCenter:"0",asFilter:s,asPageIndex:1,asMonthId:u}),rs=(s,u)=>({asSchoolId:d,asAcademicYearId:i,asUserId:sessionStorage.getItem("Id"),asUserRoleId:sessionStorage.getItem("RoleId"),abIsSMSCenter:"0",asFilter:"",asPageIndex:1,asMonthId:"0",asDate:""}),as={asSchoolId:d},os={asAcademicYearId:i,asSchoolId:d},we=()=>{window.innerWidth<600?be(!0):be(!1)};window.addEventListener("resize",we),o.useEffect(()=>{we(),t(Ks(as)),k(h===""?"Inbox":h),f(c)},[]),o.useEffect(()=>{xe!==null&&(V.success(xe.UpdationMessage,{toastId:"success1"}),t(Js()),t(M(H,l,!1)))},[xe]),o.useEffect(()=>{E(N)},[N]),o.useEffect(()=>{i!==""&&(t(Qs(os)),r("0"))},[i]),o.useEffect(()=>{i!==""&&t(M(H,l,!1))},[l,$,L,G,K]);const ns=s=>{k(s),R(2)},ls=s=>{f(s),r("")},is=s=>{r(s)},cs=s=>{P(at(s))},ds=s=>{z(s)},xs=s=>{s.target.value.length<=50&&A(s.target.value)},hs=[{Name:"=",Value:"="},{Name:"<",Value:"<"},{Name:"<=",Value:"<="},{Name:">",Value:">"},{Name:">=",Value:">="}],us=()=>{W(!le)},ps=()=>{let s=[];b.map(w=>{w.isActive&&s.push(w.DetailsId)});const u={asSchoolId:d,asAcademicYearId:c,asUserId:m,asMessageIds:s.join(",")};_e.DeleteMessagePermanentlyapi(u).then(w=>{V.success("Message deleted successfully."),t(lt(u)),t(M(H,l,!1))}).catch(w=>{alert("error network")})},gs=s=>{let u=[];b.map(S=>{S.isActive&&u.push(S.ReceiverDetailsId)});const w={aiSchoolId:d,aiAcademicYearId:c,asMessageReceiverIds:u.join(","),aiReceiverUserId:m,abMarkAsRead:s=="Read"?"true":"false"};t(ot(w))},ve=()=>{let s=[],u=[];b.map(S=>{S.isActive&&(s.push(S.DetailsId),u.push(S.ReceiverDetailsId))});const w={asSchoolId:d,asMessageDetailsId:s.join(";"),asMessageRecieverDetailsId:l=="Inbox"||l=="Trash"?u.join(";"):s.join(";"),asIsArchive:"Y",asIsCompeteDelete:l=="Inbox"||l=="Sent"?0:1,asFlag:l};dt.MoveToTrash(w).then(S=>{l=="Inbox"||l=="Sent"?V.success("Message(s) has been moved to the trash."):V.success("Message deleted successfully."),t(M(H,l,!1))}).catch(S=>{alert("error network")})},ms=()=>{Z({title:"Please Confirm",message:"Are you sure you want to delete the selected message(s)?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{T()},onConfirm:()=>{ve(),T()}})},fs=()=>{let s=[],u=[];b.map(S=>{S.isActive&&(s.push(S.DetailsId),u.push(S.ReceiverDetailsId))});const w={asSchoolId:d,asMessageRecieverDetailsIds:u.join(","),asMessageDetailsIds:s.join(",")};_e.UnDeleteMessagesapi(w).then(S=>{V.success("Message(s) undeleted successfully."),t(M(H,l,!1))}).catch(S=>{alert("error network")})},js=()=>{Z({title:"Please Confirm",message:"Are you sure you want to un-delete the selected message(s)?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{T()},onConfirm:()=>{fs(),T()}})},Is=()=>{Z({title:"Please Confirm",message:"This action will permanently delete selected message(s) from the sent message list of the current user as well as from the inbox of all related recipients (if unread). If any recipient reads the message, then that message will be visible in the sent message list of the current user. Do you want to continue?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{T()},onConfirm:()=>{ps(),T()}})},Ss=()=>{E(b.map(s=>({...s,isActive:!1})))},Cs=(s,u,w,S,_s,Ls)=>{A(s),f(u),r(w),z(S),P(_s),I(Ls)},Ds=s=>{E(s)},bs=()=>{ce(!L),A(""),f(c),r(""),z(""),P("")},pe=document.getElementById("ScrollableDiv"),ke=()=>{R(s=>j+1)},ws=s=>{if(s.scrollTop>=400&&q("flex"),s.scrollTop<400&&q("none"),s.scrollHeight-s.scrollTop<=s.clientHeight+5){const u={asSchoolId:d,asAcademicYearId:i,asUserId:sessionStorage.getItem("Id"),asUserRoleId:sessionStorage.getItem("RoleId"),abIsSMSCenter:"0",asFilter:C,asPageIndex:j,asMonthId:y,asOperator:_,asDate:F,asSortExp:G,asSortDirection:K};t(M(u,l,!0)),ke()}};o.useEffect(()=>{he.length>0&&E(s=>[...b,...he])},[he]);const vs=()=>{W(!1),f(c),r(""),A(""),t(l==="Draft"?M(rs(),l,!1):M(ts("",""),l,!1))},ks=s=>{pe.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{q("none")},10)},ys=()=>{const s=pe;pe.scrollTo({top:s.scrollHeight,behavior:"smooth"}),Ms()},Ms=()=>{const s={asSchoolId:d,asAcademicYearId:i,asUserId:sessionStorage.getItem("Id"),asUserRoleId:sessionStorage.getItem("RoleId"),abIsSMSCenter:"0",asFilter:C,asPageIndex:j,asMonthId:y,asOperator:_,asDate:F,asSortExp:G,asSortDirection:K};t(M(s,l,!0)),ke()},ye=()=>{localStorage.setItem("ViewMessageData","")};ze();const Rs=()=>{X(!0)},As=s=>{const u={aiSchoolId:d,aiAcademicYearId:c,aiUserId:sessionStorage.getItem("Id"),aiDraftId:s};Z({title:"Please Confirm",message:"Are you sure you want to delete this record?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{T()},onConfirm:()=>{t(nt(u)),T()}})};return o.useEffect(()=>{ue!==""&&(V.success(ue,{toastId:"success1"}),t(Xs()),t(M(H,l,!1)))},[ue]),e.jsx(e.Fragment,{children:e.jsxs(p,{sx:{px:2},children:[e.jsx(Zs,{navLinks:[{title:"Message Center",path:""}],rightActions:e.jsxs(e.Fragment,{children:[e.jsx(p,{children:e.jsx(B,{title:'Inbox - List of message Received. Select message(s) and click on "Delete" to send the message to trash box. Trash - List of Trash(deleted messages) messages. Select message and click on "Un-Delete" to move the message back to inbox. To permanently delete the message click on "Delete". Sent items - List of messages which you have sent. Select message(s) and click on "Delete" to send the message to trash box.',children:e.jsx(U,{sx:{color:"white",backgroundColor:se[500],height:"36px !important",":hover":{backgroundColor:se[600]}},children:e.jsx(et,{})})})}),e.jsx(p,{children:e.jsxs(Be,{children:[e.jsx(B,{title:"Setting",children:e.jsx(U,{sx:{color:"white",mr:1,backgroundColor:se[500],"&:hover":{backgroundColor:se[600]}},children:e.jsx(st,{onClick:Rs,fontSize:"medium"})})}),e.jsx(B,{title:"Refresh",children:e.jsx(U,{sx:{color:"white",backgroundColor:ae[500],"&:hover":{backgroundColor:ae[600]}},children:e.jsx(ct,{onClick:bs,fontSize:"medium"})})})]})})]})}),e.jsxs(n,{container:!0,columnGap:1,children:[e.jsxs(n,{item:!0,sm:1.3,xs:12,spacing:1,children:[e.jsx(Be,{smDown:!0,children:e.jsx(Ae,{style:{textDecoration:"none",color:"#223354"},to:`/${location.pathname.split("/")[1]}/MessageCenter/Compose`,children:e.jsxs(je,{onClick:ye,sx:{textAlign:"center",height:"80px",backgroundColor:"white",mb:"10px",borderRadius:"5px"},children:[e.jsx(Le,{sx:{mt:"10px",color:"#38548A"},className:g.IconSize}),e.jsx("br",{}),e.jsx("b",{style:{color:"#38548A"},children:"Compose"})]})})}),e.jsx(Nt,{activeTab:l,MarkAsRead:Ke,TrashReadMessage:de==null?void 0:de.UnreadMessageTotalCount,clickTab:ns,clickSearchIcon:us})]}),e.jsxs(n,{container:!0,sm:10.7,spacing:1,children:[e.jsx(e.Fragment,{children:e.jsx(n,{item:!0,xs:12,sm:12,md:12,children:e.jsx(vt,{activeTab:l,AcademicYearList:Ne,MonthYearList:Ge,operatorArray:hs,clickSearch:Cs,academicYear:i,monthYear:y,operator:_,searchDate:F,searchText:C,clickAcademicYear:ls,clickMonthYear:is,clickOperator:ds,clickDate:cs,textOnChange:xs,isSearchClicked:$,CloseSearchBar:vs})})}),e.jsx(n,{item:!0,xs:12,children:b.some(s=>s.isActive===!0)&&e.jsx(e.Fragment,{children:e.jsx(p,{mb:2,sx:It,children:e.jsx(Wt,{activeTab:l,clickReset:Ss,TrashDelete:ms,ConfirmUndelete:js,DeletePermanent:Is,clickDelete:ve,clickReadUnread:gs})})})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(ft,{children:[Je?e.jsx(tt,{}):e.jsx("div",{id:"ScrollableDiv",onScroll:s=>{ws(s.target)},style:{paddingBottom:"100px",height:"570px",overflow:"auto"},children:(N==null?void 0:N.length)===0?e.jsx(me,{variant:"h6",align:"center",color:"blue",sx:{textAlign:"center",marginTop:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:"No record found."}):e.jsxs(n,{container:!0,children:[e.jsx(n,{xs:12,sm:12,md:12,sx:{textAlign:"right",backgroundColor:"white"},mt:-1,mb:-1,children:e.jsxs(me,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsx(p,{component:"span",fontWeight:"fontWeightBold",children:b.length})," ","Out of"," ",e.jsx(p,{component:"span",fontWeight:"fontWeightBold",children:Y})," "," records"]})}),e.jsx(n,{xs:12,sm:12,md:12,sx:{backgroundColor:"white",padding:1},children:e.jsx(Mt,{Itemlist:b,ActiveTab:l,DeleteDraft:As,refreshData:Ds,clickSortExp:es,clickSortDirection:ss,SortDirection:K,SortExp:G})})]})}),e.jsxs(p,{sx:{isplay:ie,position:"fixed",bottom:"50px",zIndex:"1",left:"15px",p:"1px",width:40,height:80,backgroundColor:"white",m:2,textAlign:"center",boxShadow:"5px 5px 10px rgba(163, 177, 198, 0.4), -5px -5px 10px rgba(255, 255, 255, 1) !important",borderRadius:"15px"},children:[e.jsx(it,{onClick:ks,fontSize:"large",color:"success"}),e.jsx(rt,{onClick:ys,fontSize:"large",color:"success"})]}),e.jsx(p,{sx:{display:"flex",justifyContent:"flex-start",gap:"8px"},children:D&&e.jsx(bt,{open:D,setOpen:X})}),e.jsx("span",{style:{width:"95px",position:"fixed",bottom:"40px",right:"40px"},children:e.jsx(Ae,{style:{textDecoration:"none"},to:`/${location.pathname.split("/")[1]}/MessageCenter/Compose`,children:e.jsxs(Gt,{onClick:ye,sx:{fontSize:"10px",mr:1,mb:"4px",borderRadius:"15px",backgroundColor:"#38548A",color:"white"},children:[e.jsx(Le,{}),e.jsx("br",{}),e.jsx("b",{children:"Compose"})]})})})]})})]})]})]})})};export{Sr as default};

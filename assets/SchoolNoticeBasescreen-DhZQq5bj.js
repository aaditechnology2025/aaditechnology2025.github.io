import{j as e,B as l,T as U,ai as Ne,aj as Ce,ak as we,al as Y,am as i,an as be,H as u,I as f,as as Te,at as De,A as Ae,j9 as Le,w as ve,x as ke,r as s,E as Re,cz as R,t as z,lX as Ee,lY as E,lZ as Oe,F as Be,p as He,G as S,bR as J,J as q,K as Pe,L as O,m as w,n as Fe,a9 as $e,ce as Z,ay as Me,l_ as Ue,l$ as Ve,m0 as Q}from"./index-d5YOjbb6.js";import{d as _e}from"./AddTwoTone-BXHHvxtd.js";import{d as Ke}from"./PriorityHigh-Co3aw9FH.js";import{d as We}from"./Save-Ckr0NoeK.js";import{d as Ge}from"./ArrowCircleUp-BmCXupv-.js";import{d as Xe}from"./Attachment-DgcWq5kr.js";import{A as Ye}from"./ArrowCircleDown-BpJDJL07.js";import{L as ze}from"./Link-CIF-2ERy.js";import{E as Je}from"./EditTwoTone-BkGGZSzA.js";import{y as ee}from"./yellow-BQYah5ZS.js";import{R as qe}from"./RadioGroup-CytjzwBe.js";import{R as te}from"./Radio-CCPcjMAp.js";import"./FormGroup-XtcIGgvX.js";function Ze({ItemList:p,clickEdit:n,HeaderArray:d,toggleRowSelection:g,ClickHeader:b,clickDelete:c}){function T(o){const a=o.getDate().toString().padStart(2,"0"),H=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][o.getMonth()],x=o.getFullYear();return`${a}-${H}-${x}`}T(new Date);const B=o=>{const a=d.map(h=>h.Id===o?{...h,SortOrder:h.SortOrder==="desc"?"asc":"desc"}:{...h,SortOrder:null});b(a)};let j=localStorage.getItem("SiteURL")+"/RITeSchool/downloads/School Notices/",y=!1;return d.map(o=>{o.Id==6&&(y=!0)}),e.jsx(l,{sx:{},children:p.length===0?e.jsx(l,{sx:{backgroundColor:"#D2FDFC"},children:e.jsx(U,{variant:"h6",align:"center",sx:{textAlign:"center",marginTop:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:"No record found."})}):e.jsx(e.Fragment,{children:e.jsx(Ne,{component:l,children:e.jsxs(Ce,{"aria-label":"simple table",sx:{border:o=>`1px solid ${o.palette.divider}`},children:[e.jsx(we,{children:e.jsx(Y,{sx:{background:o=>o.palette.secondary.main},children:d.map((o,a)=>e.jsx(i,{sx:{color:h=>h.palette.common.white,textAlign:a<4?"left":"center",width:o.Width||"auto",pt:1.5,pb:1.5},onClick:[7,8,9].includes(o.Id)?null:()=>B(o.Id),children:e.jsxs(l,{sx:{display:"flex",justifyContent:a<4?"flex-start":"center",alignItems:"center",gap:.5},children:[e.jsx("b",{children:o.Header}),o.SortOrder!==null&&![7,8,9].includes(o.Id)?o.SortOrder==="desc"?e.jsx(Ge,{}):e.jsx(Ye,{}):null]})},a))})}),e.jsx(be,{children:p.map((o,a)=>e.jsxs(Y,{children:[e.jsx(i,{sx:{py:1,textAlign:"left"},children:o.Text1}),e.jsx(i,{sx:{py:1,textAlign:"left"},children:o.Text4}),e.jsx(i,{sx:{py:1,textAlign:"left"},children:o.Text2}),e.jsx(i,{sx:{py:1,textAlign:"left"},children:o.Text3}),e.jsx(i,{sx:{py:1,textAlign:"center"},children:o.Text5}),y&&e.jsx(i,{sx:{py:1,textAlign:"center"},children:e.jsx(ze,{href:j+o.Text6,children:e.jsx(Xe,{})})}),e.jsx(i,{sx:{py:1,textAlign:"center"},children:e.jsx(u,{title:"Select notice to display under School Notices.",children:e.jsx("input",{type:"checkbox",style:{height:"18px",width:"18px"},checked:o.IsActive,onChange:()=>g(o.Id)})})}),e.jsx(i,{sx:{py:1,textAlign:"center"},children:e.jsx(u,{title:"Edit",children:e.jsx(f,{onClick:()=>n(o.Id),sx:{color:"#223354","&:hover":{color:"#223354",cursor:"pointer"}},children:e.jsx(Je,{})})})}),e.jsx(i,{sx:{py:1,textAlign:"center",textTransform:"capitalize"},children:e.jsx(f,{sx:{color:"#223354","&:hover":{color:"red",backgroundColor:Te[100]}},onClick:()=>c(o.Id,o.Text2,o.Text3),children:e.jsx(u,{title:"Delete",children:e.jsx(De,{})})})})]},a))})]})})})})}const pt=()=>{const p=Ae(),n=Le();let{selectDisplayT:d}=ve();d=ke(d);const g=Number(localStorage.getItem("localSchoolId"));Number(sessionStorage.getItem("AcademicYearId"));const b=Number(localStorage.getItem("UserId"));s.useState("AllFile");const[c,T]=s.useState("false"),[D,B]=s.useState("All");s.useState([]);const[j,y]=s.useState("true"),[o,a]=s.useState(!1),[h,H]=s.useState([]);s.useState("1");const[x,P]=s.useState(20),oe=[20,50,100,200],[I,A]=s.useState(1),{showAlert:V,closeAlert:L}=s.useContext(Re),[_,se]=s.useState("StartDate desc"),re=[{Id:1,Name:"File",Value:"false"},{Id:2,Name:"Text",Value:"true"}],le=[{Id:1,Name:"All",Value:"All"},{Id:2,Name:"Both",Value:"Both"},{Id:3,Name:"Control Panel",Value:"Control Panel"},{Id:4,Name:"Home Page",Value:"Home Page"}],ae=R(t=>t.SchoolNotice.Loading),m=R(t=>t.SchoolNotice.SchoolNoticeList),[N,K]=s.useState([]);s.useEffect(()=>{K(m)},[m]);const F=R(t=>t.SchoolNotice.DeleteSchoolNoticeMsg),$=R(t=>t.SchoolNotice.SelectSchoolNotice),ne=m.filter(t=>t.RecordCount!==void 0).map(t=>t.RecordCount),C=[...new Set(ne)][0],v={asSchoolId:Number(g),asDisplayLocation:D,asShowAllNotices:j=="true",asText:o,asSortExpression:_,StartRowIndex:(I-1)*x,MaximumRows:I*x},ce=()=>{const t={asSchoolId:Number(g),asNoticeXml:je()};n(Ue(t)),n(E(v))};s.useEffect(()=>{d!==void 0&&T(d)},[]),s.useEffect(()=>{$!=""&&(z.success($),n(Ee()),n(E(v)))},[$]);const ie=(t,r,M)=>{const k={asSchoolId:g,asNoticeId:Number(t),asUpdatedById:Number(b)};Ve(r,M)?V({title:"Please Confirm",message:"This is an active notice. Are you sure you want to delete this record?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{L()},onConfirm:()=>{n(Q(k)),L()}}):V({title:"Please Confirm",message:"Are you sure you want to delete this record?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{L()},onConfirm:()=>{n(Q(k)),L()}})};s.useEffect(()=>{F!==""&&(z.success(F),n(Oe()),n(E(v)))},[F]);let de=[{Id:1,Header:"Link Name",SortOrder:null,sortKey:"NoticeName"},{Id:2,Header:"Display Location",SortOrder:null,sortKey:"DisplayLocation"},{Id:3,Header:"Start Date & Time",SortOrder:"desc",sortKey:"StartDate"},{Id:4,Header:"End Date & Time",SortOrder:null,sortKey:"EndDate"},{Id:5,Header:"Sort Order",SortOrder:null,sortKey:"dbSortOrder"},{Id:6,Header:"File Name",SortOrder:null,sortKey:"FileName"},{Id:7,Header:"Select"},{Id:8,Header:"Edit"},{Id:9,Header:"Delete"}];const[W,G]=s.useState([]);s.useEffect(()=>{let t=[];de.map(r=>{c=="true"&&r.Id==6||t.push(r)}),G(t)},[c]);const xe=t=>{G(t);const r=t.find(k=>k.SortOrder!==null),M=r?`${r.sortKey} ${r.SortOrder}`:"Created_Date desc";se(M)};s.useState(W),s.useEffect(()=>{},[c]);const he=t=>{K(N.map(r=>({...r,IsActive:r.Id===t?!r.IsActive:r.IsActive})))},ue=t=>{d?p("../../AddSchoolNoticeFT/"+w(t)+"/"+w(c),{state:{fromInternal:!0}}):p("../AddSchoolNoticeFT/"+w(t)+"/"+w(c),{state:{fromInternal:!0}})},pe=t=>{T(t),y("true"),P(20),A(1),c=="false"?a(!0):a(!1)},me=t=>{B(t),P(20),A(1)},Se=t=>{y(t)},fe=t=>{A(t)},ge=t=>{P(parseInt(t.target.value,10)),A(1)};s.useEffect(()=>{m&&H(m)},[m]);function je(){let t='<ArrayOfNoticeDetails xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema">';return N.map(r=>{t+=" <NoticeDetails><NoticeId> "+r.Id+"</NoticeId> <SortOrder>0</SortOrder><UserId>0</UserId><SortOrderLocationChanged>0</SortOrderLocationChanged><IsSelected>"+r.IsActive+"</IsSelected><IsText>"+o+"</IsText><InertedById>"+b+"</InertedById><SchoolId>0</SchoolId><AcademicYearId>0</AcademicYearId> <StandardDivisionId>0</StandardDivisionId> </NoticeDetails>"}),t+=`\r
</ArrayOfNoticeDetails>`,t}s.useEffect(()=>{n(E(v))},[I,x,j,c,D,_]);const ye=(I-1)*x+1,X=Math.min(I*x,C),Ie=Math.ceil(C/x);return e.jsxs(l,{sx:{px:2},children:[e.jsx(Be,{navLinks:[{title:"School Notices",path:" "}],rightActions:e.jsxs(He,{direction:{xs:"column",sm:"row"},alignItems:"right",spacing:1,sx:{mt:{xs:0,sm:0},flexWrap:{xs:"nowrap",sm:"nowrap"}},children:[e.jsx(S,{item:!0,xs:12,sm:6,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(J,{sx:{minWidth:{xs:"40vw",sm:"13vw"}},ItemList:re,defaultValue:c,onChange:pe,size:"small",label:" Display Type"})}),e.jsx(S,{item:!0,xs:12,sm:6,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(J,{sx:{minWidth:{xs:"40vw",sm:"13vw"}},ItemList:le,defaultValue:D,onChange:me,size:"small",label:"Display Location"})}),e.jsxs(S,{item:!0,xs:12,gap:1,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:[e.jsx(l,{children:e.jsx(u,{title:"Select the notices from the list to be displayed on School web site under School Notices.",children:e.jsx(f,{sx:{color:"white",backgroundColor:ee[600],height:"36px !important",":hover":{backgroundColor:ee[700]}},children:e.jsx(Ke,{})})})}),e.jsx(l,{children:e.jsx(u,{title:"Displays all uploaded school notices.",children:e.jsx(f,{sx:{color:"white",backgroundColor:q[500],height:"36px !important",":hover":{backgroundColor:q[600]}},children:e.jsx(Pe,{})})})}),e.jsx(l,{children:e.jsx(u,{title:"Save",children:e.jsx(f,{sx:{color:"white",backgroundColor:O[500],height:"36px !important",":hover":{backgroundColor:O[600]}},onClick:ce,children:e.jsx(We,{})})})}),e.jsx(l,{children:e.jsx(u,{title:"Add New Notice",children:e.jsx(f,{onClick:()=>p("/RITeSchool/Teacher/AddSchoolNoticeFT/"+w(c),{state:{fromInternal:!0}}),sx:{color:"white",backgroundColor:O[500],"&:hover":{backgroundColor:O[600]}},children:e.jsx(_e,{})})})})]})]})}),ae&&e.jsx(Fe,{}),e.jsx(S,{sx:{backgroundColor:"white",mb:2,p:1},children:e.jsx(S,{item:!0,sm:12,px:0,sx:{display:"flex",justifyItems:"center"},children:e.jsx(S,{children:e.jsx($e,{component:"fieldset",children:e.jsxs(qe,{row:!0,"aria-label":"options",name:"options",value:j,onChange:t=>{Se(t.target.defaultValue)},children:[e.jsx(Z,{value:"true",control:e.jsx(te,{}),label:"Show All Notices"}),e.jsx(Z,{value:"false",control:e.jsx(te,{}),label:"Show Active Notices"})]})})})})}),e.jsxs(l,{sx:{background:"white",pt:2,p:2},children:[C>0?e.jsx("div",{style:{flex:1,textAlign:"center"},children:e.jsxs(U,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(l,{component:"span",fontWeight:"fontWeightBold",children:[ye," to ",X]})," ","out of"," ",e.jsx(l,{component:"span",fontWeight:"fontWeightBold",children:C})," ",C===1?"record":"records"]})}):e.jsx("span",{children:" "}),N&&N.length>0?e.jsx(Ze,{HeaderArray:W,ItemList:N,clickDelete:ie,ClickHeader:xe,toggleRowSelection:he,clickEdit:ue}):e.jsx(l,{sx:{backgroundColor:"#D2FDFC"},children:e.jsx(U,{variant:"h6",align:"center",sx:{textAlign:"center",marginTop:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:"No record found."})}),X>19?e.jsx(Me,{rowsPerPage:x,ChangeRowsPerPage:ge,rowsPerPageOptions:oe,PageChange:fe,pagecount:Ie}):e.jsx("span",{})]})]})};export{pt as default};

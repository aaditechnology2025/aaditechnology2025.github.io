import{u as ie,c as b,r,eX as Te,fc as De,j as e,B as i,T as _,G as y,q as U,bR as X,H as K,I as V,du as Pe,as as ae,ai as ce,aj as de,ak as ue,al as z,am as n,an as he,ay as xe,A as _e,nz as Z,nA as Le,nB as ve,nC as Ne,nD as Ee,nE as Re,t as Ge,nF as we,F as Fe,J as ne,bv as le,nG as He}from"./index-d5YOjbb6.js";import{d as Me}from"./Book-CsjAEXEu.js";import{L as Oe}from"./Legend-p9-_07Am.js";import{d as Ue}from"./Close-DJWwbmdJ.js";import{d as Ke}from"./ArrowCircleUp-BmCXupv-.js";import{A as Ve}from"./ArrowCircleDown-BpJDJL07.js";import{L as ze}from"./Link-CIF-2ERy.js";import{Q as We}from"./QuestionMark-C2Y4lgD8.js";const Ye=({BookTitle:l,AccessionNumber:g,Author:I,Publisher:B,StandardId:c,LanguageId:k,IsPrintable:p,setBookTitle:A,setAccessionNumber:f,setAuthor:s,setPublisher:d,setStandardId:u,setLanguageId:S,setIsPrintable:C,clickSearch:j,clickReset:a})=>{const T=ie(),G=[{id:"",Name:"All",Value:""},{id:"1",Name:"Printable",Value:"1"},{id:"0",Name:"Non-Printable",Value:"0"}],L=localStorage.getItem("localSchoolId"),w=sessionStorage.getItem("AcademicYearId"),v=b(t=>t.StandardAndExamList.SelectStandard),x=b(t=>t.library.LanguageList);r.useEffect(()=>{T(Te({asSchoolId:L,asAcademicYearId:w})),T(De({aiSchoolId:L}))},[]),r.useEffect(()=>{if(!k&&x.length>0){const t=x.find(ee=>ee.Value==="");t&&S(t.Value)}},[k,x,S]),r.useEffect(()=>{p===""&&C("")},[p,C]);const h=t=>{A(t)},W=t=>{f(t)},m=t=>{s(t)},F=t=>{d(t)},Y=t=>{u(t)},$=t=>{S(t)},H=t=>{C(t)};return e.jsxs(i,{sx:{p:2,background:"white"},children:[e.jsx(_,{variant:"h4",pb:1,children:" Search Criteria  "}),e.jsxs(y,{container:!0,spacing:2,children:[e.jsx(y,{item:!0,xs:12,md:3,children:e.jsx(U,{fullWidth:!0,label:"Book Title",value:l,onChange:t=>h(t.target.value.slice(0,100)),inputProps:{maxLength:100},size:"medium",onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&j()}})}),e.jsx(y,{item:!0,xs:12,md:3,children:e.jsx(U,{fullWidth:!0,size:"medium",label:"Accession Number",value:g,onChange:t=>W(t.target.value.slice(0,100)),inputProps:{maxLength:100},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&j()}})}),e.jsx(y,{item:!0,xs:12,md:3,children:e.jsx(U,{fullWidth:!0,label:"Author",size:"medium",value:I,onChange:t=>m(t.target.value.slice(0,100)),inputProps:{maxLength:100},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&j()}})}),e.jsx(y,{item:!0,xs:12,md:3,children:e.jsx(U,{fullWidth:!0,label:"Publisher",size:"medium",value:B,onChange:t=>F(t.target.value.slice(0,100)),inputProps:{maxLength:100},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&j()}})}),e.jsx(y,{item:!0,xs:12,md:3,children:e.jsx(X,{size:"medium",sx:{width:"100%"},ItemList:x,defaultValue:k,onChange:$,label:"Language"})}),e.jsx(y,{item:!0,xs:12,md:3,children:e.jsx(X,{size:"medium",sx:{width:"100%"},ItemList:v,defaultValue:c,onChange:Y,label:"Standard "})}),e.jsx(y,{item:!0,xs:12,md:3,children:e.jsx(X,{size:"medium",sx:{width:"100%"},ItemList:G,defaultValue:p,onChange:H,label:"Media Type"})}),e.jsxs(y,{item:!0,xs:12,md:3,children:[e.jsx(K,{title:"Search",children:e.jsx(V,{sx:{background:t=>t.palette.primary.main,color:"white",mt:1,"&:hover":{backgroundColor:t=>t.palette.primary.dark}},onClick:j,children:e.jsx(Pe,{})})}),e.jsx(K,{title:"Clear",children:e.jsx(V,{sx:{color:"white",mt:1,ml:1.5,backgroundColor:ae[500],height:"36px !important",":hover":{backgroundColor:ae[600]}},onClick:a,children:e.jsx(Ue,{})})})]})]})]})},$e={height:"0.5em 1.5em"},Qe={padding:"0.2em 1.5em"},qe=({data:l,clickcliam:g,DefaultValue:I,handleSortChange:B,HeaderArray:c,sortHeader:k,SortExpression:p})=>{const A=s=>{const d=c.find(u=>u.Id===s.Id);if((d==null?void 0:d.sortKey)!==void 0){let u=s.Id==k&&p=="Asc"?"Desc":"Asc";B({Id:s.Id,SortOrder:u})}};b(s=>s.SchoolLibrary.IGetAllBooksDetails);const f=b(s=>s.SchoolLibrary.IGetAllBooksDetailss);return e.jsx(e.Fragment,{children:e.jsx(ce,{children:e.jsxs(de,{"aria-label":"book table",sx:{border:s=>`1px solid ${s.palette.grey[300]}`},children:[e.jsx(ue,{children:e.jsxs(z,{sx:{background:s=>s.palette.secondary.main,color:s=>s.palette.common.white,...$e},children:[c.slice(0,9).map((s,d)=>e.jsx(n,{sx:{textTransform:"capitalize",color:u=>u.palette.common.white,pt:1,pb:1},onClick:()=>A(s),children:e.jsxs("div",{style:{display:"flex",gap:"0.5rem",justifyContent:[1,2,3,4,5,6].includes(s.Id)?"left":"center"},children:[e.jsx("b",{children:s.Header}),k==s.Id&&(p=="Asc"?e.jsx(Ke,{}):e.jsx(Ve,{}))]})},d)),c.slice(9).map((s,d)=>e.jsx(n,{sx:{textTransform:"capitalize",color:u=>u.palette.common.white,py:1.5},children:e.jsx("div",{style:{display:"flex",alignItems:"center",gap:1,justifyContent:s.Header.includes("Remark Template")?"flex-start ":"center",...Qe},children:e.jsx("b",{children:s.Header})})},d+9))]})}),e.jsx(he,{children:f.map(s=>e.jsxs(z,{children:[e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",py:1},children:s.Book_No}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",py:1},children:s.Book_Title}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",py:1},children:s.Author_Name}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",py:1},children:s.Published_By}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",py:1},children:s.Category_Name}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",py:1},children:s.Language}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",textAlign:"center",py:1},children:s.Available_Books}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",textAlign:"center",py:1},children:s.Total_Books}),e.jsx(n,{sx:{color:s.IsForIssue=="1"?"":"red",py:1,textAlign:"center"},children:s.Available_Books==="0"?e.jsx(ze,{href:"#",onClick:()=>g(s.Book_Id),children:"Claim"}):" "})]},s.Book_Id))})]})})})},Je=({data1:l})=>{const[g,I]=r.useState(5),[B,c]=r.useState(1),k=[20,50,100,200],[p,A]=r.useState(1),f=a=>{I(parseInt(a.target.value,10)),c(1)},s=a=>{c(a)},d=(B-1)*g,u=d+g,S=l.slice(d,u),C=Math.ceil(l.length/g),j=Math.min(p*g);return e.jsxs(i,{children:[e.jsx(ce,{component:i,children:e.jsxs(de,{"aria-label":"book table",sx:{border:a=>`1px solid ${a.palette.grey[300]}`,overflow:"hidden"},children:[e.jsx(ue,{children:e.jsxs(z,{sx:{background:a=>a.palette.secondary.main,color:a=>a.palette.common.white},children:[e.jsx(n,{sx:{color:"white",textAlign:"left",py:1},children:e.jsx("strong",{children:"Book Title"})}),e.jsx(n,{sx:{color:"white",textAlign:"left",py:1},children:e.jsx("strong",{children:"Accession No"})}),e.jsx(n,{sx:{color:"white",textAlign:"left",py:1},children:e.jsx("strong",{children:"Issue Date"})}),e.jsx(n,{sx:{color:"white",textAlign:"left",py:1},children:e.jsx("strong",{children:"Return Date"})})]})}),e.jsx(he,{children:S.map((a,T)=>e.jsxs(z,{children:[e.jsx(n,{sx:{py:1},children:a.Book_Title}),e.jsx(n,{sx:{py:1},children:a.Accession_No}),e.jsx(n,{sx:{py:1},children:a.Issue_Date}),e.jsx(n,{sx:{py:1},children:a.Return_Date})]},T))})]})}),j>19?e.jsx(xe,{ChangeRowsPerPage:f,rowsPerPageOptions:[k],rowsPerPage:g,PageChange:s,pagecount:C}):e.jsx("span",{})]})},ls=()=>{const l=ie(),g=_e();r.useState("");const[I,B]=r.useState(2),[c,k]=r.useState("Asc"),[p,A]=r.useState(""),[f,s]=r.useState(""),[d,u]=r.useState(""),[S,C]=r.useState(""),[j,a]=r.useState("0"),[T,G]=r.useState(""),[L,w]=r.useState("");r.useState([]);const[v,x]=r.useState(""),[h,W]=r.useState(20),[m,F]=r.useState(1),Y=[20,50,100,200],[$,H]=r.useState(0),[t,ee]=r.useState([{Id:1,Header:"Accession No",SortOrder:null,sortKey:"Book_No"},{Id:2,Header:"Book Title",SortOrder:null,sortKey:"Book_Title"},{Id:3,Header:"Author",SortOrder:"ASC",sortKey:"Author_Name"},{Id:4,Header:"Publisher",SortOrder:null,sortKey:"Published_By"},{Id:5,Header:"Standards"},{Id:6,Header:"Language",SortOrder:null,sortKey:"Language"},{Id:7,Header:"Available"},{Id:8,Header:"Total"},{Id:9,Header:"Claim"}]),D=Number(localStorage.getItem("localSchoolId")),N=Number(localStorage.getItem("UserId")),M=Number(sessionStorage.getItem("AcademicYearId")),se=b(o=>o.SchoolLibrary.IGetLibraryBookIssueDetails),Q=b(o=>o.SchoolLibrary.IBookClimedMsg);b(o=>o.SchoolLibrary.IGetReserveBookDetails);const E=b(o=>o.SchoolLibrary.IreserveBooksCountperperson),O=b(o=>o.SchoolLibrary.IGetAllBooksDetailss),q=b(o=>o.SchoolLibrary.IGetBookTotalCount);b(o=>o.SchoolLibrary.IGetTotalBookID);const me=(Array.isArray(O)?O.filter(o=>o.USGetBookTotalCount!==void 0):[]).map(o=>o.USGetBookTotalCount);[...new Set(me)];const J=()=>{let o="";return t.map(P=>{P.Id==I&&(o=P.sortKey)}),o},te={asprm_iSchoolId:D,Book_Title:p,Author_Name:d,Published_By:S,AccessionNumber:f,Language:T,Is_Printable:L,asprm_iStandardId:j,asSortExp:"Order By "+J()+" "+c,asStartIndex:(m-1)*h,asEndIndex:m*h,asprm_iParentStaffId:0},ge=()=>{l(Z(te))};r.useEffect(()=>{l(Z(te))},[l,m,h,c,I]);const pe={asSchool_Id:D,asBook_Issued_To:N,asAcademic_Year_Id:M},be={asprm_iSchoolId:D,asprm_Filter:"",asprm_BookNo:"",asprm_iStandardId:0,asprm_iParentStaffId:0},ke={asSchoolId:D,asAcademicYearId:M,asUserID:N,asStartIndex:(m-1)*h,asEndIndex:m*h,asBookTitle:"",asUserName:"",asSortExpression:"Order By "+J()+" "+c,asAllUserFlag:0};r.useEffect(()=>{v&&x("")},[m,h,c,I]),r.useEffect(()=>{x(""),l(Le(ke)),l(ve(pe)),l(Ne(be))},[]);const je=o=>{H(o),l(He({asSchoolId:D,asAcademicYearId:M,asBookId:o,asUserId:N,asFlag:0}))};r.useEffect(()=>{let o=!0;if(E.length>0){if(E[0].Count==="999"&&(x("Could not claim same book."),o=!1),E[0].Count==="4"&&(x("Cannot claim more than 4 books."),o=!1),!o)return;l(Ee({asBookId:$,asUserId:N,asReservedByParent:0,asSchoolId:D,asAcademicYearId:M,asInsertedById:N})),H(0),l(Re())}},[E]),r.useEffect(()=>{Q!==""&&(Ge.success(Q),l(we()),x(""))},[Q,E]);const R=r.useMemo(()=>Array.isArray(q)?q.reduce((o,P)=>{const re=Number(P.TotalCount);return isNaN(re)?o:o+re},0):0,[q]),Ie=o=>{F(o)},ye=o=>{W(parseInt(o.target.value,10)),F(1)},fe=(m-1)*h+1,oe=Math.min(m*h,R),Se=Math.ceil(R/h),Ce=o=>{B(o.Id),k(o.SortOrder)};r.useEffect(()=>{x("")},[]);const Be=()=>{A(""),s(""),u(""),C(""),a("0"),G(""),w(""),x(""),setTimeout(()=>{const o={asprm_iSchoolId:D,Book_Title:"",Author_Name:"",Published_By:"",AccessionNumber:"",Language:"",Is_Printable:"",asprm_iStandardId:"0",asSortExp:"Order By "+J()+" "+c,asStartIndex:(m-1)*h,asEndIndex:m*h,asprm_iParentStaffId:0};l(Z(o))},0)},Ae=[{id:1,Name:"Can not be issued",Value:e.jsx(i,{sx:{display:"flex",gap:1,alignItems:"center"},children:e.jsx(i,{sx:{width:23,height:23,backgroundColor:"red",border:"1px solid black"}})})}];return e.jsxs(i,{px:2,children:[e.jsx(Fe,{navLinks:[{title:"Library",path:"/RITeSchool/Teacher/LibraryBaseScreen"}],rightActions:e.jsxs(e.Fragment,{children:[e.jsx(K,{title:"Here you can search the books and also you can see the issued book details.",children:e.jsx(V,{sx:{color:"white",backgroundColor:ne[500],"&:hover":{backgroundColor:ne[600]}},children:e.jsx(We,{})})}),e.jsx(K,{title:"Claimed Book Details",children:e.jsx(V,{sx:{color:"white",backgroundColor:le[500],"&:hover":{backgroundColor:le[600]}},onClick:()=>g("/RITeSchool/Teacher/ClaimedBookDetailsPage/",{state:{fromInternal:!0}}),children:e.jsx(Me,{})})})]})}),e.jsx(i,{pb:.5,children:v&&e.jsxs("span",{style:{color:"red"},children:[v,e.jsx("br",{})]})}),e.jsx(Ye,{BookTitle:p,AccessionNumber:f,Author:d,Publisher:S,StandardId:j,LanguageId:T,IsPrintable:L,setBookTitle:A,setAccessionNumber:s,setAuthor:u,setPublisher:C,setStandardId:a,setLanguageId:G,setIsPrintable:w,clickSearch:ge,clickReset:Be}),e.jsx(i,{mt:1,sx:{background:"white",p:1},children:e.jsx(Oe,{LegendArray:Ae})}),e.jsxs(i,{mt:1,px:2,sx:{backgroundColor:"white"},pb:2,children:[e.jsxs(i,{sx:{display:"flex"},children:[e.jsx(i,{children:e.jsx(_,{variant:"h4",pt:2,children:"Books Details"})}),R>0?e.jsx(i,{style:{flex:1,textAlign:"center"},children:e.jsxs(_,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(i,{component:"span",fontWeight:"fontWeightBold",children:[fe," to ",oe]})," ","out of"," ",e.jsx(i,{component:"span",fontWeight:"fontWeightBold",children:R})," ",R===1?"record":"records"]})}):e.jsx("span",{children:" "})]}),O.length===0?e.jsx(i,{sx:{backgroundColor:"#D2FDFC"},children:e.jsx(_,{variant:"h6",align:"center",sx:{textAlign:"center",marginTop:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:"No record found."})}):e.jsx(qe,{data:O,clickcliam:je,DefaultValue:c,handleSortChange:Ce,HeaderArray:t,sortHeader:I,SortExpression:c}),oe>19?e.jsx(xe,{rowsPerPage:h,ChangeRowsPerPage:ye,rowsPerPageOptions:Y,PageChange:Ie,pagecount:Se}):e.jsx("span",{})]}),e.jsxs(i,{mt:1,p:2,sx:{backgroundColor:"white"},children:[e.jsx(_,{variant:"h4",pb:1,children:"Books With Me"}),se.length===0?e.jsx(i,{sx:{backgroundColor:"#D2FDFC"},children:e.jsx(_,{variant:"h6",align:"center",sx:{textAlign:"center",marginTop:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:"No record found."})}):e.jsx(Je,{data1:se})]})]})};export{ls as default};

import{w as we,x as re,u as ke,A as De,h3 as Me,r as n,c as E,h4 as Te,h5 as oe,E as Fe,t as Ye,h6 as Le,j as e,B as h,F as Ne,m as ce,p as B,bR as Pe,H as I,I as x,J as ie,K as Ee,L as l,ba as Be,T as b,a8 as d,a2 as O,a3 as H,a4 as W,a5 as $,a7 as R,as as le,h7 as Oe,h8 as He}from"./index-d5YOjbb6.js";import{d as We}from"./Save-Ckr0NoeK.js";import{C as $e}from"./CardCalenderList-PUCKr_bi.js";import{C as Re}from"./Card-BrM9kpJu.js";import"./DotLegendAttandaceCalender-DZhh8Pmk.js";import"./CardStyle-B9qFmFtz.js";import"./DotLegendStyled-B7Xptujc.js";const et=()=>{var se;let{selectClasstecahernew:c,AssignedDate:f}=we();f=re(f),c=re(c);const p=ke();De(),Me(),n.useState(!0);const v=Number(localStorage.getItem("localSchoolId")),V=Number(sessionStorage.getItem("AcademicYearId")),U=t=>{const[s,a]=t.split("/");return`${a}-${s.padStart(2,"0")}-01`},de=Number(sessionStorage.getItem("TeacherId"));sessionStorage.getItem("StudentId"),n.useState();const[Ve,_]=n.useState(new Date().getFullYear()),[u,S]=n.useState([]),[ue,Ue]=n.useState(null),[i,y]=n.useState(c||void 0);n.useState("");const[_e,G]=n.useState(0),[j,J]=n.useState(new Date(f)),w=t=>{if(!(t instanceof Date)||isNaN(t.getTime()))throw new Error("Invalid date provided");const s={month:"short",year:"numeric"};return t.toLocaleDateString("en-US",s)},[o,z]=n.useState(w(j));`${j.toLocaleString("en-US",{month:"short"})}${j.getFullYear()}`;const he={Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},[Ge,X]=n.useState(!1),K=t=>{const s=t.split(" ")[0];return he[s]},[k,D]=n.useState(o?(se=K(o))==null?void 0:se.toString():void 0),r=E(t=>t.IndividualAttendance.GetStudentName),M=u.every(t=>t.MouseoverStatus==="Outside Academic Year"),A=E(t=>t.IndividualAttendance.GetCalendarForStudent),T=E(t=>t.IndividualAttendance.SaveStudentAttendance),xe={asSchoolId:v,asAcademicYrId:V,asDivisionId:c!==void 0?Number(c):r&&r.length>0?Number(r[0].Value):null},q={asSchoolId:v,aStudentId:Number(i),aAcademicYearId:V,aMonthId:Number(k),aYear:new Date(U(o)).getFullYear()};n.useEffect(()=>{var t;o&&D((t=K(o))==null?void 0:t.toString())},[o]);const ge=[{Id:1,Header:"Sun"},{Id:2,Header:"Mon"},{Id:3,Header:"Tue"},{Id:4,Header:"Wed"},{Id:5,Header:"Thu"},{Id:6,Header:"Fri"},{Id:7,Header:"Sat"}];n.useEffect(()=>{p(Te(xe))},[]),n.useEffect(()=>{r&&r.length>0&&y(c||r[0].Value)},[r,c]),n.useEffect(()=>{i!="0"&&p(oe(q))},[k,i]),n.useEffect(()=>{S(A)},[A]),n.useEffect(()=>{r.length>0&&y(r[0].Value)},[r]);const me=t=>{G(0),y(t)},Q=t=>{S(u.map(a=>a.IsClickable?{...a,Status:t,BackgroundColor:He(t),Text1:t=="Y"?"Present":"Absent"}:a));const s=u.some(a=>a.IsClickable&&a.Status!==t);X(s),G(t)};n.useEffect(()=>{u.length>=0&&Se(ve())},[u]);const pe=()=>{const t=new Date("01 "+o);t.setMonth(t.getMonth()-1),t.getMonth()===11&&t.setFullYear(t.getFullYear());const s=w(t);J(t),D(`${t.getMonth()+1}`),_(t.getFullYear()),z(s)},Ce=()=>{const t=new Date("01 "+o);t.setMonth(t.getMonth()+1),t.getMonth()===0&&t.setFullYear(t.getFullYear());const s=w(t);J(t),D(`${t.getMonth()+1}`),_(t.getFullYear()),z(s)},[fe,Se]=n.useState(""),je=t=>{S(t)},Ae=n.useRef(null),[F,Z]=n.useState(!1),[Y,ee]=n.useState(!1),[C,L]=n.useState(!1),{showAlert:N,closeAlert:g}=n.useContext(Fe),[Ie,be]=n.useState([]);n.useEffect(()=>{be(A)},[A]);const te=()=>{N({title:"Save Changes",message:"Are you sure, Do you want to update changes?",variant:"warning",cancelButtonText:"Cancel",confirmButtonText:"Confirm",onConfirm:()=>{ye(),g()},onCancel:()=>{S(Ie),g()}})},ne=()=>{N({title:"Mark all as Present",message:"Are you sure you want the chosen student to be marked as present on each day?",variant:"warning",cancelButtonText:"Cancel",confirmButtonText:"Confirm",onConfirm:()=>{Q("Y"),g()},onCancel:g})},P=()=>{N({title:"Mark all as Absent",message:"Are you sure you want the chosen student to be marked as absent on each day?",variant:"warning",cancelButtonText:"Cancel",confirmButtonText:"Confirm",onConfirm:()=>{Q("N"),g()},onCancel:g})},ve=()=>{var t="";let s=!1;return u.map(a=>{a.Status!=null&&a.Status!=a.Text3&&(s=!0),a.IsClickable&&(t=t+'<SchoolWiseAttendance Attendance_Date="'+a.Value+'" Is_Present="'+(a.Status!=null?a.Status:a.Text3)+'" />')}),X(s),"<Attendance>"+t+"</Attendance>"};n.useEffect(()=>{T!==""&&Ye.success(T,{toastId:"success1"}),p(Le()),p(oe(q))},[T]);const ye=()=>{const t={asSchoolId:v,asInsertedById:de,asStudentsAttendance:fe,aStudentId:Number(i),aYear:new Date(U(o)).getFullYear(),aMonthId:Number(k)};p(Oe(t))},ae=new Date;ae.setHours(0,0,0,0);const m=j>ae;return e.jsxs(h,{sx:{px:2},children:[e.jsx(Ne,{navLinks:[{title:"Attendance",path:"/RITeSchool/Teacher/TAttendance/"+ce(c)+"/"+ce(f)},{title:"Individual Attendance",path:"/RITeSchool/Teacher/TAttendance/IndividualAttendance"}],rightActions:e.jsx(e.Fragment,{children:e.jsx(B,{direction:{xs:"row",sm:"row"},gap:1,alignItems:"center",justifyContent:"flex-end",sx:{width:"100%",flexWrap:{xs:"nowrap",sm:"nowrap"}},children:e.jsxs(B,{direction:{xs:"row",sm:"row"},gap:1,alignItems:"center",justifyContent:"flex-start",sx:{width:"100%",flexWrap:{xs:"wrap",sm:"nowrap"}},children:[e.jsx(h,{sx:{width:{xs:"100%",sm:"auto"}},children:e.jsx(Pe,{sx:{minWidth:{xs:"200px",sm:"250px",md:"250px",lg:"350px",xl:"350px"}},ItemList:r,onChange:me,defaultValue:i,size:"small"})}),e.jsx(I,{title:"Mark monthly attendance of an individual student.",children:e.jsx(x,{sx:{color:"white",backgroundColor:ie[500],height:"36px !important",":hover":{backgroundColor:ie[600]}},children:e.jsx(Ee,{})})}),e.jsx(I,{title:"Present All",children:e.jsx(x,{onClick:ne,disabled:m||i===""||M,sx:{color:"white",height:"36px !important",width:"36px",backgroundColor:l[500],":hover":{backgroundColor:l[600]},...m&&{backgroundColor:"grey",":hover":{backgroundColor:"grey"}}},children:e.jsx("h5",{children:"P"})})}),e.jsx(Be,{disableScrollLock:!0,anchorEl:Ae.current,onClose:()=>L(!C),open:C,anchorOrigin:{vertical:"center",horizontal:"center"},transformOrigin:{vertical:"center",horizontal:"center"},children:e.jsx(Re,{sx:{py:5},children:e.jsxs(h,{width:400,gap:5,alignContent:"center",mx:2,children:[e.jsx(b,{color:"",mb:3,textAlign:"center",children:"Are you sure you want the chosen student to be marked as absent on each day?"}),e.jsxs(B,{direction:"row",gap:7,mx:5,justifyContent:"space-between",children:[e.jsx(d,{variant:"outlined",sx:{px:6},color:"error",onClick:P,children:"Cancel"}),e.jsx(d,{variant:"contained",sx:{px:6,backgroundColor:l[600],color:"white"},color:"primary",children:"Confirm"})]})]})})}),e.jsxs(O,{onClose:()=>L(!C),open:C,fullWidth:!0,maxWidth:"xs",children:[e.jsxs(H,{variant:"h3",sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:["Mark all as Absent",e.jsx(x,{onClick:()=>{L(!C)},children:e.jsx(W,{})})]}),e.jsx($,{dividers:!0,children:e.jsx(h,{py:2,children:e.jsx(b,{variant:"h4",textAlign:"center",children:"Are you sure you want the chosen student to be marked as absent on each day?"})})}),e.jsxs(R,{sx:{px:3,py:2},children:[e.jsx(d,{variant:"outlined",color:"error",onClick:P,children:"Cancel"}),e.jsx(d,{variant:"contained",sx:{backgroundColor:l[600],color:"white"},children:"Confirm"})]})]}),e.jsx(I,{title:"Absent All",children:e.jsx(x,{onClick:P,disabled:m||i===""||M,sx:{color:"white",height:"36px !important",width:"36px",backgroundColor:le[500],":hover":{backgroundColor:le[600]},...m&&{backgroundColor:"grey",":hover":{backgroundColor:"grey"}}},children:e.jsx("h5",{children:"A"})})}),e.jsxs(O,{onClose:()=>Z(!F),open:F,fullWidth:!0,maxWidth:"xs",children:[e.jsxs(H,{variant:"h3",sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:["Save Changes",e.jsx(x,{onClick:()=>{Z(!F)},children:e.jsx(W,{})})]}),e.jsx($,{dividers:!0,children:e.jsx(h,{py:2,children:e.jsx(b,{variant:"h4",textAlign:"center",children:"Are you sure, Do you want to update changes?"})})}),e.jsxs(R,{sx:{py:2,px:3},children:[e.jsx(d,{variant:"outlined",color:"error",onClick:te,children:"Cancel"}),e.jsx(d,{variant:"contained",sx:{backgroundColor:l[600],color:"white"},children:"Update"})]})]}),e.jsx(I,{title:"Save",children:e.jsx(x,{onClick:te,disabled:m||i===""||M,sx:{color:"white",height:"36px !important",width:"36px",backgroundColor:l[500],":hover":{backgroundColor:l[600]},...m&&{backgroundColor:"grey",":hover":{backgroundColor:"grey"}}},children:e.jsx(We,{})})})]})})})}),e.jsx(h,{children:e.jsx($e,{ItemList:u,ClickItem:je,handlePrevMonth:pe,handleNextMonth:Ce,formattedDate:o,DefaultValue:ue,ArrayList:ge})}),e.jsxs(O,{onClose:()=>ee(!Y),open:Y,fullWidth:!0,maxWidth:"xs",children:[e.jsxs(H,{variant:"h3",sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},color:"success",children:["Mark all as Present",e.jsx(x,{onClick:()=>{ee(!Y)},children:e.jsx(W,{})})]}),e.jsx($,{dividers:!0,children:e.jsx(h,{py:2,children:e.jsx(b,{variant:"h4",textAlign:"center",children:"Are you sure you want the chosen student to be marked as present on each day?"})})}),e.jsxs(R,{sx:{px:3,py:2},children:[e.jsx(d,{variant:"outlined",color:"error",onClick:ne,children:"Cancel"}),e.jsx(d,{variant:"contained",sx:{backgroundColor:l[600],color:"white"},children:"Confirm"})]})]})]})};export{et as default};

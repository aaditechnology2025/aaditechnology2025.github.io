import{A as X,w as Z,x as d,u as ee,c as x,r as a,cO as v,bO as te,j as e,B as H,T as ae,ce as Y,bQ as w,n as se}from"./index-d5YOjbb6.js";import{h as k}from"./moment-CaEEsv53.js";import{E as oe}from"./ErrorMessages-D1wiRwH0.js";import{M as ne}from"./MonthSelector-CcQskbx0.js";import{P as re}from"./PageHeader-DqqjGq3-.js";import{I as ce}from"./icon1-D1Tpz3V0.js";import{L as le}from"./List1-CMmC98bZ.js";import{F as ie}from"./FormGroup-XtcIGgvX.js";import"./ArrowRight-DTTKgIal.js";import"./Attachment-DgcWq5kr.js";function Me(){X();let{DateFrommon:c,DateFromyear:s,Pholiday:m,Pevent:D,Pexam:p}=Z();c=d(c),s=d(s),m=d(m),D=d(D),p=d(p);const y=new Date(Number(s),Number(c)).getMonth(),u=ee();x(t=>t.AnnualPlanner.EventList);const $=x(t=>t.AnnualPlanner.Event),z=x(t=>t.AnnualPlanner.Loading),S=x(t=>t.AnnualPlanner.FilePath),R="These events may change due to unavoidable reasons without prior notice.",P=sessionStorage.getItem("AcademicYearId"),F=localStorage.getItem("localSchoolId"),_=sessionStorage.getItem("Id"),[l,A]=a.useState({selectedDate:null}),[L,M]=a.useState(),[r,b]=a.useState(),[h,C]=a.useState(!1),[g,N]=a.useState(!0),[f,T]=a.useState(!1),I={asSchoolId:F,asAcademicYearId:P,asMonth:r,asYear:L,asUserId:_,abIncludeEvents:g.toString(),abIncludeHolidays:h.toString(),abIncludeExams:f.toString()};function j(t){const o=t||new Date,i=new Date(o).toLocaleString("default",{month:"short"}),n=new Date(o).getMonth(),U=new Date(o).getFullYear(),W=`${i} ${U}`;A({selectedDate:W}),b(y),M(s),M(U),b(n+1)}a.useEffect(()=>{m!==void 0&&(C(m!=="false"),N(D!=="false"),T(p!=="false")),localStorage.setItem("url",window.location.pathname),j(),c!=null&&A({selectedDate:`${new Date(y+"/01/"+s).toLocaleString("default",{month:"short"})} ${s}`})},[]),a.useEffect(()=>{(c||s!=null)&&(b(c),M(s))},[c,s]),a.useEffect(()=>{r!==void 0&&u(v(I))},[r,g]),a.useEffect(()=>{r!==void 0&&u(v(I))},[r,h]),a.useEffect(()=>{r!==void 0&&u(v(I))},[r,f]);const G=()=>{const{selectedDate:t}=l,o=t.includes("-")?t.split("-"):t.split(" "),i=Date.parse(o[0]+"01,"+o[1]),n=new Date(i);n.setMonth(n.getMonth()-1),j(n)},O=()=>{const{selectedDate:t}=l,o=t.includes("-")?t.split("-"):t.split(" "),i=Date.parse(o[0]+"01,"+o[1]),n=new Date(i);n.setMonth(n.getMonth()+1),j(n)},V=new Date(k(sessionStorage.getItem("StartDate")).format("YYYY-MM")),Q=new Date(k(sessionStorage.getItem("EndDate")).format("YYYY-MM")),E=typeof l.selectedDate=="string"?l.selectedDate.split(" "):l.selectedDate,q=Array.isArray(E)?Date.parse(E[0]+"01,"+E[1]):l.selectedDate,B=new Date(k(q).format("YYYY-MM")),J={aiSchoolId:F,aiAcademicYearId:P};a.useEffect(()=>{u(te(J))},[]);const K=()=>{S!==""&&window.open(localStorage.getItem("SiteURL")+S)};return e.jsxs(H,{sx:{px:2},children:[e.jsx(re,{heading:"Annual Planner",subheading:""}),S!==""&&e.jsxs("div",{children:[e.jsx(ae,{component:"span",sx:{color:"brown",textDecoration:"underline"},onClick:K,children:"Annual Planner"}),e.jsx("br",{})]}),e.jsx("br",{}),e.jsxs(ie,{sx:{display:"inline"},children:[e.jsx(Y,{control:e.jsx(w,{checked:g,onChange:t=>N(t.target.checked),sx:{color:"#757575","&.Mui-checked":{color:"#aeeded"},borderColor:"black"},size:"small"}),label:"Event"}),e.jsx(Y,{control:e.jsx(w,{checked:h,onChange:t=>C(t.target.checked),sx:{color:"#757575","&.Mui-checked":{color:"#ffcdd2"},borderColor:"black"},size:"small"}),label:"Holiday"}),e.jsx(Y,{control:e.jsx(w,{checked:f,onChange:t=>T(t.target.checked),sx:{color:"#757575","&.Mui-checked":{color:"#d8eb88"},borderColor:"black"},size:"small"}),label:"Exam"}),e.jsx(H,{sx:{float:"right",mt:"10px"},children:e.jsx(ce,{Note:R})})]}),e.jsx("br",{}),e.jsx(ne,{date:l.selectedDate,PrevDate:G,NextDate:O,Close:void 0}),z?e.jsx(se,{}):e.jsx(e.Fragment,{children:V.getTime()<=B.getTime()&&Q.getTime()>=B.getTime()?e.jsx(e.Fragment,{children:e.jsx(le,{items:$,linkParams:"/"+r+"/"+L+"/"+h+"/"+g+"/"+f})}):e.jsx(oe,{Error:"Selected date is outside academic year"})})]})}export{Me as default};

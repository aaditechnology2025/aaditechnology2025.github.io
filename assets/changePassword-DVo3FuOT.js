import{A as S,u as N,c as I,r as c,E as v,j as s,B as l,F as A,H as h,I as m,J as w,K as O,L as p,M as k,N as B,O as T,T as E,Q as F,R as a,G as t,q as n,U,o as L,t as x}from"./index-d5YOjbb6.js";import{d as R}from"./Save-Ckr0NoeK.js";import{u as W}from"./formik.esm-DT8TU67t.js";import{E as i}from"./Errormessage-RPRSgLGN.js";import{L as z}from"./CardStyle-B9qFmFtz.js";import{C as D}from"./CommonStyle-DTS3LGaG.js";import"./Card-BrM9kpJu.js";function M(){const g=S(),f=N();sessionStorage.getItem("TermsAccepted"),I(r=>r.TermAndConditions.GetAcceptTermResult);const j=()=>{localStorage.removeItem("auth"),sessionStorage.clear(),g("/Sessionlogout")},{showAlert:P,closeAlert:u}=c.useContext(v),[$,C]=c.useState(),b=()=>{const r={asUserName:sessionStorage.getItem("Userlogin"),asUserId:sessionStorage.getItem("Id"),asSchoolId:localStorage.getItem("localSchoolId"),asNewPassword:e.values.ConfirmPassword,asOldPassword:e.values.Oldpassword};P({title:"Please Confirm",message:"Are you sure you want to change your password?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{u()},onConfirm:()=>{f(U({asSchoolId:localStorage.getItem("localSchoolId"),asUserId:sessionStorage.getItem("Id")})),L.post("School/ChangePassword",r).then(o=>{const d=o.data;C(d),d==="True"?(x.success("Password changed successfully."),j()):x.error(d)}),u()}})},y=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]/,e=W({initialValues:{UserLogin:sessionStorage.getItem("Userlogin"),Oldpassword:"",NewPassword:"",ConfirmPassword:""},onSubmit:b,validate:r=>{const o={};return r.Oldpassword||(o.Oldpassword="Old password should not be blank."),r.NewPassword?r.NewPassword.length<6?o.NewPassword="Password should be of minimum 6 characters.":r.NewPassword.length>15?o.NewPassword="Password must be a maximum of 15 characters":r.NewPassword===r.Oldpassword?o.NewPassword="Old Password and New Password should not be the same.":y.test(r.NewPassword)||(o.NewPassword="Password should be a combination of at least one lowercase letter, one uppercase letter, one numeric digit, and one special character."):o.NewPassword="New password should not be blank.",r.ConfirmPassword?r.ConfirmPassword!==r.NewPassword&&(o.ConfirmPassword="New password and confirm password should be the same."):o.ConfirmPassword="Confirm password should not be blank.",o}});return s.jsxs(s.Fragment,{children:[s.jsxs(l,{mb:2,children:[s.jsx(A,{navLinks:[{title:"Change Password",path:" "}],rightActions:s.jsxs(s.Fragment,{children:[s.jsx(h,{title:"Change your existing password. You will have to use the same while logging into the site.",children:s.jsx(m,{sx:{color:"white",backgroundColor:w[500],"&:hover":{backgroundColor:w[600]}},children:s.jsx(O,{})})}),s.jsx(h,{title:"Save",children:s.jsx(m,{sx:{color:"white",backgroundColor:p[500],"&:hover":{backgroundColor:p[600]}},onClick:r=>{r.preventDefault(),e.handleSubmit()},children:s.jsx(R,{})})})]})}),s.jsxs(k,{defaultExpanded:!0,children:[s.jsx(B,{expandIcon:s.jsx(T,{}),"aria-controls":"panel1-content",id:"panel1-header",children:s.jsx(E,{style:{fontWeight:"bold",fontSize:"20px"},children:"Important Notes"})}),s.jsxs(F,{sx:{gap:1,display:"flex",flexDirection:"column"},children:[s.jsx(a,{variant:"filled",severity:"info",children:s.jsx("b",{children:"Please reset your password for security purpose."})}),s.jsx(a,{variant:"filled",severity:"info",children:s.jsx("b",{children:"It seems you have not changed the system generated password. Please reset your password for security purpose."})}),s.jsx(a,{variant:"filled",severity:"info",children:s.jsx("b",{children:"Capitalization Matters! Min 6 characters, Max 15 characters."})}),s.jsx(a,{variant:"filled",severity:"info",children:s.jsx("b",{children:"Password should be combination of at least one lowercase letter, one uppercase letter, one numeric digit, and one special character."})})]})]})]}),s.jsxs(t,{container:!0,children:[s.jsx(t,{item:!0,md:3}),s.jsx(t,{item:!0,xs:12,md:6,children:s.jsx(z,{sx:D,children:s.jsxs("form",{onSubmit:e.handleSubmit,children:[s.jsx(l,{gap:2,children:s.jsx(n,{disabled:!0,fullWidth:!0,label:"User Name",margin:"normal",name:"username",type:"text",value:e.values.UserLogin,sx:{backgroundColor:"#F0F0F0"}})}),s.jsxs(l,{children:[s.jsx(n,{fullWidth:!0,margin:"normal",label:s.jsxs("span",{children:["Old Password ",s.jsx("span",{style:{color:"red"},children:"*"})]}),name:"Oldpassword",type:"password",value:e.values.Oldpassword,onChange:e.handleChange,onBlur:e.handleBlur}),e.touched.Oldpassword&&e.errors.Oldpassword?s.jsx(i,{Error:e.errors.Oldpassword}):null,s.jsx(n,{fullWidth:!0,margin:"normal",label:s.jsxs("span",{children:["New Password ",s.jsx("span",{style:{color:"red"},children:"*"})]}),name:"NewPassword",type:"password",value:e.values.NewPassword,onChange:e.handleChange,onBlur:e.handleBlur}),e.touched.NewPassword&&e.errors.NewPassword?s.jsx(i,{Error:e.errors.NewPassword}):null,s.jsx(n,{fullWidth:!0,margin:"normal",label:s.jsxs("span",{children:["Confirm Password ",s.jsx("span",{style:{color:"red"},children:"*"})]}),name:"ConfirmPassword",type:"password",value:e.values.ConfirmPassword,onChange:e.handleChange,onBlur:e.handleBlur}),e.touched.ConfirmPassword&&e.errors.ConfirmPassword?s.jsx(i,{Error:e.errors.ConfirmPassword}):null]})]})})}),s.jsx(t,{item:!0,md:3})]})]})}function Q(){return c.useEffect(()=>{localStorage.setItem("url",window.location.pathname)},[]),s.jsx(l,{sx:{px:2},children:s.jsx(M,{})})}export{Q as default};

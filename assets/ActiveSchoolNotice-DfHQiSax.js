import{A as f,r as p,j as e,B as h,ai as j,aj as A,ak as k,al as N,am as i,an as b,at as v,as as w,u as y,c as C,k as T,F as U}from"./index-d5YOjbb6.js";import{d as D}from"./FileDownloadOutlined-B-D7Fbww.js";const O=({itemList:g,downloadNotice:I,clickSingle:l})=>{const n=f();p.useState(!0);const d=(s,r)=>{l({name,value:s,checked:!r})},x=s=>{n("../"+s.replace("/Common/",""))};return e.jsx(e.Fragment,{children:e.jsx(h,{sx:{backgroundColor:"white"},children:e.jsx(j,{component:h,children:e.jsxs(A,{"aria-label":"simple table",sx:{py:1,border:s=>`1px solid ${s.palette.grey[300]}`,overflow:"hidden"},children:[e.jsx(k,{children:e.jsxs(N,{sx:{background:s=>s.palette.secondary.main,py:1},children:[e.jsx(i,{sx:{color:"white"},children:"Name"}),e.jsx(i,{sx:{color:"white",textAlign:"center",py:1},children:"Download"}),e.jsx(i,{sx:{color:"white",textAlign:"center",py:1},children:"Delete"})]})}),e.jsx(b,{children:g.map((s,r)=>e.jsxs(N,{onClick:()=>{x(s.linkPath)},children:[e.jsx(i,{sx:{textTransform:"capitalize",py:.5},children:s.header}),e.jsx(i,{sx:{textTransform:"capitalize",py:.5,textAlign:"center"},children:e.jsx(D,{onClick:()=>{I(s.FileName,s.IsImageNotice)}})}),e.jsx(i,{sx:{textTransform:"capitalize",py:.5,textAlign:"center"},children:e.jsx(v,{onClick:()=>d(s.id,s.isActive),sx:{color:"#38548A","&:hover":{color:"red",backgroundColor:w[100]}}})})]},r))})]})})})})},E=()=>{const g=y(),I=localStorage.getItem("localSchoolId"),l=sessionStorage.getItem("Id"),[n,d]=p.useState([]),x=C(o=>o.SchoolNoticeBoard.AllActiveNotices);p.useEffect(()=>{let o=[];localStorage.getItem("ImportantNotices")!==null&&JSON.parse(localStorage.getItem("ImportantNotices").toString()).map(c=>{c.UserId==l&&(o=c.ids.split(","))}),d(x.filter(t=>!o.includes(t.Id)).map((t,c)=>({id:t.Id,header:t.Name,text2:"",linkPath:"/Common/ViewActiveNotice/"+t.Id,FileName:t.FileName,IsText:t.IsText,IsImageNotice:t.IsImageNotice,isActive:!1})))},[x]),p.useEffect(()=>{g(T({asSchoolId:I,asUserId:l}))},[]);const s=(o,t)=>{t?window.open(localStorage.getItem("SiteURL")+"RITeSchool/Images/"+o):window.open(localStorage.getItem("SiteURL")+"RITeSchool/DOWNLOADS/School Notices/"+o)},r=o=>{let t=[],c=[],u=!1,m=localStorage.getItem("ImportantNotices");if(m!=null&&(c=JSON.parse(m),c.map(a=>{a.UserId==l&&(u=!0,t=a.ids.split(","))})),o.checked?t.push(o.value):t=t.filter(a=>a!==o.value),u){let a=[];c.map(S=>{a.push({UserId:S.UserId,ids:S.UserId==l?t.toString():S.ids})}),c=a}else c.push({UserId:l,ids:t.toString()});localStorage.setItem("ImportantNotices",JSON.stringify(c)),d(n.map(a=>a.id===o.value?{...a,isActive:o.checked}:a))};return e.jsxs(h,{sx:{px:2},children:[e.jsx(U,{navLinks:[{title:"School Notices",path:" "}]}),e.jsx(h,{sx:{backgroundColor:"white",p:1},children:e.jsx(O,{itemList:n,downloadNotice:s,clickSingle:r})})]})};export{E as default};

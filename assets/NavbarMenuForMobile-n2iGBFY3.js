import{c as P,r as a,j as n,G as o,B as c,T as p,u as $,g6 as q,F as z,q as J,g7 as K,g8 as O,g9 as Q}from"./index-d5YOjbb6.js";import{d as X}from"./Search-Cux6sdg-.js";import{E as C}from"./ErrorMessages-D1wiRwH0.js";import{C as M}from"./Card-BrM9kpJu.js";import{L as w}from"./Link-CIF-2ERy.js";const Y=()=>{const{GetNavbarMenuDetails:h,MenuDescription:u,ChildMenuId:x}=P(s=>s.NavbarMenu),[i,v]=a.useState("");a.useEffect(()=>{u.length>0&&v(u[0].MenuContent)},[u]);const d=h.filter(s=>s.MenuId===x),k=d.some(s=>s.FilePath!==""),b=d.some(s=>s.FilePath!==""&&!s.IsURL),g=d.some(s=>s.FilePath!==""&&s.IsURL);function m(s){var l=document.createElement("div");l.innerHTML=s;var j=l.textContent||l.innerText||"";return j}return n.jsxs(o,{container:!0,children:[n.jsx(o,{item:!0,xs:12,children:i&&n.jsx(M,{component:c,padding:2,mt:2,style:{overflow:"hidden",wordWrap:"break-word"},children:n.jsx("div",{dangerouslySetInnerHTML:{__html:m(i)}})})}),k&&n.jsx(o,{item:!0,xs:12,children:n.jsxs(M,{component:c,padding:1,mt:1,children:[b&&n.jsx(p,{variant:"h6",style:{fontWeight:"bold"},children:"Attachments:"}),g&&n.jsx(p,{variant:"h6",style:{fontWeight:"bold"},children:"URLs:"}),d.sort((s,l)=>s.AttachmentPriority-l.AttachmentPriority).map((s,l)=>n.jsxs("div",{children:[s.FilePath&&!s.IsURL&&n.jsx(w,{href:`${localStorage.getItem("SiteURL")}${s.FilePath}`,target:"_blank",children:s.LinkName}),s.FilePath&&s.IsURL&&n.jsx(w,{href:s.FilePath,target:"_blank",children:s.LinkName})]},l))]})})]})};function se(){const h=$(),u=P(e=>e.NavbarMenu.GetNavbarMenuDetails),x=P(e=>e.NavbarMenu.MenuDescription),i=P(e=>e.NavbarMenu.ChildMenuId),v=sessionStorage.getItem("RoleId"),d=Number(localStorage.getItem("localSchoolId")),[k,b]=a.useState([]),[g,m]=a.useState([]),[s,l]=a.useState(""),[j,F]=a.useState(!1),[y,E]=a.useState([]);a.useState(0);const[S,D]=a.useState({MenuId:0,ParentMenuId:0}),[U,G]=a.useState(0),[A,R]=a.useState(""),B={aiSchoolId:d,aiUserRoleId:v,IsRefresh:!1};a.useEffect(()=>{if(S.MenuId==0)E(u.filter(e=>e.LevelIndex==1));else{let e=[],t=[S.MenuId];u.map(r=>{t.includes(r.MenuId)&&(t.includes(r.ParentMenuId)||t.push(r.ParentMenuId))}),u.map(r=>{t.includes(r.MenuId)&&(t.includes(r.ParentMenuId)||t.push(r.ParentMenuId))}),u.map(r=>{t.includes(r.MenuId)&&(t.includes(r.ParentMenuId)||t.push(r.ParentMenuId))}),u.map(r=>{t.includes(r.MenuId)&&e.push(r)}),E(e),b(u.filter(r=>r.ParentMenuId==S.MenuId))}},[u,S]),a.useEffect(()=>{T(),L()},[U,i]);const I=e=>{R(""),F(!1),G(e.ParentMenuId),h(K(e.MenuId)),D(e);let t=N(e.MenuId);(t==null?void 0:t.MenuTypeId)=="2"?h(Q({aiMenuId:t.MenuId,aiSchoolId:d})):h(O())};a.useEffect(()=>{x.length>0&&R(x[0].MenuContent)},[x]),a.useEffect(()=>{I({ParentMenuId:"0",MenuId:"0"}),h(q({...B,IsRefresh:!1}))},[]);const H=()=>{F(!0);let e=s;e.length>3?(e.split(" "),e.length>3&&m(u.filter(t=>t.MenuName.toLowerCase().includes(e.toLowerCase())))):m([])},V=e=>e*4,N=e=>{let t=[],r=null;return u.filter(f=>f.MenuId==e).map(f=>{t.includes(f.MenuId)||(t.push(f.MenuId),r=f)}),r},T=()=>{let e=[],t=i,r=N(t);for(;r!==null;)e=[r,...e],t=r.ParentMenuId,r=N(t);return e};a.useState([]);const L=()=>{let e=[],t=[];return u.filter(r=>r.ParentMenuId==i).map(r=>{e.includes(r.MenuId)||(e.push(r.MenuId),t.push(r))}),t},W=()=>{let e=!1;return u.filter(t=>t.MenuId==i).map((t,r)=>{t.FilePath!=""&&(e=!0)}),e},_=()=>{let e=W();return A!=""&&(e=!0),e};return n.jsxs(c,{sx:{px:2},children:[n.jsx(z,{navLinks:[{title:"School Menus",path:""}],rightActions:[]}),j&&n.jsxs(o,{container:!0,children:[n.jsx(o,{item:!0,xs:6,children:n.jsx(J,{label:"Search",fullWidth:!0,onChange:e=>{l(e.target.value)},value:s})}),n.jsx(o,{item:!0,xs:6,children:n.jsx(X,{fontSize:"large",onClick:H,sx:{marginTop:"8px",cursor:"pointer"}})})]}),j?s.length<=3?n.jsx(C,{Error:"Please enter more than 3 characters"}):g.length==0?n.jsx(C,{Error:"No records found"}):n.jsx(o,{container:!0,children:g.map((e,t)=>n.jsx(o,{item:!0,xs:12,onClick:()=>{I(e)},children:n.jsx(M,{component:c,padding:1,mt:1,children:e.MenuName})},t))}):n.jsxs(n.Fragment,{children:[n.jsx(p,{variant:"h4",sx:{backgroundColor:"white",p:1},children:"Menu"}),y.length==0?n.jsx(C,{Error:"No records found"}):n.jsxs(o,{container:!0,children:[n.jsx(o,{item:!0,xs:12,onClick:()=>{I({ParentMenuId:"0",MenuId:"0"})},children:n.jsx(M,{component:c,padding:1,mt:1,children:"Home"})}),T().map((e,t)=>n.jsx(o,{item:!0,xs:12,onClick:()=>{I(e)},children:n.jsx(M,{component:c,padding:1,mt:1,ml:e.ParentMenuId?V(t+1):4,children:e.MenuName})},t))]}),n.jsx("br",{}),_()&&n.jsxs(n.Fragment,{children:[n.jsx(p,{variant:"h4",sx:{backgroundColor:"white",p:1},children:"Content"}),n.jsx(Y,{})," "]}),n.jsx("br",{}),n.jsx(p,{variant:"h4",sx:{backgroundColor:"white",p:1},children:"Sub-Menu"}),L().length==0?n.jsx(C,{Error:"No records found"}):n.jsx(o,{container:!0,children:L().map((e,t)=>n.jsx(o,{item:!0,xs:12,onClick:()=>{I(e)},children:n.jsx(M,{component:c,padding:1,mt:1,children:e.MenuName})},t))})]})]})}export{se as default};

import{u as ne,c as f,ag as oe,r as i,kJ as ie,t as le,kK as F,kL as de,j as s,B as S,F as ce,m as y,p as ue,G as w,q as C,H as E,I as M,L as B,J as D,T as L,ai as xe,aj as be,ak as he,al as W,am as u,hh as z,an as me,kM as ge}from"./index-d5YOjbb6.js";import{d as pe}from"./Save-Ckr0NoeK.js";import{Q as fe}from"./QuestionMark-C2Y4lgD8.js";const x={padding:"0.2em 1.5em"},we=()=>{const h=ne(),m=f(e=>e.AssignPrePrimaryGrades.listGradesDetails);f(e=>e.AssignPrePrimaryGrades.ISGetNonXseedStudentsName);const v=f(e=>e.AssignPrePrimaryGrades.IGetSaveNonXseedSubGradesMsg);f(e=>e.AssignPrePrimaryGrades.Loading);const V=oe(),{EditStatusId:c,ClassName:Y,Assesment:H,SelectTerm:g,SubjectName:J,SubjectId:T,StandardDivisionId:j,selectTeacher:G}=V.state||{},[$,Q]=i.useState("0-0-0"),[l,N]=i.useState({}),[p,I]=i.useState({}),[P,A]=i.useState(""),[O,X]=i.useState(""),[U,q]=i.useState(""),[K,_]=i.useState("");i.useEffect(()=>{h(ie(k))},[h]),i.useEffect(()=>{v!==""&&(le.success(v),h(F(k))),h(de())},[v]);const d=f(e=>e.AssignPrePrimaryGrades.ISGetNonXseedStudentsObs);i.useEffect(()=>{h(F(k))},[]),i.useEffect(()=>{if(d.length>0){const e=d.reduce((a,t)=>(a[t.Text1]=te(t.Text3),a),{}),r=d.reduce((a,t)=>(a[t.Text1]=t.Text4,a),{});N(e),I(r),q(JSON.stringify(e)),_(JSON.stringify(r))}},[d]);const Z=(e,r,a)=>{Q(e);const t=d.reduce((n,o)=>(n[o.Text1]=e,n),{});if(N(t),e==="0-0-0"||r==="1"||a==="1"){const n=d.reduce((o,b)=>(o[b.Text1]="",o),{});I(n)}},ee=(e,r,a,t)=>{N(n=>({...n,[e]:r})),(r==="0-0-0"||a==="1"||t==="1")&&I(n=>({...n,[e]:""}))},R=(e,r)=>{I(a=>({...a,[e]:r}))},k={asSchoolId:Number(localStorage.getItem("localSchoolId")),asAcademicYearId:Number(sessionStorage.getItem("AcademicYearId")),asStandardDivisionId:Number(j),asAssessmentId:Number(g),asSubjectId:Number(T)},se=()=>{let e="";return d.forEach(r=>{var b;const a=r.Text5,t=r.Text1,n=(b=l[t])==null?void 0:b.split("-")[0],o=p[t];n!=="0"&&(e+="<NonXseedSubjectGrades><YearwiseStudentId>"+a+"</YearwiseStudentId><AssessmentId>"+g+"</AssessmentId><Observation>"+o+"</Observation><StandardDivisionId>"+j+"</StandardDivisionId><ShowSubjectRemark>false</ShowSubjectRemark><NonXseedSubjectGradeId>0</NonXseedSubjectGradeId><SubjectId>"+T+"</SubjectId><GradeId>"+n+"</GradeId></NonXseedSubjectGrades>")}),e=`<ArrayOfNonXseedSubjectGrades xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
        ${e}</ArrayOfNonXseedSubjectGrades>`,e};function te(e){if(m.length>0)return(m==null?void 0:m.filter(a=>{var t;return((t=a.Value)==null?void 0:t.split("-")[0])===e}))[0].Value}const[Se,ae]=i.useState(!1),re=()=>{A(""),X("");const e=Object.keys(l).filter(t=>{var o;const n=(o=l[t])==null?void 0:o.split("-");return l[t]!=="0-0-0"&&!p[t]&&n[1]!=="1"&&n[2]!=="1"}),r=Object.keys(l).filter(t=>l[t]=="0-0-0"&&!p[t]);ae(r.length>0);const a={asXseedGradesXML:se(),asSchoolId:Number(localStorage.getItem("localSchoolId")),asAcademicYearId:Number(sessionStorage.getItem("AcademicYearId")),asAssessmentId:Number(g),asStandardDivId:Number(j),asSubjectId:Number(T),asInsertedById:Number(sessionStorage.getItem("Id")),asUpdatedById:Number(sessionStorage.getItem("Id"))};if(e.length>0){A(`Observation should not be blank for row(s): ${e.toString()}`);return}else r.length===d.length?X("Fields should not be blank."):(U!==JSON.stringify(l)||K!==JSON.stringify(p))&&h(ge(a))};return s.jsx(s.Fragment,{children:s.jsxs(S,{sx:{px:2},children:[s.jsx(ce,{navLinks:[{title:G==="RP"?"Pre-Primary Progress Report Results":"Assign Pre-Primary Grades",path:G==="RP"?`/RITeSchool/Teacher/PrePrimaryResult/${y(g)}/${y(j)}`:"/RITeSchool/Teacher/AssignPrePrimaryGrades/"+y(g)+"/"+y(G)},{title:"Assign Subject Grades",path:""}],rightActions:s.jsx(s.Fragment,{children:s.jsxs(ue,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:"left",gap:1,sx:{mt:{xs:0,sm:0},flexWrap:{xs:"nowrap",sm:"nowrap"}},children:[s.jsx(w,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:s.jsx(C,{fullWidth:!0,label:"Class",value:Y,sx:{bgcolor:"#F0F0F0",width:{xs:"40vw",sm:"12vw"},"& .MuiInputBase-input":{cursor:"default"}},size:"small",InputProps:{readOnly:!0}})}),s.jsx(w,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:s.jsx(C,{fullWidth:!0,label:"Assessment",value:H,sx:{bgcolor:"#F0F0F0",width:{xs:"40vw",sm:"12vw"},"& .MuiInputBase-input":{cursor:"default"}},size:"small",InputProps:{readOnly:!0}})}),s.jsx(w,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:s.jsx(C,{fullWidth:!0,label:"Subject Name",value:J,sx:{bgcolor:"#F0F0F0",width:{xs:"40vw",sm:"12vw"},"& .MuiInputBase-input":{cursor:"default"}},size:"small",InputProps:{readOnly:!0}})}),s.jsxs(w,{item:!0,xs:12,gap:1,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:[c!=="3"&&c!=="3P"&&s.jsx(E,{title:"Save",children:s.jsx(M,{onClick:re,sx:{background:B[500],color:"white","&:hover":{backgroundColor:B[600]}},children:s.jsx(pe,{})})}),s.jsx(E,{title:'Assign grades to each student in the class for selected subject and click on " Save".',children:s.jsx(M,{sx:{color:"white",backgroundColor:D[500],height:"36px !important",":hover":{backgroundColor:D[600]}},children:s.jsx(fe,{})})})]})]})})}),c==="3"&&s.jsx(L,{variant:"body1",sx:{textAlign:"center",marginBottom:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:s.jsx("b",{children:"Student grades are already submitted."})}),c==="3P"&&s.jsx(L,{variant:"body1",sx:{textAlign:"center",marginBottom:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:s.jsx("b",{children:"Results for this assessment has been published. You need to unpublish the assessment to update the grades."})}),d.length===0?s.jsx("span",{}):s.jsxs(S,{sx:{background:"white",p:2},children:[O!==""&&s.jsx(S,{mb:1,children:s.jsx("div",{style:{color:"red",fontWeight:"bolder"},children:O})}),P!==""&&s.jsx(S,{mb:1,children:s.jsx("div",{style:{color:"red",fontWeight:"bolder"},children:P})}),s.jsx(xe,{component:S,children:s.jsxs(be,{"aria-label":"simple table",sx:{border:e=>`1px solid ${e.palette.divider}`},children:[s.jsx(he,{children:s.jsxs(W,{children:[s.jsx(u,{align:"left",sx:{fontWeight:"700",textTransform:"capitalize",backgroundColor:e=>e.palette.secondary.main,color:"white",...x,pt:"15px",pb:"15px"},children:"Roll No."}),s.jsx(u,{align:"left",sx:{fontWeight:"700",textTransform:"capitalize",backgroundColor:e=>e.palette.secondary.main,color:"white",...x,pt:"15px",pb:"15px"},children:"Student Name"}),s.jsx(u,{align:"right",sx:{fontWeight:"700",textTransform:"capitalize",backgroundColor:e=>e.palette.secondary.main,color:"white",...x,pt:"15px",pb:"15px"},children:"Grade"}),s.jsx(u,{align:"left",sx:{textTransform:"capitalize",backgroundColor:e=>e.palette.secondary.main,color:"white",...x},children:s.jsx(s.Fragment,{children:s.jsx(z,{sx:{maxWidth:"15vw",backgroundColor:"white"},ItemList:m,onChange:e=>Z(e.Value,e.isAbsent,e.isExempted),label:"",disabled:c==="3"||c==="3P",defaultValue:$,size:"small",DisableClearable:!0})})}),s.jsx(u,{align:"left",sx:{fontWeight:"700",textTransform:"capitalize",backgroundColor:e=>e.palette.secondary.main,color:"white",...x,pt:"15px",pb:"15px"},children:"Observations"})]})}),s.jsx(me,{children:d.length!==0&&d.map((e,r)=>{var a,t,n;return s.jsxs(W,{children:[s.jsx(u,{align:"left",sx:{...x},children:e.Text1}),s.jsx(u,{sx:{...x},children:e.Text2}),s.jsx(u,{align:"center",sx:{...x}}),s.jsx(u,{align:"left",sx:{...x},children:s.jsx(z,{sx:{width:"15vw",backgroundColor:"white"},ItemList:m,onChange:o=>ee(e.Text1,o.Value,o.isAbsent,o.isExempted),label:"",disabled:c==="3"||c==="3P",defaultValue:l[e.Text1],DisableClearable:!0,size:"small"})}),s.jsx(u,{align:"left",sx:{...x},children:s.jsx("textarea",{rows:2,cols:50,style:{backgroundColor:"white"},disabled:c==="3"||c==="3P"||((a=l[e.Text1])==null?void 0:a.split("-")[0])==="0"||((t=l[e.Text1])==null?void 0:t.split("-")[1])==="1"?!0:((n=l[e.Text1])==null?void 0:n.split("-")[2])==="1",value:p[e.Text1],onChange:o=>{const b=o.target.value;b.trim()!==""?R(e.Text1,b):R(e.Text1,"")},maxLength:500})})]},r)})})]})})]})]})})};export{we as default};

import{j as e,B as h,ai as ne,c8 as le,aj as ie,ak as ce,al as G,am as a,an as xe,I,as as P,H as S,u as de,r as o,E as he,c as v,nA as j,t as ue,nH as me,F as ge,p as pe,G as U,q as _,nI as je,J as H,T as Q,ce as Ce,bQ as fe,ay as ke,nJ as ye}from"./index-d5YOjbb6.js";import{d as C}from"./ArrowCircleUp-BmCXupv-.js";import{d as be}from"./Close-DJWwbmdJ.js";import{A as f}from"./ArrowCircleDown-BpJDJL07.js";import{S as we}from"./SearchTwoTone-jqpeT8QG.js";import{Q as Te}from"./QuestionMark-C2Y4lgD8.js";const Be=({data:r,showAllUsers:k,handleDelete:y,handleSortChange:n,SortBy:l,SortDirection:i})=>{const c=Array.isArray(r)?r:[];return e.jsx(h,{children:e.jsx(ne,{component:le,children:e.jsxs(ie,{"aria-label":"simple table",sx:{border:t=>`1px solid ${t.palette.divider}`,"& .MuiTableCell-root":{padding:"8px"}},children:[e.jsx(ce,{children:e.jsxs(G,{sx:{background:t=>t.palette.secondary.main},children:[e.jsx(a,{sx:{color:"white",py:1},children:e.jsxs("b",{onClick:()=>n("Book_Title"),style:{cursor:"pointer",display:"flex",alignItems:"center"},children:["Book Title",l==="Book_Title"&&(i==="asc"?e.jsx(C,{}):e.jsx(f,{}))]})}),k&&e.jsxs(e.Fragment,{children:[e.jsx(a,{sx:{color:"white",py:1},children:e.jsxs("b",{onClick:()=>n("Name"),style:{cursor:"pointer",display:"flex",alignItems:"center"},children:["User Name",l==="Name"&&(i==="asc"?e.jsx(C,{}):e.jsx(f,{}))]})}),e.jsx(a,{sx:{color:"white",py:1,textAlign:"center"},children:e.jsxs("b",{onClick:()=>n("Class"),style:{cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:["Class",l==="Class"&&(i==="asc"?e.jsx(C,{}):e.jsx(f,{}))]})}),e.jsx(a,{sx:{color:"white",py:1},children:e.jsxs("b",{onClick:()=>n("Designation"),style:{cursor:"pointer",display:"flex",alignItems:"center"},children:["Designation",l==="Designation"&&(i==="asc"?e.jsx(C,{}):e.jsx(f,{}))]})})]}),e.jsx(a,{sx:{color:"white",py:1,textAlign:"center"},children:e.jsxs("b",{onClick:()=>n("ReservationDate"),style:{cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"},children:["Date",l==="ReservationDate"&&(i==="asc"?e.jsx(C,{}):e.jsx(f,{}))]})}),e.jsx(a,{sx:{color:"white",py:1,textAlign:"center"},children:e.jsx("b",{children:"Cancel"})})]})}),e.jsx(xe,{children:c.map((t,u)=>e.jsxs(G,{sx:{height:"10px"},children:[e.jsx(a,{sx:{textAlign:"left",py:1,textTransform:"capitalize"},children:t.bookTitle}),k&&e.jsxs(e.Fragment,{children:[e.jsx(a,{sx:{textAlign:"left",py:1,textTransform:"capitalize"},children:t.userName}),e.jsx(a,{sx:{textAlign:"center",py:1,textTransform:"capitalize"},children:t.class}),e.jsx(a,{sx:{textAlign:"left",py:1,textTransform:"capitalize"},children:t.designation})]}),e.jsx(a,{sx:{textAlign:"center",py:1,textTransform:"capitalize"},children:t.date}),e.jsx(a,{sx:{textAlign:"center",py:1,opacity:1,"& .MuiIconButton-root":{padding:0}},children:t.UserId===localStorage.getItem("UserId")&&e.jsx(I,{onClick:()=>y(t.BookId),sx:{color:"#223354","&:hover":{color:"red",backgroundColor:P[100]}},children:e.jsx(S,{title:"Cancel",children:e.jsx(be,{})})})})]},u))})]})})})},Ue=()=>{const r=de(),{showAlert:k,closeAlert:y}=o.useContext(he),n=Number(localStorage.getItem("localSchoolId")),l=Number(localStorage.getItem("UserId")),i=Number(sessionStorage.getItem("AcademicYearId")),[c,t]=o.useState(!1),[u,L]=o.useState(""),[b,M]=o.useState(""),[w,E]=o.useState("asc"),[T,J]=o.useState("Book_Title"),[d,K]=o.useState(20),[B,F]=o.useState(1),[O,m]=o.useState([]),V=[20,50,100,200],A=v(s=>s.SchoolLibrary.ICancelBookReservationMsg),x=v(s=>s.SchoolLibrary.IGetReserveBookDetails),g=v(s=>s.SchoolLibrary.IGetReserveBookDetailsCount).map(s=>s.Count);v(s=>s.SchoolLibrary.Loading);const Y=s=>{F(s)},$=s=>{K(parseInt(s.target.value,20)),F(1)},q=(B-1)*d+1,z=Math.min(B*d,g),X=Math.ceil(g/d),Z=s=>{T===s?E(w==="asc"?"desc":"asc"):(J(s),E("asc"))},D=(B-1)*d,W=D+d,p={asSchoolId:n,asAcademicYearId:i,asUserID:l,asStartIndex:D,asEndIndex:W,asBookTitle:u,asUserName:b,asSortExpression:"Order By "+T+" "+w,asAllUserFlag:c==!0?1:0};o.useEffect(()=>{r(j(p))},[c,B,w,T,D,W]);const ee=()=>{t(!c)};o.useEffect(()=>{m(x)},[x]);const se=s=>{L(s)},te=s=>{M(s)},ae=()=>{m(u===""?x:x.filter(s=>s.bookTitle.toLowerCase().includes(u.toLowerCase()))),r(j(p))},R=()=>{ae(),m(b===""?x:x.filter(s=>s.userName.toLowerCase().includes(b.toLowerCase()))),r(j(p))},oe=()=>{L(""),M("");const s={...p,asBookTitle:"",asUserName:"",asAllUserFlag:c==!0?1:0,asStartIndex:0,asEndIndex:d};r(j(s))},re=s=>{if(!s)return;const N={asSchoolId:n,asAcademicYearId:i,asUserId:l,asBookid:Number(s)};k({title:"Please Confirm",message:"Are you sure you want to cancel the book claim?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{y()},onConfirm:()=>{r(ye(N)),y()}})};return o.useEffect(()=>{A!==""&&(ue.success(A),r(me()),r(j(p)))},[A]),e.jsxs(h,{px:2,children:[e.jsx(ge,{navLinks:[{title:"Library",path:"/RITeSchool/Teacher/LibraryBaseScreen"},{title:"Claimed Book Details",path:"/RITeSchool/Teacher/LibraryBaseScreen/ClaimedBookDetailsPage"}],rightActions:e.jsxs(pe,{direction:{xs:"column",sm:"row"},alignItems:"right",spacing:2,sx:{mt:{xs:0,sm:0},flexWrap:{xs:"nowrap",sm:"nowrap"}},children:[e.jsx(U,{item:!0,xs:12,sm:6,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(_,{fullWidth:!0,label:"User Name",variant:"outlined",size:"small",sx:{width:{xs:"50vw",sm:"10vw"}},onChange:s=>{te(s.target.value)},value:b,onKeyDown:s=>{(s.key==="Enter"||s.key==="Tab")&&R()}})}),e.jsx(U,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(_,{fullWidth:!0,label:"Book Title",variant:"outlined",size:"small",sx:{width:{xs:"50vw",sm:"13vw"}},onChange:s=>{se(s.target.value)},value:u,onKeyDown:s=>{(s.key==="Enter"||s.key==="Tab")&&R()}})}),e.jsxs(U,{item:!0,xs:12,gap:1,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-end"},children:[e.jsx(S,{title:"Search",children:e.jsx(I,{onClick:R,sx:{background:s=>s.palette.primary.main,color:"white","&:hover":{backgroundColor:s=>s.palette.primary.dark}},children:e.jsx(we,{})})}),e.jsx(S,{title:"Clear",children:e.jsx(I,{sx:{color:"white",backgroundColor:P[500],height:"36px !important",":hover":{backgroundColor:P[600]}},onClick:oe,children:e.jsx(je,{})})}),e.jsx(S,{title:"Displays the books claimed by user and user can cancel the book claim.",children:e.jsx(I,{sx:{color:"white",backgroundColor:H[500],"&:hover":{backgroundColor:H[600]}},children:e.jsx(Te,{})})})]})]})}),e.jsx(h,{sx:{backgroundColor:"white",p:2},children:x&&x.length===0?e.jsx(h,{sx:{backgroundColor:"#D2FDFC"},children:e.jsx(Q,{variant:"h6",align:"center",sx:{textAlign:"center",marginTop:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:"No record found."})}):e.jsxs(e.Fragment,{children:[e.jsx(Ce,{control:e.jsx(fe,{checked:c,onChange:ee}),label:"Show all claimed books by all users"}),g>0?e.jsx(h,{style:{flex:1,textAlign:"center"},children:e.jsxs(Q,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(h,{component:"span",fontWeight:"fontWeightBold",children:[q," to ",z]})," ","out of"," ",e.jsx(h,{component:"span",fontWeight:"fontWeightBold",children:g})," ",g===1?"record":"records"]})}):e.jsx("span",{children:" "}),e.jsx(Be,{data:O,showAllUsers:c,handleDelete:re,handleSortChange:Z,SortBy:T,SortDirection:w}),z>19?e.jsx(ke,{rowsPerPage:d,ChangeRowsPerPage:$,rowsPerPageOptions:V,PageChange:Y,pagecount:X}):e.jsx("span",{})]})})]})};export{Ue as default};

import{V as re,W as ie,j as e,w as ne,S as F,u as le,A as de,r as l,c as w,X as E,Y as ce,Z as M,_ as me,$ as Se,a0 as u,a1 as ue,G as n,a2 as ge,a3 as he,I as O,a4 as Ie,a5 as fe,a6 as xe,q as pe,B as _,T as v,a7 as Ne,a8 as De,a9 as k,aa as we,ab as ve,D as je,t as be}from"./index-d5YOjbb6.js";import{u as Ae}from"./formik.esm-DT8TU67t.js";import{r as V}from"./regulas-DwywiG5v.js";import{B as Ce}from"./ButtonStyle-DaPKUawX.js";import{U as Y,I as W,c as ye,d as j}from"./CardStyle-B9qFmFtz.js";import"./Card-BrM9kpJu.js";var b={},Re=ie;Object.defineProperty(b,"__esModule",{value:!0});var z=b.default=void 0,Pe=Re(re()),Ue=e,Te=(0,Pe.default)((0,Ue.jsx)("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"}),"VisibilityOff");z=b.default=Te;function _e(){const{userNameCredentails:A,SchoolId:x,UserId:g,Password:h,UserName:q}=ne(),J=F(),C=F(),I=le(),p=de(),G=localStorage.getItem("SchoolName"),[$,y]=l.useState("");let c=x??localStorage.getItem("localSchoolId");const H={username:g??"",password:h??"",showPassword:!1},[N,X]=l.useState(H),[R,S]=l.useState(!0),[i,D]=l.useState(),[Z,K]=l.useState(""),f=w(o=>o.SchoolList.SchoolList),m=w(o=>o.Dashboard.WebAuthenticateUser),P=w(o=>o.SchoolSettings.SchoolSettings),U=localStorage.getItem("auth");l.useEffect(()=>{localStorage.setItem("SchoolSettingsValue",JSON.stringify(P))},[P]),l.useEffect(()=>{var t;q!=null&&(c=null,S(!1)),c!=null&&c!=null&&(U===null?(x==null&&I(E({asSchoolId:c})),S(!1)):L(JSON.parse(U))),I(ce({asSchoolId:"Default"})),y(M+((t=localStorage.getItem("TermsSchoolName"))==null?void 0:t.split(" ").join("%20"))+"_logo.png")},[]),l.useEffect(()=>{var o;if(i!=null){window.sessionStorage.setItem("authenticateuser",JSON.stringify(i)),sessionStorage.setItem("SchoolId",i.SchoolId),localStorage.setItem("localSchoolId",i.SchoolId),localStorage.setItem("SchoolName",i.SchoolName),sessionStorage.setItem("SchoolName",i.SchoolName),localStorage.setItem("SiteURL",i.SiteURL),localStorage.setItem("TermsSchoolName",i.TermsSchoolName),localStorage.setItem("FolderName",i.FolderName),document.title=`Welcome to ${i.SchoolName}`;const t=M+((o=i.TermsSchoolName)==null?void 0:o.split(" ").join("%20"))+"_logo.png";y(t),sessionStorage.setItem("SchoolFavicon",t);const s=document.querySelector("link[rel~='icon']");if(s)s.href=t;else{const a=document.createElement("link");a.rel="shortcut icon",a.href=t,document.head.appendChild(a)}(g!=null&&h!=null||m!=null)&&B()}},[i]),l.useEffect(()=>{f.length>0&&A!=null?I(me({asUserName:decodeURIComponent(A)})):D(f.filter(o=>o.SchoolId==c)[0])},[f]),l.useEffect(()=>{m!=null&&(c=m.data.TeacherDetails.SchoolId,I(E({asSchoolId:m.data.TeacherDetails.SchoolId})),D(f.filter(o=>o.SchoolId==m.data.TeacherDetails.SchoolId)[0]))},[m]);const T=o=>{be.error(o,{toastId:"error1"}),setTimeout(()=>{},3e3)},L=async o=>{const t=await o.data.AuthenticateUserResult,s=await o.data.StudentDetails,a=await o.data.TeacherDetails,d=await o.data.AdminStaffDetails.GetAdminStaffResult,ae={asSchoolId:c,asUserId:t.Id};I(Se(ae)),t.RoleName==="Student"&&(sessionStorage.setItem("AuthenticateUserResult",JSON.stringify(t)),sessionStorage.setItem("DivisionId",s.DivisionId),sessionStorage.setItem("Class",s.Class),sessionStorage.setItem("StandardId",s.StandardId),sessionStorage.setItem("RollNo",s.RollNo),sessionStorage.setItem("AcademicYearId",s.AcademicYearId),sessionStorage.setItem("AcademicYear",s.AcademicYear),sessionStorage.setItem("StudentId",s.StudentId),sessionStorage.setItem("StandardDivisionId",s.StandardDivisionId),sessionStorage.setItem("Address",s.Address),sessionStorage.setItem("ResidencePhoneNumber",s.ResidencePhoneNumber),sessionStorage.setItem("CasteAndSubCaste",s.CasteAndSubCaste),sessionStorage.setItem("UDISENumber",s.UDISENumber),sessionStorage.setItem("BirthPlace",s.BirthPlace),sessionStorage.setItem("Nationality",s.Nationality),sessionStorage.setItem("MotherTongue",s.MotherTongue),sessionStorage.setItem("Blood_Group",s.Blood_Group),sessionStorage.setItem("EndDate",u(s.EndDate)),sessionStorage.setItem("StartDate",u(s.StartDate)),sessionStorage.setItem("Language",s.asLanguage),sessionStorage.setItem("ParentStaffID",s.aiParentStaffId),sessionStorage.setItem("StartRowIndex",s.aiStartRowIndex),sessionStorage.setItem("SortRowIndexExpression",s.asSortExpression),sessionStorage.setItem("BookTittleName",s.asBookTitle),sessionStorage.setItem("UserName",s.asUserName),sessionStorage.setItem("ExamID",s.asExamId),sessionStorage.setItem("DOB",s.DOB),sessionStorage.setItem("MobileNumber",s.MobileNumber),sessionStorage.setItem("MobileNumber2",s.MobileNumber2),sessionStorage.setItem("Religion",s.Religion),sessionStorage.setItem("CategoryName",s.CategoryName),sessionStorage.setItem("FamilyPhotoFilePath",s.FamilyPhotoFilePath),sessionStorage.setItem("SchoolwiseStudentId",s.SchoolwiseStudentId),sessionStorage.setItem("StudentSiblingList",s.StudentSiblingList===void 0?"":JSON.stringify(s.StudentSiblingList))),t.RoleName==="Teacher"&&(sessionStorage.setItem("AuthenticateUserResult",JSON.stringify(t)),sessionStorage.setItem("TeacherId",a.TeacherId),sessionStorage.setItem("Address",a.Address),sessionStorage.setItem("IsClassTeacher",a.IsClassTeacher),sessionStorage.setItem("DesignationName",a.DesignationName),sessionStorage.setItem("DivisionId",a.DivisionId),sessionStorage.setItem("StandardId",a.StandardId),sessionStorage.setItem("StandardDivisionId",a.StandardDivisionId),sessionStorage.setItem("ClassName",a.ClassName),sessionStorage.setItem("AcademicYearId",a.AcademicYearId),sessionStorage.setItem("EndDate",u(a.EndDate)),sessionStorage.setItem("StartDate",u(a.StartDate)),sessionStorage.setItem("SchoolName",a.asSchoolName),sessionStorage.setItem("DOB",a.DOB),sessionStorage.setItem("MobileNumber",a.MobileNumber),sessionStorage.setItem("SchoolConfiguration",JSON.stringify(a.SchoolConfiguration))),t.RoleName==="Admin Staff"&&(sessionStorage.setItem("AcademicYearId",d.AcademicYearId),sessionStorage.setItem("Address",d.Address),sessionStorage.setItem("DesignationName",d.DesignationName),sessionStorage.setItem("EndDate",u(d.EndDate)),sessionStorage.setItem("StartDate",u(d.StartDate)),sessionStorage.setItem("DOB",d.DOB),sessionStorage.setItem("SchoolName",d.SchoolName),sessionStorage.setItem("asSchoolName",d.asSchoolName),sessionStorage.setItem("MobileNumber",d.MobileNumber)),sessionStorage.setItem("Id",t.Id),sessionStorage.setItem("RoleId",t.RoleId),sessionStorage.setItem("StudentName",t.Name),sessionStorage.setItem("PhotoFilePath",t.PhotoFilePath),sessionStorage.setItem("Userlogin",t.UserLogin),sessionStorage.setItem("TermsAccepted",t.TermsAccepted),sessionStorage.setItem("LastPasswordChangeDate",t.LastPasswordChangeDate),localStorage.setItem("UserId",t.Id),localStorage.setItem("RoleName",t.RoleName),localStorage.getItem("url"),p("/RITeSchool/landing/landing",{state:{fromInternal:!0}})},r=Ae({initialValues:{userName:g??"",password:h??""},onSubmit:o=>{B()},validate:o=>{const t={};return o.userName||(t.userName="Username is Required "),o.password||(t.password="Password is Required "),t}}),Q=()=>{S(!0),D(null);let o=localStorage.getItem("LoginVersion");localStorage.clear(),localStorage.setItem("LoginVersion",o)},ee=()=>{p("/forgotPassword",{state:{fromInternal:!0}})},se=()=>{p("/schoolNotice",{state:{fromInternal:!0}})},te=()=>{X({...N,showPassword:!N.showPassword})},oe=o=>{o.preventDefault()},B=async()=>{const o={asUserName:r.values.userName,asPassword:r.values.password,asSchoolId:c,asIsSiblingLogin:!1},t=m??await ue.AuthenticateUser(o);if(console.log(t,"response"),t.data!=null)if(t.data.AuthenticateUserResult.Message===""||t.data.AuthenticateUserResult.Message===null){const s=await t.data.AuthenticateUserResult,a=s.TermsAccepted;sessionStorage.setItem("TermsAccepted",s.TermsAccepted),a!=="Y"?(sessionStorage.setItem("Id",s.Id),sessionStorage.setItem("RoleId",s.RoleId),sessionStorage.setItem("Userlogin",s.UserLogin),p("/TermAndCondition",{state:{fromInternal:!0}})):(localStorage.setItem("auth",JSON.stringify(t)),L(t))}else T(t.data.AuthenticateUserResult.Message);else T("Invalid Username or Password")};return e.jsxs(n,{children:[R&&e.jsxs(ge,{open:R,onClose:()=>{S(!1)},fullWidth:!0,maxWidth:"xs",sx:{"& .MuiDialog-paper":{height:"50%"}},children:[e.jsxs(he,{variant:"h4",sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:["Select or Switch School",e.jsx(O,{size:"small",onClick:()=>{S(!1)},children:e.jsx(Ie,{fontSize:"small"})})]}),e.jsx(fe,{dividers:!0,children:e.jsxs(n,{container:!0,spacing:2,children:[e.jsx(n,{item:!0,xs:12,children:e.jsx(xe,{value:i,onChange:(o,t)=>{D(t),i==null&&S(!1)},inputValue:Z,onInputChange:(o,t)=>{K(t)},id:"controllable-states-demo",options:f,getOptionLabel:o=>o.SchoolName,renderInput:o=>e.jsx(pe,{...o,className:J.root,label:"Select School",required:!0,variant:"standard"})})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(_,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center"},children:[e.jsx("a",{href:"https://www.regulusit.net",target:"_blank",rel:"noreferrer",children:e.jsx("img",{src:V})}),e.jsxs(v,{fontSize:12,sx:{pb:"8px"},children:["All rights reserved © 2007 - ",new Date().getFullYear(),", Regulus Information Technologies ."]})]})})]})}),e.jsx(Ne,{children:e.jsx(De,{variant:"contained",size:"small",color:"error",onClick:()=>{S(!1)},children:"Cancel"})})]}),x==null&&e.jsxs(n,{container:!0,spacing:0,direction:"column",alignItems:"center",style:{minHeight:"100vh"},columns:{xs:12,md:12},children:[e.jsx(n,{item:!0,xs:12,sx:{mt:"30px"},children:e.jsx("img",{src:$,width:"100%",style:{maxHeight:200}})}),e.jsx(n,{item:!0,xs:12,sx:{px:2},children:e.jsx(v,{variant:"h4",sx:{textAlign:"center"},children:G})}),e.jsx(_,{sx:{maxWidth:"90%"},children:e.jsx("form",{onSubmit:r.handleSubmit,noValidate:!0,autoComplete:"off",children:e.jsxs(n,{item:!0,xs:12,children:[e.jsxs(k,{fullWidth:!0,sx:{mr:1},variant:"standard",children:[e.jsx(Y,{htmlFor:"username",children:"User Name"}),e.jsx(W,{id:"username",color:"secondary",name:"userName",value:r.values.userName,onChange:r.handleChange,onBlur:r.handleBlur}),r.touched.userName&&r.errors.userName?e.jsx("div",{className:C.error,children:r.errors.userName}):null]}),e.jsxs(k,{fullWidth:!0,sx:{mr:1,mt:1},variant:"standard",children:[e.jsx(Y,{htmlFor:"standard-adornment-password",children:"Password"}),e.jsx(W,{color:"secondary",id:"standard-adornment-password",type:N.showPassword?"text":"password",name:"password",value:r.values.password,onChange:r.handleChange,onBlur:r.handleBlur,endAdornment:e.jsx(we,{position:"end",children:e.jsx(O,{"aria-label":"toggle password visibility",onClick:te,onMouseDown:oe,children:N.showPassword?e.jsx(z,{}):e.jsx(ve,{})})})})]}),r.touched.password&&r.errors.password?e.jsx("div",{className:C.error,children:r.errors.password}):null,e.jsxs(n,{sx:{pt:1,pb:3},children:[e.jsx(Ce,{color:"primary",type:"submit",onChange:r.handleChange,children:"Login"}),e.jsxs(ye,{onClick:ee,style:{cursor:"pointer"},children:[" ","Forgot Password"," "]})]})]})})}),e.jsx(n,{children:e.jsx(j,{onClick:Q,sx:{cursor:"pointer"},children:"Change School For Login"})}),e.jsx(n,{children:e.jsx(j,{onClick:se,sx:{cursor:"pointer"},children:"School Notices"})}),e.jsx("br",{}),e.jsx(n,{item:!0,xs:12,textAlign:"center",children:e.jsx(j,{children:e.jsx("a",{href:"https://www.riteschool.in/privacy-policy",children:"Privacy Policy"})})}),e.jsx("br",{}),e.jsx(je,{sx:{background:"#5b5258",mx:"30px"}}),e.jsxs(n,{container:!0,textAlign:"center",children:[e.jsx(n,{item:!0,xs:12,children:e.jsx("a",{href:"https://www.regulusit.net",target:"_blank",rel:"noreferrer",children:e.jsx("img",{src:V})})}),e.jsx(n,{item:!0,xs:12,children:e.jsxs(v,{fontSize:12,sx:{pb:"8px"},children:["All rights reserved © 2007 - ",new Date().getFullYear(),", Regulus Information Technologies."]})})]})]})]})}export{_e as default};

import{j as e,ai as We,B as n,aj as Ye,ak as ze,al as oe,am as j,an as _e,L as M,as as ae,H as g,hg as $e,I as L,ar as Ve,at as Xe,u as Je,A as qe,w as Ke,x as V,r as o,E as Ze,c as D,ct as Qe,hT as et,aL as re,hU as T,t as U,hV as tt,hW as st,hX as ot,F as at,m as le,J as ne,K as rt,ax as lt,a2 as nt,a3 as it,bl as ct,a5 as dt,p as ut,G as h,q as xt,aI as ie,aJ as ce,a7 as ht,a8 as X,du as gt,T as de,ay as pt,hY as mt,hZ as ft,h_ as jt}from"./index-d5YOjbb6.js";import{S as Dt}from"./SingleFile-BT4Sw5XK.js";import{B as bt}from"./ButtonStyle-DaPKUawX.js";import{d as yt}from"./ArrowCircleUp-BmCXupv-.js";import{d as St}from"./PublishedWithChanges-BE72Suzp.js";import{A as Ct}from"./ArrowCircleDown-BpJDJL07.js";import"./CloudUpload-DJN1zp2n.js";import"./Errormessage-RPRSgLGN.js";function wt({ItemList:a,clickView:d,HeaderArray:i,clickEdit:A,clickDelete:c,clickpublish:u,ClickHeader:p}){const G=s=>{s!=null&&(i=i.map(l=>l.SortOrder==null?l:{...l,SortOrder:l.SortOrder==" Asc"?" Desc":" Asc"}),p(i))};return e.jsx("div",{children:e.jsx(We,{component:n,sx:{border:s=>`1px solid ${s.palette.grey[300]}`},children:e.jsxs(Ye,{"aria-label":"simple table",children:[e.jsx(ze,{children:e.jsx(oe,{sx:{backgroundColor:s=>s.colors.secondary.main,color:s=>s.palette.common.white},children:i.map((s,l)=>e.jsx(j,{sx:{textTransform:"capitalize",color:b=>b.palette.common.white,py:1},onClick:()=>{G(s.Id)},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:1,justifyContent:s!=null&&s.align?"center":"flex-start"},children:[e.jsx("b",{children:s.Header}),s.SortOrder!=null?s.SortOrder==" Desc"?e.jsx(yt,{}):e.jsx(Ct,{}):null]})},l))})}),e.jsx(_e,{children:a.map(s=>e.jsxs(oe,{children:[e.jsx(j,{sx:{textTransform:"capitalize",paddingTop:"2.5px",paddingBottom:"2.5px"},children:s.Text1}),e.jsx(j,{sx:{textTransform:"capitalize",paddingTop:"2.5px",paddingBottom:"2.5px"},children:e.jsx("span",{style:{color:"blue",cursor:"pointer",textDecoration:"none"},onMouseEnter:l=>{l.target.style.textDecoration="underline"},onMouseLeave:l=>{l.target.style.textDecoration="none"},onClick:()=>d(s.Text2),children:"view log"})}),e.jsx(j,{sx:{textTransform:"capitalize",paddingTop:"2.5px",paddingBottom:"2.5px"},children:e.jsx(bt,{style:{backgroundColor:s.Text3==="False"?M[500]:ae[500]},onClick:()=>u(s.Id,s.Text3),sx:{minWidth:"10px",marginLeft:"40px"},children:s.Text3==="False"?e.jsx(g,{title:"Publish",children:e.jsx(St,{})}):e.jsx(g,{title:"Unpublish",children:e.jsx($e,{})})})}),e.jsx(j,{sx:{textTransform:"capitalize",paddingTop:"2.5px",paddingBottom:"2.5px"},align:"center",children:s.Text3==="False"?e.jsx(g,{title:"Edit",children:e.jsx(L,{onClick:()=>A(s.Id),sx:{cursor:"pointer","&:hover":{backgroundColor:"lightgrey"}},children:e.jsx(Ve,{})})}):null}),e.jsx(j,{sx:{textTransform:"capitalize",paddingTop:"2.5px",paddingBottom:"2.5px"},align:"center",children:s.Text3==="False"?e.jsx(g,{title:"Delete",children:e.jsxs(L,{onClick:()=>c(s.Id),sx:{color:"#223354","&:hover":{color:"red",backgroundColor:ae[100]}},children:["   ",e.jsx(Xe,{})," "]})}):null})]},s.Id))})]})})})}const Nt=()=>{const a=Je();qe();let{Id:d,ClassName:i,SelectTeacher:A}=Ke();d=V(d),i=V(i),A=V(A);const[c,u]=o.useState(""),[p,G]=o.useState(""),[s,l]=o.useState(""),[b,m]=o.useState(""),[J,O]=o.useState(!1),[y,v]=o.useState(""),[q,F]=o.useState(""),[K,Z]=o.useState(""),[W,Y]=o.useState(0),[x,ue]=o.useState(20),xe=[20,50,100,200],[S,Q]=o.useState(1),he=3e6,C=Number(localStorage.getItem("localSchoolId")),P=Number(sessionStorage.getItem("AcademicYearId")),ge=Number(localStorage.getItem("UserId")),B=Number(sessionStorage.getItem("TeacherId")),pe=localStorage.getItem("FolderName"),ee=localStorage.getItem("SiteURL");ee.split("/")[ee.split("/").length-1],o.useState(!0);const{showAlert:te,closeAlert:H}=o.useContext(Ze),w=D(t=>t.AddDailyLog.Savelog),k=D(t=>t.AddDailyLog.GetAllHomework);console.log(k,"GetAllHomeworkDailyLogs");const me=k.map(t=>t.TotalRows);console.log(me[0],"totalRowsArray[0]");const E=D(t=>t.AddDailyLog.GetHomeworkDailyLog),z=D(t=>t.AddDailyLog.DeleteHomework),_=D(t=>t.AddDailyLog.PublishUnpublish),fe=D(t=>t.AddDailyLog.ISGetfile),je=k.filter(t=>t.TotalRows!==void 0).map(t=>t.TotalRows),f=[...new Set(je)][0],De=(S-1)*x+1,be=Math.min(S*x,f),ye=Math.ceil(f/x),[$,Se]=o.useState([{Id:1,Header:"Date",SortOrder:" Desc"},{Id:2,Header:"Attachment"},{Id:3,Header:"Publish / Unpublish"},{Id:4,Header:"Edit",align:"center"},{Id:5,Header:"Delete",align:"center"}]),Ce=["BMP","DOC","DOCX","JPG","JPEG","PNG","BMP","PDF","XLS","XLSX"],we=o.useCallback(Qe(t=>{a(et(t))},500),[a]),ke=c?re(new Date(c)):"",Ie={aHomeWorkLogId:W,asStdDivId:Number(d),asDate:ke,asAttachmentName:y==""?null:y,asSchoolId:C,asAcademicYearId:Number(P),asInsertedById:B,asSaveFeature:"Homework\\DailyLog",asFolderName:pe,asBase64String:K==""?null:K},Te=p?re(new Date(p)):"",I={asSchoolId:C,asFilter:Te,asStdDivId:Number(d),asSortExpression:"Date "+$[0].SortOrder,asStartIndex:(S-1)*x,asEndIndex:S*x,asUserId:ge},Le=(t,r)=>{const R={asSchoolId:Number(C),asAcademicYearId:Number(P),asLogId:t,asUpdatedById:B,asIsPublished:r==="False"};te({title:"Please Confirm",message:r==="False"?"Are you sure you want to publish record?":"Are you sure you want to unpublish record?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{H()},onConfirm:()=>{a(mt(R)),H()}})};o.useEffect(()=>{a(T(I))},[$,S,x]),o.useEffect(()=>{_!=""&&(U.success(_),a(tt()),a(T(I)))},[_]),o.useEffect(()=>{if(E.length>0){let t=E[0].Date.split(" ")[0],r=t.split("-")[2]+"-"+t.split("-")[1]+"-"+t.split("-")[0];u(r),v(E[0].AttchmentName)}},[E]);const Ae=t=>{Y(t);const r={asSchoolId:Number(C),asAcademicYearId:Number(P),aId:t};O(!0),a(ft(r))},ve=t=>{const r={asSchoolId:Number(C),asAcademicYearId:Number(P),asId:t,asUpdatedById:B};te({title:"Please Confirm",message:"Are you sure you want to delete this record?  ",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{H()},onConfirm:()=>{a(jt(r)),H()}})};o.useEffect(()=>{z!==""&&(U.success(z,{toastId:"success1"}),a(st()),a(T(I)))},[z]);const Fe=t=>{fe!==""&&window.open(localStorage.getItem("SiteURL")+"/RITeSchool/DOWNLOADS/Homework/DailyLog/"+t)},Pe=t=>{u(t),t&&b!==""&&m("")},Be=t=>{G(t)},He=t=>{v(t.Name),Z(t.Value),F("")},se=()=>{u(""),v(""),Z(""),Y(0)},Ee=()=>{let t=!1;!c||c===""?(m("Date should not be blank."),t=!0):(m(""),new Date(c)>new Date?(m("Future date is not allowed."),t=!0):m("")),!y||y===""?(F("Select file to upload."),t=!0):F(""),t||(we(Ie),se())};o.useEffect(()=>{w!=""&&(w=="Record for given date is already exist."?U.error(w):U.success(w),a(ot()),a(T(I)),N())},[w]),o.useEffect(()=>{(()=>{const R=new Date().toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"});u(R)})()},[J]);const Ne=t=>{const r=new Date;return r.setHours(0,0,0,0),t.setHours(0,0,0,0),t>r},Re=()=>{const t=new Date(p);Ne(t)?l("Future dates are selected."):l(""),a(T(I))},Ue=t=>{Se(t)},Me=t=>{O(!0)},N=()=>{O(!1),v(""),u(""),m(""),F(""),Y(0)},Ge=t=>{ue(parseInt(t.target.value,10)),Q(1)},Oe=t=>{Q(t)};return e.jsx(e.Fragment,{children:e.jsxs(n,{sx:{px:2},children:[e.jsx(at,{navLinks:[{title:"Assign Homework",path:"/RITeSchool/Teacher/AssignHomework/"+le(B)+"/"+le(d)},{title:"Manage Daily Log",path:""}],rightActions:e.jsxs(e.Fragment,{children:[e.jsx(n,{children:e.jsx(g,{title:"Display / Add / Edit / Delete homework log of respective class.",children:e.jsx(L,{sx:{color:"white",backgroundColor:ne[500],height:"36px !important",":hover":{backgroundColor:ne[600]}},children:e.jsx(rt,{})})})}),e.jsx(n,{children:e.jsx(g,{title:"Add Daily Log",children:e.jsx(L,{sx:{color:"white",backgroundColor:M[500],height:"36px !important",":hover":{backgroundColor:M[600]}},onClick:Me,children:e.jsx(lt,{})})})})]})}),e.jsxs(nt,{open:J,maxWidth:"md",fullWidth:!0,onClose:N,PaperProps:{sx:{borderRadius:"15px"}},children:[e.jsx(it,{sx:{bgcolor:"#223354",color:t=>t.palette.common.white},children:e.jsx(ct,{onClick:N,sx:{color:"white",borderRadius:"7px",position:"absolute",top:"5px",right:"7px",cursor:"pointer","&:hover":{color:"red"}}})}),e.jsx(dt,{children:e.jsxs(n,{sx:{maxHeight:"300px",position:"relative",background:"white"},children:[e.jsx("h1",{children:W==0?"Add Daily Log":"Edit Daily Log"}),e.jsx(ut,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:"right",gap:1,sx:{mt:{xs:0,sm:0},flexWrap:{xs:"nowrap",sm:"nowrap"}},children:e.jsxs(h,{container:!0,spacing:2,mt:.5,children:[e.jsx(h,{item:!0,xs:12,sm:4,children:e.jsx(xt,{fullWidth:!0,label:"Class",sx:{bgcolor:"  #F0F0F0",width:"100%","& .MuiInputBase-input":{cursor:"default"}},value:i,inputProps:{readOnly:!0}})}),"                  ",e.jsxs(h,{item:!0,xs:12,sm:4,children:[e.jsx(ie,{DateValue:c,onDateChange:Pe,isMax:!0,label:"Date",size:"medium"}),b&&e.jsx(n,{sx:{mt:1,position:"absolute",bottom:"-25px"},children:e.jsx(ce,{Error:b})})]}),e.jsxs(h,{item:!0,xs:12,sm:4,children:[e.jsx(Dt,{ValidFileTypes:Ce,MaxfileSize:he,ChangeFile:He,errorMessage:"",FileName:y,height:"52.5px"}),q&&e.jsx(n,{sx:{mt:1,position:"absolute",bottom:"-25px"},children:e.jsx(ce,{Error:q})})]})]})})]})}),e.jsxs(ht,{sx:{py:2,px:3},children:[e.jsx(X,{color:"error",onClick:se,children:"Clear"}),e.jsx(X,{color:"error",onClick:N,children:"Cancel"}),e.jsx(X,{onClick:Ee,sx:{color:"green","&:hover":{color:"green",backgroundColor:M[100]}},children:W==0?"Save":"Update"})]})]}),e.jsx(n,{sx:{backgroundColor:"white",p:2},children:e.jsxs(h,{container:!0,spacing:1,justifyContent:"flex-end",alignItems:"center",children:[e.jsx(h,{item:!0,xs:12,children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",gap:1,width:"100%",justifyContent:"flex-end"},children:[e.jsx(n,{children:e.jsx(ie,{DateValue:p,onDateChange:Be,label:"",size:"small"})}),e.jsx(n,{children:e.jsx(g,{title:"Search",children:e.jsx(L,{onClick:Re,sx:{background:t=>t.palette.primary.main,color:"white","&:hover":{backgroundColor:t=>t.palette.primary.dark}},children:e.jsx(gt,{})})})})]})}),e.jsxs(h,{item:!0,xs:12,children:[f>0?e.jsx("div",{style:{flex:1,textAlign:"center"},children:e.jsxs(de,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(n,{component:"span",fontWeight:"fontWeightBold",children:[De," to ",be]})," ","out of"," ",e.jsx(n,{component:"span",fontWeight:"fontWeightBold",children:f})," ",f===1?"record":"records"]})}):e.jsx("span",{children:" "}),k.length>0?e.jsxs(e.Fragment,{children:[e.jsx(wt,{ItemList:k,clickView:Fe,HeaderArray:$,ClickHeader:Ue,clickEdit:Ae,clickDelete:ve,clickpublish:(t,r)=>Le(t,r)}),f>19?e.jsx(pt,{rowsPerPage:x,ChangeRowsPerPage:Ge,rowsPerPageOptions:xe,PageChange:Oe,pagecount:ye}):e.jsx("span",{children:" "})]}):e.jsx(de,{variant:"body1",sx:{textAlign:"center",marginTop:4,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:e.jsx("b",{children:"No record found."})})]})]})})]})})};export{Nt as default};

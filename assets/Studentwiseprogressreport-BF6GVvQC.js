import{V as He,W as _e,j as e,r,B as i,ai as Me,aj as Le,ak as Oe,al as ee,am as w,an as ze,T as z,H as b,bc as oe,at as Ve,as as V,u as Ue,A as Ye,w as Ge,x as R,au as $e,E as Fe,c as l,lG as We,lH as Ke,lI as C,lJ as se,t as M,lK as Xe,lL as qe,lM as Je,lN as Qe,n as Ze,F as es,p as ss,G as L,bR as te,I as re,J as ae,K as ts,ay as rs,lO as as,lP as os,m as O}from"./index-d5YOjbb6.js";import{d as ne,a as le}from"./EditOff-Bih_BxVi.js";import{d as ns}from"./ArrowCircleDown-D40CfZ6q.js";import{d as ls}from"./ArrowCircleUp-BmCXupv-.js";import{C as ds}from"./Card-BrM9kpJu.js";import{L as is}from"./Legend-p9-_07Am.js";var U={},cs=_e;Object.defineProperty(U,"__esModule",{value:!0});var de=U.default=void 0,us=cs(He()),xs=e,ps=(0,us.default)((0,xs.jsx)("path",{d:"M15 16h4v2h-4zm0-8h7v2h-7zm0 4h6v2h-6zM3 18c0 1.1.9 2 2 2h6c1.1 0 2-.9 2-2V8H3v10zM14 5h-3l-1-1H6L5 5H2v2h12z"}),"DeleteSweep");de=U.default=ps;const ie=r.createContext();function ms({ItemList:a,HeaderArray:A,ClickHeader:u,clickEdit:S,clickDelete:x}){const I=t=>{const c=A.map(d=>{if(d.Id===t){const f=d.SortOrder===""?"desc":"";return{...d,SortOrder:f}}else return{...d,SortOrder:null}});u(c)};let N=r.useContext(ie);return e.jsx(ds,{sx:{backgroundColor:"white"},children:e.jsx(i,{display:"flex",justifyContent:"center",alignItems:"center",sx:{width:"100%"},children:e.jsx(Me,{component:i,sx:{border:t=>`1px solid ${t.palette.grey[300]}`,background:"white"},children:e.jsxs(Le,{"aria-label":"simple table",children:[e.jsx(Oe,{children:e.jsx(ee,{sx:{background:t=>t.palette.secondary.main,color:t=>t.palette.common.white},children:A.map((t,c)=>e.jsx(w,{sx:{textTransform:"capitalize",color:d=>d.palette.common.white,py:1,textAlign:t.Header==="Delete"?"center":"left"},onClick:t.Id!==3&&t.Id!==4?()=>I(t.Id):null,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:t.Header==="Delete"?"center":"flex-start",gap:2},children:[e.jsx("b",{children:t.Header}),t.SortOrder!==null&&t.Id!==3&&t.Id!==4?t.SortOrder==="desc"?e.jsx(ns,{}):e.jsx(ls,{}):null]})},c))})}),e.jsx(ze,{children:a.map((t,c)=>e.jsxs(ee,{sx:{height:"36px"},children:[e.jsx(w,{sx:{textTransform:"capitalize",textAlign:"left",paddingTop:"2.5px",paddingBottom:"2.5px"},children:t.RollNo}),e.jsx(w,{sx:{textTransform:"capitalize",textAlign:"left",paddingTop:"2.5px",paddingBottom:"2.5px"},children:e.jsx(z,{noWrap:!0,children:t.StudentName})}),e.jsx(w,{sx:{textTransform:"capitalize",textAlign:"left",paddingTop:"2.5px",paddingBottom:"2.5px"},children:t.EditStatus==="1"?e.jsx(b,{title:"Marks entry not started",children:e.jsx(ne,{style:{cursor:"pointer"},onClick:()=>S(t.StandardId,t.Id),sx:{color:"#f44336","&:hover":{bgcolor:"grey.300"}}})}):t.EditStatus==="2"?e.jsx(b,{title:"Marks entry partially done",children:e.jsx(le,{style:{cursor:"pointer"},onClick:()=>S(t.StandardId,t.Id),sx:{color:"#ff9800","&:hover":{bgcolor:"grey.300"}}})}):t.EditStatus==="3"?e.jsx(b,{title:"Marks entry completed",children:e.jsx(oe,{style:{color:"#25e67b",cursor:"pointer"},onClick:()=>S(t.StandardId,t.Id),sx:{color:"#ff9800","&:hover":{bgcolor:"grey.300"}}})}):null}),e.jsx(w,{sx:{textTransform:"capitalize",textAlign:"center",paddingTop:"2.5px",paddingBottom:"2.5px"},children:t.EditStatus=="1"||N==!0?e.jsx("span",{}):e.jsx(b,{title:"Delete",children:e.jsx(Ve,{onClick:()=>x(t.Id),sx:{color:"#223354",display:"flex",justifyContent:"center",margin:"0 auto","&:hover":{color:"red",backgroundColor:V[100]}}})})})]},c))})]})})})})}const ws=()=>{const a=Ue(),A=Ye(),u=Number(localStorage.getItem("localSchoolId")),S=Number(sessionStorage.getItem("Id"));Number(localStorage.getItem("UserId"));const x=Number(sessionStorage.getItem("AcademicYearId"));Number(sessionStorage.getItem("TeacherId")),Number(sessionStorage.getItem("ExamID"));const I=JSON.parse(sessionStorage.getItem("ScreensAccessPermission")),N=sessionStorage.getItem("TeacherId"),t=()=>{let s="N";return I==null||I.map(n=>{n.ScreenName==="Student wise Progress Report "&&(s=n.IsFullAccess)}),s};let{ClassTecherid:c,ClassId:d,TestId:f,AssessmentId:j}=Ge();console.log(j,"AssessmentId"),c=R(c),d=R(d),f=R(f),j=R(j),$e(74);const[h,Y]=r.useState(N);r.useState(d??""),r.useState(f??""),r.useState(c??N);const[o,G]=r.useState("");console.log(o,"Assessment"),r.useState(),r.useState(),r.useState(),r.useState(),r.useState(),r.useState(),r.useState();const[g,ce]=r.useState(20),ue=[20,50,100,200],[v,$]=r.useState(1),{showAlert:F,closeAlert:T}=r.useContext(Fe),[hs,W]=r.useState(!1),m=()=>{let s=0;return p.map(n=>{n.Value==h&&(s=n.Id)}),s},[xe,gs]=r.useState([{Id:1,Header:"Roll No",SortOrder:"Roll_No"},{Id:2,Header:"Student Name",SortOrder:"Name"},{Id:3,Header:"Edit"},{Id:4,Header:"Delete"}]),[K,pe]=r.useState("Roll_No"),[me,he]=r.useState([{Id:1,Header:"Roll No.",SortOrder:null,sortKey:"Roll_No"},{Id:2,Header:"Student Name",SortOrder:null,sortKey:"Name"},{Id:3,Header:"Edit"},{Id:4,Header:"Delete"}]),ge=s=>{he(s);const n=s.find(Be=>Be.SortOrder!==null),Re=`${n.sortKey} ${n.SortOrder}`;pe(Re)},p=l(s=>s.Studentwiseprogress.PrimaryClassTeacher),P=l(s=>s.Studentwiseprogress.ISAssessmentDropdown),D=l(s=>s.Studentwiseprogress.StudentsAssignment);l(s=>s.Studentwiseprogress.StudentsAssignmentGrade);const B=l(s=>s.Studentwiseprogress.oneDeleteStudent),H=l(s=>s.Studentwiseprogress.DeleteAllStudent),k=l(s=>s.Studentwiseprogress.PublishStatus),_=l(s=>s.Studentwiseprogress.PublishUnpublishXseed),E=l(s=>s.Studentwiseprogress.ISAllStudentRecordCount),X=l(s=>s.Studentwiseprogress.ISClassTeacherXseedSubjects);X.map(s=>s.IsPublished),r.useState(k.AllowPublish===!0?"Publish":"Unpublish");const q=X.every(s=>s.IsPublished=="Y"),Se=D.every(s=>s.ShowDeleteButton!=="1");D.map(s=>s.ShowProgressReport),l(s=>s.Studentwiseprogress.ISGetAllRecordSubmitted);const fe=l(s=>s.Studentwiseprogress.Loading),be={asSchoolId:Number(u),asAcadmicYearId:Number(x),asTeacher_id:t()==="Y"?0:Number(h)},Ie={asAcademicYearId:Number(x),asSchoolId:Number(u)},J=(v-1)*g,je=J+g;m();const y={asSchoolId:Number(u),asAcademicYearId:Number(x),asStandardDivId:Number(m()),asAssessmentId:Number(o),asStartIndex:J,asEndIndex:je,asSortExp:K},Q={asAcademicYearId:Number(x),asSchoolId:Number(u),asStandardDivId:Number(m()),asAssessmentId:Number(o)};r.useEffect(()=>{k.AllowPublish===!0||k.AllowUnpublish===!0?W(!0):W(!1)},[k]),r.useEffect(()=>{a(We(Ie))},[]),r.useEffect(()=>{t()!=="Y"&&p.length>0&&Y(p[0].Value)},[p]),r.useEffect(()=>{a(Ke(be))},[]),r.useEffect(()=>{o!=null&&a(C(y))},[h,o,xe,v,g,m(),K]),r.useEffect(()=>{o!=null&&p.length>0&&a(se(Q))},[p,o]),r.useEffect(()=>{_!=""&&(M.success(_),a(Xe()),a(C(y)),a(se(Q)))},[_,m(),o,h]);const ye=s=>{Y(s)},we=s=>{G(s)};r.useEffect(()=>{P.length>0&&G(j!==void 0?j:P[0].Value)},[P]);const Ce=s=>{const n={asAcademicYearId:Number(x),asSchoolId:Number(u),asAssessmentId:Number(o),asStudentId:Number(s),asUpdatedById:Number(S)};F({title:"Delete",message:s.ShowDeleteButton!=="N"?"Are you sure you want to delete grades of selected assessment of selected student? ":"",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{T()},onConfirm:()=>{a(as(n)),a(C(y)),T()}})};r.useEffect(()=>{B!=""&&(M.success(B),a(qe()),a(C(y)))},[B]);const Ae=()=>{const s={asAcademicYearId:Number(x),asSchoolId:Number(u),asAssessmentId:Number(o),asStandardDivId:Number(m()),asUpdatedById:Number(S)};F({title:"Please Confirm",message:"Are you sure you want to delete grades of selected assessment of all students?  ",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{T()},onConfirm:()=>{a(os(s)),T()}})};r.useEffect(()=>{H!=""&&(M.success(H),a(Je()),a(C(y)))},[H]);const Ne={asAcadmeicYearId:Number(x),asSchoolId:Number(u),asAssessmentId:Number(o),asStdDivId:Number(m())};r.useEffect(()=>{a(Qe(Ne))},[o,m()]);const ve=(s,n)=>{A("/RITeSchool/Teacher/StudentwiseprogressreportEdit/"+O(o)+"/"+O(s)+"/"+O(n),{state:{fromInternal:!0}})},Te=(v-1)*g+1,Z=Math.min(v*g,E.Count),Pe=Math.ceil(E.Count/g),De=s=>{ce(parseInt(s.target.value,10)),$(1)},ke=s=>{$(s)},Ee=[{id:1,Name:"Marks entry not started",Value:e.jsx(i,{sx:{display:"flex",alignItems:"center",gap:"8px"},children:e.jsx(ne,{style:{color:"#f44336",fontSize:"large",position:"relative",top:"-2px"}})})},{id:2,Name:"Marks entry partially done",Value:e.jsx(i,{sx:{display:"flex",alignItems:"center",gap:"8px"},children:e.jsx(le,{style:{color:"#ff9800",fontSize:"large",position:"relative",top:"-2px"}})})},{id:3,Name:"Marks entry completed",Value:e.jsx(i,{sx:{display:"flex",alignItems:"center",gap:"8px"},children:e.jsx(oe,{style:{color:"#07bc0c",fontSize:"large",position:"relative",top:"-2px"}})})}];return e.jsxs(i,{sx:{px:2},children:[fe&&e.jsx(Ze,{}),e.jsx(es,{navLinks:[{title:"Student Wise Progress Report",path:"/RITeSchool/Teacher/StudentwiseProgressReport"}],rightActions:e.jsx(e.Fragment,{children:e.jsxs(ss,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:"left",gap:1,sx:{mt:{xs:0,sm:0},flexWrap:{xs:"nowrap",sm:"nowrap"}},children:[e.jsx(L,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(te,{sx:{width:{xs:"73vw",sm:"19vw",md:"13vw",lg:"23vw"},backgroundColor:t()==="N"||p.length==0?"#F0F0F0":""},ItemList:p,onChange:ye,defaultValue:h==null?void 0:h.toString(),size:"small",label:"Class Teacher",DisableClearable:t()==="N",mandatory:!0,disabled:t()==="N"||p.length==0})}),e.jsx(L,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(te,{sx:{width:{xs:"50vw",sm:"20vw",md:"15vw"}},ItemList:P,onChange:we,label:"Assessment",defaultValue:String(o),mandatory:!0,size:"small"})}),e.jsxs(L,{item:!0,xs:12,gap:1,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:[e.jsx(b,{placement:"bottom-end",title:"Select the class and edit any students grades for student wise marks assignment.",children:e.jsx(re,{sx:{color:"white",backgroundColor:ae[500],height:"36px !important",":hover":{backgroundColor:ae[600]}},children:e.jsx(ts,{})})}),e.jsx(b,{title:"Delete All",placement:"bottom-end",children:e.jsx("span",{children:e.jsx(re,{sx:{display:"inline-flex",color:"white",padding:"4px",width:"36px",height:"36px",backgroundColor:V[500],":hover":{backgroundColor:V[600]},marginLeft:"0px"},disabled:Se==!0||q==!0,onClick:Ae,children:e.jsx(de,{})})})})]})]})})}),e.jsx(i,{sx:{background:"white",p:1.5,mb:2},children:e.jsx(is,{LegendArray:Ee})}),o!==""?e.jsxs(i,{mb:1,sx:{p:2,background:"white"},children:[e.jsx(i,{children:D.length>0?e.jsx("p",{style:{flex:1,textAlign:"center"},children:e.jsxs(z,{variant:"subtitle1",sx:{textAlign:"center"},children:[e.jsxs(i,{component:"span",fontWeight:"fontWeightBold",children:[Te," to ",Z]})," ","out of"," ",e.jsx(i,{component:"span",fontWeight:"fontWeightBold",children:E.Count})," ",E.Count===1?"record":"records"]})}):e.jsx("span",{})}),e.jsx(ie.Provider,{value:q,children:e.jsx(ms,{ItemList:D,HeaderArray:me,ClickHeader:ge,clickEdit:ve,clickDelete:Ce})}),Z>19?e.jsx(rs,{rowsPerPage:g,ChangeRowsPerPage:De,rowsPerPageOptions:ue,PageChange:ke,pagecount:Pe}):e.jsx("span",{})]}):e.jsx(z,{variant:"body1",sx:{textAlign:"center",marginTop:4,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:e.jsx("b",{children:"Assessment should be selected."})})]})};export{ws as default};

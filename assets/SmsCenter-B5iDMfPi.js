import{cj as Rs,j as e,V as Je,W as Qe,ai as ye,B as a,aj as ke,ak as De,al as z,am as S,bQ as X,an as Me,H as g,I as f,ar as Et,G as I,r,S as Pt,u as _t,c as b,ed as Lt,ee as Ot,c8 as As,T as w,m as Ge,ef as Ns,ay as ve,s as Ts,A as Es,eg as Ps,E as _s,eh as Ls,t as Dt,ei as we,ej as Os,ek as Bs,el as Mt,bv as P,F as Us,p as Ie,q as ie,du as $e,J as O,K as be,as as B,at as Fe,L as U,n as Rt,C as zs,em as Hs,en as Vs,eo as $s}from"./index-d5YOjbb6.js";import{d as At}from"./AddCircle-8gfCxOOJ.js";import{d as Nt}from"./Download-CpScciMz.js";import{d as Fs}from"./PriorityHigh-Co3aw9FH.js";import{d as We}from"./Sms-DqIU1nDJ.js";import{d as Q}from"./ArrowCircleUp-BmCXupv-.js";import{A as Xe}from"./ArrowCircleDown-BpJDJL07.js";import{L as Re}from"./Link-CIF-2ERy.js";import{L as Ws}from"./CardStyle-B9qFmFtz.js";import{T as Ys}from"./CommonStyle-DTS3LGaG.js";import{L as Ks}from"./Legend-p9-_07Am.js";import{d as Ye}from"./ArrowCircleDown-D40CfZ6q.js";import{C as de}from"./Card-BrM9kpJu.js";import{y as Tt}from"./yellow-BQYah5ZS.js";const Ke=Rs(e.jsx("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),"AddTwoTone");var Ze={},Gs=Qe;Object.defineProperty(Ze,"__esModule",{value:!0});var Bt=Ze.default=void 0,qs=Gs(Je()),Js=e,Qs=(0,qs.default)((0,Js.jsx)("path",{d:"m22 5.72-4.6-3.86-1.29 1.53 4.6 3.86L22 5.72zM7.88 3.39 6.6 1.86 2 5.71l1.29 1.53 4.59-3.85zM12.5 8H11v6l4.75 2.85.75-1.23-4-2.37V8zM12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9c4.97 0 9-4.03 9-9s-4.03-9-9-9zm0 16c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z"}),"AccessAlarm");Bt=Ze.default=Qs;var et={},Xs=Qe;Object.defineProperty(et,"__esModule",{value:!0});var Ut=et.default=void 0,Zs=Xs(Je()),er=e,tr=(0,Zs.default)((0,er.jsx)("path",{d:"M20 6H10v6H8V4h6V0H6v6H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2z"}),"MarkunreadMailbox");Ut=et.default=tr;var tt={},sr=Qe;Object.defineProperty(tt,"__esModule",{value:!0});var qe=tt.default=void 0,rr=sr(Je()),nr=e,or=(0,rr.default)((0,nr.jsx)("path",{d:"M20 2H4c-1.1 0-1.99.9-1.99 2L2 22l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-7 12h-2v-2h2v2zm0-4h-2V6h2v4z"}),"SmsFailed");qe=tt.default=or;function ar({isPrincipal:d,ItemList:v,HeaderArray:C,ClickHeader:h,clickEdit:y,clickchange:m,clickTitle:j}){const E=s=>{const o=C.map(n=>n.Id===s?{...n,SortOrder:n.SortOrder==="DESC"?"ASC":"DESC"}:{...n,SortOrder:null});h(o)},D=()=>{let s=!0;return v.map(o=>{o.IsActive||(s=!1)}),s},x=()=>{const s=!D();let o=v.map(n=>({...n,IsActive:s}));m(o)},u=s=>{let o=v.map(n=>n.Id==s?{...n,IsActive:!n.IsActive}:n);m(o)};return e.jsx(e.Fragment,{children:e.jsx(ye,{component:a,children:e.jsxs(ke,{"aria-label":"simple table",sx:{border:s=>`1px solid ${s.palette.grey[300]}`},children:[e.jsx(De,{children:e.jsxs(z,{sx:{background:s=>s.palette.secondary.main,color:s=>s.palette.common.white},children:[e.jsx(S,{padding:"checkbox",children:e.jsx(X,{sx:{p:1.5},checked:D(),onChange:x})}),C.map((s,o)=>e.jsx(S,{sx:{textTransform:"capitalize",color:n=>n.palette.common.white,py:1.5},onClick:o<3?()=>E(s.Id):null,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2,justifyContent:o<3?"flex-start":"center"},children:[e.jsx("b",{children:s.Header}),s.SortOrder!==null&&o<3?s.SortOrder==="DESC"?e.jsx(Xe,{}):e.jsx(Q,{}):null]})},o))]})}),e.jsx(Me,{children:v.map((s,o)=>e.jsxs(z,{children:[e.jsx(S,{padding:"checkbox",children:e.jsx(X,{checked:s.IsActive,onChange:()=>u(s.Id)})}),d&&e.jsx(g,{title:s.SenderName,children:e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5,width:"200px",maxWidth:"200px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:s.SenderName})}),e.jsx(g,{title:s.UserName,children:e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:s.UserName})}),e.jsx(S,{sx:{textAlign:"left",py:.5},children:e.jsx(Re,{href:"",onClick:()=>j(s.Id),children:s.Subject})}),e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:s.Insert_Date}),e.jsx(S,{sx:{textAlign:"center",py:.5},align:"center",children:e.jsx(g,{title:"Edit",children:e.jsx(f,{onClick:()=>y(s.Id),sx:{color:"#223354","&:hover":{color:"#223354",cursor:"pointer"}},children:e.jsx(Et,{})})})})]},o))})]})})})}function lr({isPrincipal:d,ItemList:v,HeaderArray:C,ClickHeader:h,clickEdit:y,clickchange:m,clickTitle:j}){const E=s=>{const o=C.map(n=>n.Id===s?{...n,SortOrder:n.SortOrder==="DESC"?"ASC":"DESC"}:{...n,SortOrder:null});h(o)},D=()=>{let s=!0;return v.map(o=>{o.IsActive||(s=!1)}),s},x=()=>{const s=!D();let o=v.map(n=>({...n,IsActive:s}));m(o)},u=s=>{let o=v.map(n=>n.Id==s?{...n,IsActive:!n.IsActive}:n);m(o)};return e.jsx(e.Fragment,{children:e.jsx(ye,{component:a,children:e.jsxs(ke,{"aria-label":"simple table",sx:{border:s=>`1px solid ${s.palette.grey[300]}`,overflowY:"hidden"},children:[e.jsx(De,{children:e.jsxs(z,{sx:{background:s=>s.palette.secondary.main,color:s=>s.palette.common.white},children:[e.jsx(S,{padding:"checkbox",children:e.jsx(X,{sx:{p:1.5},checked:D(),onChange:x})}),C.map((s,o)=>e.jsx(S,{sx:{textTransform:"capitalize",color:n=>n.palette.common.white,py:1.5},onClick:o>=1&&o<3?()=>E(s.Id):null,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2,justifyContent:(o<3,"flex-start")},children:[e.jsx("b",{children:s.Header}),s.SortOrder!==null&&o>=1&&o<3?s.SortOrder==="DESC"?e.jsx(Xe,{}):e.jsx(Q,{}):null]})},o))]})}),e.jsx(Me,{children:v.map((s,o)=>e.jsxs(z,{children:[e.jsx(S,{padding:"checkbox",children:e.jsx(X,{checked:s.IsActive,onChange:()=>u(s.Id)})}),d&&e.jsx(g,{title:s.SenderName,children:e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5,width:"200px",maxWidth:"200px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:s.SenderName})}),e.jsx(g,{title:s.UserName,children:e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:s.UserName})}),e.jsx(S,{sx:{textAlign:"left",py:.5},children:e.jsx(Re,{href:"",onClick:()=>j(s.Id),children:s.Subject})}),e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:s.Insert_Date}),e.jsx(S,{sx:{textAlign:"center",py:.5},align:"center",children:e.jsx(g,{title:"Edit",children:e.jsx(f,{onClick:()=>y(s.Id),sx:{color:"#223354","&:hover":{color:"#223354",cursor:"pointer"}},children:e.jsx(Et,{})})})})]},o))})]})})})}const cr=({ItemList:d,DefaultValue:v,clickItem:C})=>(console.log(d,"ItemList"),e.jsx(I,{container:!0,item:!0,spacing:{xs:1,sm:0},direction:{xs:"row",sm:"column"},children:d.map(h=>e.jsx(I,{item:!0,xs:3,sx:{textAlign:"center",color:"#38548A"},children:e.jsxs(Ws,{sx:Ys,color:h.Value==v?"secondary":"primary",onClick:()=>{C(h.Value)},children:[d.Badge,h.Icon,e.jsx("br",{}),h.Name]})}))}));function ir(){const[d,v]=r.useState({startDate:null,endDate:null});Pt(),r.useState(!1);const C=_t();b(c=>c.SmsCenter.SmsList);const h=b(c=>c.SmsCenter.NewSmsList);b(c=>c.SmsCenter.Loading),b(c=>c.SmsCenter.MobileNumber);const[y,m]=r.useState(1),[j,E]=r.useState(20),D=[20,50,100,200],x=sessionStorage.getItem("AcademicYearId"),u=localStorage.getItem("localSchoolId"),s=sessionStorage.getItem("Id"),o=sessionStorage.getItem("RoleId"),[n,xe]=r.useState("desc"),[M,Z]=r.useState("Date"),H=h.filter(c=>c.TotalRows!==void 0).map(c=>c.TotalRows),$=[...new Set(H)][0];r.useEffect(()=>{const c={asSchoolId:u,asAcademicYearId:x,asUserId:s,asUserRoleId:o};localStorage.setItem("url",window.location.pathname),C(Lt(c))},[]);const Ae=h.filter(c=>{if(!d.startDate&&!d.endDate)return!0;const R=new Date(c.Date);return d.startDate&&!d.endDate?R>=d.startDate:(!d.startDate&&d.endDate||R>=d.startDate)&&R<=d.endDate}).sort((c,R)=>{let F=0;return M==="Date"?F=new Date(c.Date).getTime()-new Date(R.Date).getTime():M==="UserName"?F=c.UserName.localeCompare(R.UserName):M==="Subject"&&(F=c.Subject.localeCompare(R.Subject)),n==="asc"?F:-F}),he=c=>{M===c?xe(n==="asc"?"desc":"asc"):(Z(c),xe("asc"))},W={asSchoolId:u,asAcademicYearId:x,asUserId:s,asReceiverUserRoleId:o,asStartIndex:(y-1)*j,asPageSize:j},ee=(y-1)*j+1,Y=Math.min(y*j,$),k=Math.ceil($/j),Se=c=>{E(parseInt(c.target.value,10)),m(1)},te=c=>{m(c)};r.useEffect(()=>{C(Ot(W))},[y,j,M,n,d,ee,Y]);const Ne=Ae;let se="/RITeSchool/Student/viewsms/";return e.jsx(ye,{component:As,children:e.jsx(a,{children:e.jsx(I,{container:!0,children:e.jsxs(I,{item:!0,sx:{minWidth:"100%",background:"white"},children:[$>0?e.jsx("div",{style:{flex:1,textAlign:"center"},children:e.jsxs(w,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(a,{component:"span",fontWeight:"fontWeightBold",children:[ee," to ",Y]})," ","out of"," ",e.jsx(a,{component:"span",fontWeight:"fontWeightBold",children:$})," ",$===1?"record":"records"]})}):e.jsx("span",{children:" "}),e.jsx(a,{children:Ne.length>0?e.jsxs(ke,{"aria-label":"simple table",sx:{border:c=>`1px solid ${c.palette.grey[300]}`,overflow:"hidden"},children:[e.jsx(De,{children:e.jsxs(z,{sx:{background:c=>c.palette.secondary.main,color:c=>c.palette.common.white},children:[e.jsx(S,{sx:{color:"white",py:1.5},children:e.jsxs("b",{onClick:()=>he("UserName"),style:{cursor:"pointer",display:"flex",alignItems:"center"},children:["From ",M==="UserName"&&(n==="asc"?e.jsx(Q,{}):e.jsx(Ye,{}))]})}),e.jsx(S,{sx:{color:"white",py:1.5},children:e.jsxs("b",{onClick:()=>he("Subject"),style:{cursor:"pointer",display:"flex",alignItems:"center"},children:["SMS Text ",M==="Subject"&&(n==="asc"?e.jsx(Q,{}):e.jsx(Ye,{}))]})}),e.jsx(S,{sx:{color:"white",py:1.5},children:e.jsxs("b",{onClick:()=>he("Date"),style:{cursor:"pointer",display:"flex",alignItems:"center"},children:["Received Date ",M==="Date"&&(n==="asc"?e.jsx(Q,{}):e.jsx(Ye,{}))]})})]})}),e.jsx(Me,{children:Ne.map((c,R)=>e.jsxs(z,{children:[e.jsx(S,{sx:{py:1},children:c.UserName}),e.jsx(S,{sx:{py:1},children:e.jsx(Re,{href:se+Ge(c.SMS_Id),children:c.Subject})}),e.jsx(S,{sx:{py:1},children:Ns(new Date(c.Date))})]},R))})]}):e.jsx(w,{variant:"body1",sx:{textAlign:"center",marginTop:4,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:e.jsx("b",{children:"No record found."})})}),e.jsx(a,{mt:1,children:Y>19?e.jsx(ve,{rowsPerPage:j,ChangeRowsPerPage:Se,rowsPerPageOptions:D,PageChange:te,pagecount:k}):e.jsx("span",{})})]})})})})}function dr({ItemList:d,HeaderArray:v,ClickHeader:C,clickchange:h,clickTitle:y}){const m=x=>{const u=v.map(s=>s.Id===x?{...s,SortOrder:s.SortOrder==="DESC"?"ASC":"DESC"}:{...s,SortOrder:null});C(u)},j=()=>{let x=!0;return d.map(u=>{u.IsActive||(x=!1)}),x},E=()=>{const x=!j();let u=d.map(s=>({...s,IsActive:x}));h(u)},D=x=>{let u=d.map(s=>s.Id==x?{...s,IsActive:!s.IsActive}:s);h(u)};return e.jsx(e.Fragment,{children:e.jsx(ye,{component:a,children:e.jsxs(ke,{"aria-label":"simple table",sx:{border:x=>`1px solid ${x.palette.grey[300]}`,overflowY:"hidden"},children:[e.jsx(De,{children:e.jsxs(z,{sx:{background:x=>x.palette.secondary.main,color:x=>x.palette.common.white},children:[e.jsx(S,{padding:"checkbox",children:e.jsx(X,{sx:{p:1.5},checked:j(),onChange:E})}),v.map((x,u)=>e.jsx(S,{sx:{textTransform:"capitalize",color:s=>s.palette.common.white,py:1.5},onClick:u>=0&&u<3?()=>m(x.Id):null,children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:2,justifyContent:(u<3,"flex-start")},children:[e.jsx("b",{children:x.Header}),x.SortOrder!==null&&u>=0&&u<3?x.SortOrder==="DESC"?e.jsx(Xe,{}):e.jsx(Q,{}):null]})},u))]})}),e.jsx(Me,{children:d.map((x,u)=>e.jsxs(z,{children:[e.jsx(S,{padding:"checkbox",children:e.jsx(X,{checked:x.IsActive,onChange:()=>D(x.Id)})}),e.jsx(g,{title:x.UserName,children:e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:x.UserName})}),e.jsx(S,{sx:{textAlign:"left",py:.5},children:e.jsx(Re,{href:"",onClick:()=>y(x.Id),children:x.Subject})}),e.jsx(S,{sx:{textTransform:"capitalize",textAlign:"left",py:.5},children:x.Insert_Date})]},u))})]})})})}const xr=Ts(de)(({theme:d})=>({backgroundColor:d.palette.mode==="dark"?"#1A2027":"#fff",...d.typography.body2,padding:d.spacing(1),textAlign:"center",height:"61px",color:"black",boxShadow:"0px 8px 15px rgba(0, 0, 0, 0.1)"}));function kr(){const[d,v]=r.useState({startDate:null,endDate:null}),C=Pt();r.useState(!1);const h=_t(),y=Es();b(t=>t.SmsCenter.SmsList);const m=b(t=>t.SmsCenter.NewSmsList),j=b(t=>t.SmsCenter.SmsCountDetails);b(t=>t.SmsCenter.Loading);const E=b(t=>t.SmsCenter.MobileNumber),[D,x]=r.useState(1),[u,s]=r.useState(20),o=sessionStorage.getItem("AcademicYearId"),n=localStorage.getItem("localSchoolId"),xe=sessionStorage.getItem("DesignationName"),M=sessionStorage.getItem("Id"),Z=sessionStorage.getItem("RoleId"),[zt,H]=r.useState([]),[V,$]=r.useState("");r.useState("Insert_Date");const[Ae,he]=r.useState("desc");let W=[],ee=[],Y=[];r.useEffect(()=>{W=m==null?void 0:m.filter(t=>t.TotalRows!==void 0),ee=W==null?void 0:W.map(t=>t.TotalRows),Y=[...new Set(ee)],Y[0]},[m]);const[k,Se]=r.useState(""),[te,Ne]=r.useState("Date"),se=window.location.pathname,c=se.indexOf("/RITeSchool/Teacher/SmsCenter/")===-1?se.replace("/RITeSchool/Teacher/SmsCenter",""):se.replace("/RITeSchool/Teacher/SmsCenter/","");r.useEffect(()=>{const t={asSchoolId:n,asAcademicYearId:o,asUserId:M,asUserRoleId:Z},l={asUserId:M,asAcademicYearId:o,asSchoolId:n};localStorage.setItem("url",window.location.pathname),h(Lt(t)),h(Ps(l)),Se(c===""?"Received SMS":c)},[]),r.useEffect(()=>{let t=[];m.length>0&&(t=m.filter(l=>{if(!d.startDate&&!d.endDate)return!0;const i=new Date(l.Date);return d.startDate&&!d.endDate?i>=d.startDate:(!d.startDate&&d.endDate||i>=d.startDate)&&i<=d.endDate}).filter(l=>l.UserName.toLowerCase().includes(V.toLowerCase())||l.Subject.toLowerCase().includes(V.toLowerCase())).sort((l,i)=>{let p=0;return te==="Date"?p=new Date(l.Date).getTime()-new Date(i.Date).getTime():te==="UserName"?p=l.UserName.localeCompare(i.UserName):te==="Subject"&&(p=l.Subject.localeCompare(i.Subject)),Ae==="asc"?p:-p})),H(t)},[m]);const R={asSchoolId:n,asAcademicYearId:o,asUserId:M,asReceiverUserRoleId:Z,asStartIndex:(D-1)*u,asPageSize:D*u};r.useEffect(()=>{h(Ot(R))},[D,u]),r.useEffect(()=>{m&&H(m)},[m]);const F=t=>{t==="Compose SMS"&&y("/RiteSchool/Teacher/ComposeSMS",{state:{fromInternal:!0}}),Se(t)},Ht=()=>{localStorage.setItem("ViewSMSData","")},Vt=t=>{$(t)},st=()=>{if(V==="")H(m);else{const t=m.filter(l=>{const i=l.UserName.toLowerCase().includes(V.toLowerCase()),p=l.Subject.toLowerCase().includes(V.toLowerCase());return i||p});H(t)}};r.useEffect(()=>{H(m)},[m]);const Te=Number(localStorage.getItem("UserId")),[N,$t]=r.useState(""),[re,Ft]=r.useState(""),[A,K]=r.useState([]),[Ee,Wt]=r.useState("");r.useState("");const[_,Yt]=r.useState(20),rt=[20,50,100,200],[Pe,nt]=r.useState(1);r.useState(1);const ue=(Pe-1)*_,ot=ue+_,{showAlert:ne,closeAlert:T}=r.useContext(_s),[oe,Kt]=r.useState("ORDER BY Insert_Date DESC "),[_e,Gt]=r.useState("ORDER BY Insert_Date DESC "),ae=xe=="Principal"&&k=="AllSendItem",[qt,Jt]=r.useState([{Id:1,Header:"To",SortOrder:null,sortKey:"ORDER BY UserName"},{Id:2,Header:"SMS Text",SortOrder:null,sortKey:"ORDER BY SMS_Text"},{Id:3,Header:"Sent Date",SortOrder:"DESC",sortKey:"ORDER BY Insert_Date"},{Id:4,Header:"Resend",SortOrder:null,sortKey:"CreaterName"}]),[Qt,Xt]=r.useState([{Id:0,Header:"From",SortOrder:null,sortKey:"ORDER BY UserName"},{Id:1,Header:"To",SortOrder:null,sortKey:"ORDER BY UserName"},{Id:2,Header:"SMS Text",SortOrder:null,sortKey:"ORDER BY SMS_Text"},{Id:3,Header:"Sent Date",SortOrder:"DESC",sortKey:"ORDER BY Insert_Date"},{Id:4,Header:"Resend",SortOrder:null,sortKey:"CreaterName"}]),Zt=t=>{Jt(t);const l=t.find(p=>p.SortOrder!==null),i=l?`${l.sortKey} ${l.SortOrder}`:"Created_Date desc";Kt(i)},es=t=>{Xt(t);const l=t.find(p=>p.SortOrder!==null),i=l?`${l.sortKey} ${l.SortOrder}`:"Created_Date desc";Gt(i)},L=b(t=>t.SentSms.ISGetSentItems),le=b(t=>t.SentSms.Loading),G=L.length>0?L[0].TotalRows:null,Le=b(t=>t.SentSms.ISDeleteSMS),at=b(t=>t.SentSms.ISExportSentItems),me=b(t=>t.SentSms.ISResendSMS),lt=t=>{$t(t)},ct=t=>{Ft(t)},ts=()=>{K(re===""?L:L.filter(t=>{const l=t.SenderName.toLowerCase().includes(N.toLowerCase()),i=t.StatusId.toLowerCase().includes(N.toLowerCase()),p=t.Subject.toLowerCase().includes(N.toLowerCase()),Ce=t.Insert_Date.toLowerCase().includes(N.toLowerCase());return l||i||p||Ce})),h(we(ge))},q=()=>{ts(),K(N===""?L:L.filter(t=>{const l=t.SenderName.toLowerCase().includes(N.toLowerCase()),i=t.StatusId.toLowerCase().includes(N.toLowerCase());return l||i})),h(we(ge))},it=(Pe-1)*_+1,pe=Math.min(Pe*_,G),dt=Math.ceil(G/_),xt=t=>{Yt(parseInt(t.target.value,10)),nt(1)},ht=t=>{nt(t)},ge={asSchoolId:Number(n),asUser_Id:Te,asReceiver_User_Role_Id:2,asAcademic_Year_Id:Number(o),asSortExp:ae?_e:oe,asprm_StartIndex:ue,asPageSize:ot,asName:N,asContent:re,asViewAllSMS:k=="AllSendItem"?1:0},ss={asSchoolId:Number(n),asUser_Id:Te,asReceiver_User_Role_Id:2,asAcademic_Year_Id:Number(o),asSortExp:ae?_e:oe,asprm_StartIndex:ue,asPageSize:1e3,asName:N,asContent:re,asViewAllSMS:k=="AllSendItem"?1:0},St=()=>{if(!Ee||Ee.length===0){ne({title:"Error",message:"At least one SMS should be selected for deletion.",variant:"error",confirmButtonText:"OK",cancelButtonText:"Cancel",onConfirm:()=>{T()},onCancel:()=>{T()}});return}const t={asSMS_Id:Ee.toString(),asSchoolId:Number(n)};ne({title:"Please Confirm",message:"Are you sure you want to delete the selected SMS(s)?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{T()},onConfirm:()=>{h(Hs(t)),T()}})};r.useEffect(()=>{Le!=""&&(h(Ls()),Dt.success(Le),h(we(ge)))},[Le]);const[ut,rs]=r.useState(""),[mt,ns]=r.useState(""),[os,as]=r.useState(""),[ls,cs]=r.useState("");r.useEffect(()=>{if(me&&me.length>0){const t=me[0];rs(t.SMS_Text),ns(t.Display_Text),as(t.RoleId),cs(t.UserId)}},[me]);const pt=t=>{const l={asSmsId:Number(t),asSchoolId:Number(n),asAcademicYearId:Number(o)};h(Vs(l)),ut&&mt&&os&&ls&&y("/RITeSchool/Teacher/ComposeSMS",{state:{SMS_Text:ut,Display_Text:mt,RoleId:Z,UserId:M,fromInternal:!0}})},Oe=t=>{y("/RITeSchool/Teacher/ComposeSMS",{state:{fromInternal:!0}})},gt=t=>{K(t);const l=t.filter(i=>i.IsActive).map(i=>i.Id);Wt(l)},jt=t=>{y("/RITeSchool/Teacher/ViewSmsNew/"+Ge(t),{state:{fromInternal:!0}})},is=()=>{let t="";if(at.length>0){const l=["RowID","From","To","SMSText","SendDate"],i=at.map(p=>[p.RowID,p.From,p.To,p.SMSText,p.SendDate]);t=[l.join(","),...i.map(p=>p.map(Ce=>`"${String(Ce||"").replace(/"/g,'""')}"`).join(","))].join(`
`)}return t},ds=()=>{try{const t=is(),l=new Blob([t],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),p=URL.createObjectURL(l);i.setAttribute("href",p),i.setAttribute("download","SentSmsDetails.csv"),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}catch(t){console.error("Error exporting to CSV:",t)}},ft=()=>{ne({title:"Please Confirm",message:"This Action will show only saved details. Do you want to continue?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{T()},onConfirm:()=>{ds(),T()}})};r.useEffect(()=>{h(Os(ss))},[ue,ot,oe,_e,ae]),r.useEffect(()=>{h(we(ge))},[_,oe,k,oe]),r.useEffect(()=>{K(L)},[L]);const je=b(t=>t.SmsCenter.GetScheduleSMSBodyIS),Be=b(t=>t.SmsCenter.DeleteScheduleSMSIS);b(t=>t.SmsCenter.Loading);const fe=je.length>0?je[0].TotalRows:null,[Ct,xs]=r.useState("ORDER BY Insert_Date DESC "),[Ue,hs]=r.useState(""),[J,Ss]=r.useState(20),us=[20,50,100,200],[ze,wt]=r.useState(1),He=(ze-1)*J,It=He+J,ms=(ze-1)*J+1,bt=Math.min(ze*J,fe),ps=Math.ceil(fe/J),gs=t=>{Ss(parseInt(t.target.value,10)),wt(1)},js=t=>{wt(t)},[Ve,vt]=r.useState([]);r.useEffect(()=>{vt(je)},[je]);const[fs,Cs]=r.useState([{Id:1,Header:"To",SortOrder:null,sortKey:"ORDER BY UserName"},{Id:2,Header:"SMS Text",SortOrder:null,sortKey:"ORDER BY SMS_Text"},{Id:3,Header:"Scheduled Date",SortOrder:"DESC",sortKey:"ORDER BY Insert_Date"}]),ws=t=>{Cs(t);const l=t.find(p=>p.SortOrder!==null),i=l?`${l.sortKey} ${l.SortOrder}`:"Created_Date desc";xs(i)},yt={asSchoolId:Number(n),asUserId:Te,asReceiverUserRoleId:2,asAcademicYearId:Number(o),asSortExp:Ct,asStartIndex:He,asPageSize:It},Is={asSMSIds:Ue.toString(),asSchoolId:Number(n),asAcademicYearId:Number(o)},bs=t=>{vt(t);const l=t.filter(i=>i.IsActive).map(i=>i.Id);hs(l)},vs=()=>{if(!Ue||Ue.length===0){ne({title:"Error",message:"At least one SMS should be selected for deletion.",variant:"error",confirmButtonText:"OK",cancelButtonText:"Cancel",onConfirm:()=>{T()},onCancel:()=>{T()}});return}ne({title:"Please Confirm",message:"Are you sure you want to delete the selected SMS(s)?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{T()},onConfirm:()=>{h($s(Is)),T()}})};r.useEffect(()=>{Be!=""&&(h(Bs()),Dt.success(Be),h(Mt(yt)))},[Be]);const ys=t=>{y("/RITeSchool/Teacher/ViewSmsNew/"+Ge(t),{state:{fromInternal:!0}})};r.useEffect(()=>{h(Mt(yt))},[Ct,He,It]);const[ks,Ds]=r.useState(2),ce=t=>{const l=kt.find(i=>i.Value===t);F(l.Name),Ds(t)},Ms=[{id:1,Name:"Processed SMS",Value:e.jsx(a,{sx:{display:"flex",gap:1,alignItems:"center"},children:e.jsx(a,{sx:{width:23,height:23,backgroundColor:P[100],border:"1px solid black"}})})}],kt=[{Id:1,Name:"Compose SMS",Value:1,Icon:e.jsx(At,{onClick:ce,sx:{mt:.5,color:"#38548A"},className:C.IconSize}),Badge:""},{Id:2,Name:"Received SMS",Value:2,Icon:e.jsx(Ut,{onClick:ce,sx:{mt:.5,color:"#38548A"},className:C.IconSize}),Badge:""},{Id:3,Name:"Send Item",Value:3,Icon:e.jsx(We,{onClick:ce,sx:{mt:.5,color:"#38548A"},className:C.IconSize}),Badge:""},{Id:4,Name:"Scheduled SMS",Value:4,Icon:e.jsx(Bt,{onClick:ce,sx:{mt:.5,color:"#38548A"},className:C.IconSize}),Badge:""}];return e.jsxs(a,{sx:{px:2},children:[e.jsx(Us,{navLinks:[{title:"SMS Center",path:"/RITeSchool/Student/SmsCenter"}],rightActions:e.jsxs(e.Fragment,{children:[k=="Received SMS"&&e.jsx(e.Fragment,{children:e.jsxs(Ie,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:"right",gap:1,sx:{mt:{xs:0,sm:0},flexWrap:{xs:"nowrap",sm:"nowrap"}},children:[e.jsx(I,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(ie,{sx:{width:{xs:"40vw",sm:"20vw"}},fullWidth:!0,label:"To / From / SMS Text",value:V,variant:"outlined",size:"small",onChange:t=>{Vt(t.target.value)},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&st()}})}),e.jsx(I,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsxs(Ie,{direction:"row",gap:1,alignItems:"right",sx:{flexWrap:{xs:"wrap",sm:"nowrap"},justifyContent:{xs:"flex-start",sm:"flex-start"}},children:[e.jsx(f,{onClick:st,sx:{background:t=>t.palette.primary.main,color:"white","&:hover":{backgroundColor:t=>t.palette.primary.dark}},children:e.jsx($e,{})}),e.jsx(a,{children:e.jsx(g,{title:"School SMS will be sent to below listed number(s). To add/update the number, please send the information to admin staff via message center.",children:e.jsx(f,{sx:{color:"white",backgroundColor:Tt[700],height:"36px !important",":hover":{backgroundColor:Tt[800]}},children:e.jsx(Fs,{})})})}),e.jsx(a,{children:e.jsx(g,{title:"Displays recived sms/ send sms/ scheduled sms/all send sms list.",children:e.jsx(f,{sx:{color:"white",backgroundColor:O[500],height:"36px !important",":hover":{backgroundColor:O[600]}},children:e.jsx(be,{})})})})]})})]})}),k=="Send Item"&&e.jsx(e.Fragment,{children:e.jsxs(Ie,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:"right",gap:1,sx:{mt:{xs:0,sm:0},flexWrap:{xs:"nowrap",sm:"nowrap"}},children:[e.jsx(I,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(ie,{sx:{width:{xs:"40vw",sm:"20vw"}},fullWidth:!0,label:"Name / Reg. No. / User Name :",value:N,variant:"outlined",size:"small",inputProps:{maxLength:50},onChange:t=>{lt(t.target.value)},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&q()}})}),e.jsx(I,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsx(ie,{sx:{width:{xs:"40vw",sm:"20vw"}},fullWidth:!0,label:"Content :",value:re,variant:"outlined",size:"small",inputProps:{maxLength:100},onChange:t=>{ct(t.target.value)},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&q()}})}),e.jsx(I,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-start"},children:e.jsxs(Ie,{direction:"row",gap:1,alignItems:"right",sx:{flexWrap:{xs:"wrap",sm:"nowrap"},justifyContent:{xs:"flex-start",sm:"flex-start"}},children:[e.jsx(f,{onClick:q,sx:{background:t=>t.palette.primary.main,color:"white","&:hover":{backgroundColor:t=>t.palette.primary.dark}},children:e.jsx($e,{})}),A.length>0&&e.jsx(a,{children:e.jsx(g,{title:"Delete",children:e.jsx(f,{onClick:St,sx:{color:"white",backgroundColor:B[500],"&:hover":{backgroundColor:B[600]}},children:e.jsx(Fe,{})})})}),e.jsx(a,{children:e.jsx(g,{title:"Export",children:e.jsx(f,{sx:{color:"white",backgroundColor:P[500],"&:hover":{backgroundColor:P[600]}},onClick:ft,children:e.jsx(Nt,{})})})}),e.jsx(g,{title:"New Sms",children:e.jsx(f,{onClick:Oe,sx:{color:"white",backgroundColor:U[500],height:"36px !important",":hover":{backgroundColor:U[600]}},children:e.jsx(Ke,{})})}),e.jsx(a,{children:e.jsx(g,{title:" Displays recived sms/ send sms/ scheduled sms/all send sms list.",children:e.jsx(f,{sx:{color:"white",backgroundColor:O[500],"&:hover":{backgroundColor:O[600]}},children:e.jsx(be,{})})})})]})})]})}),k=="AllSendItem"&&e.jsxs(e.Fragment,{children:[e.jsx(ie,{sx:{width:{xs:"40vw",sm:"20vw"}},fullWidth:!0,label:"Name / Reg. No. / User Name :",value:N,variant:"outlined",size:"small",inputProps:{maxLength:50},onChange:t=>{lt(t.target.value)},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&q()}}),e.jsx(ie,{sx:{width:{xs:"40vw",sm:"20vw"}},fullWidth:!0,label:"Content :",value:re,variant:"outlined",size:"small",inputProps:{maxLength:100},onChange:t=>{ct(t.target.value)},onKeyDown:t=>{(t.key==="Enter"||t.key==="Tab")&&q()}}),e.jsx(f,{onClick:q,sx:{background:t=>t.palette.primary.main,color:"white","&:hover":{backgroundColor:t=>t.palette.primary.dark}},children:e.jsx($e,{})}),A.length>0&&e.jsx(a,{children:e.jsx(g,{title:"Delete",children:e.jsx(f,{onClick:St,sx:{color:"white",backgroundColor:B[500],"&:hover":{backgroundColor:B[600]}},children:e.jsx(Fe,{})})})}),e.jsx(a,{children:e.jsx(g,{title:"Export",children:e.jsx(f,{sx:{color:"white",backgroundColor:P[500],"&:hover":{backgroundColor:P[600]}},onClick:ft,children:e.jsx(Nt,{})})})}),e.jsx(g,{title:"New Sms",children:e.jsx(f,{onClick:Oe,sx:{color:"white",backgroundColor:U[500],height:"36px !important",":hover":{backgroundColor:U[600]}},children:e.jsx(Ke,{})})}),e.jsx(a,{children:e.jsx(g,{title:" Displays recived sms/ send sms/ scheduled sms/all send sms list.",children:e.jsx(f,{sx:{color:"white",backgroundColor:O[500],"&:hover":{backgroundColor:O[600]}},children:e.jsx(be,{})})})})]}),k=="Scheduled SMS"&&e.jsxs(e.Fragment,{children:[A.length>0&&e.jsx(a,{children:e.jsx(g,{title:"Delete",children:e.jsx(f,{onClick:vs,sx:{color:"white",backgroundColor:B[500],"&:hover":{backgroundColor:B[600]}},children:e.jsx(Fe,{})})})}),e.jsx(g,{title:"New Sms",children:e.jsx(f,{onClick:Oe,sx:{color:"white",backgroundColor:U[500],height:"36px !important",":hover":{backgroundColor:U[600]}},children:e.jsx(Ke,{})})}),e.jsx(a,{children:e.jsx(g,{title:" Displays recived sms/ send sms/ scheduled sms/all send sms list.",children:e.jsx(f,{sx:{color:"white",backgroundColor:O[500],"&:hover":{backgroundColor:O[600]}},children:e.jsx(be,{})})})})]})]})}),e.jsxs(a,{children:[e.jsxs(I,{container:!0,item:!0,spacing:1,children:[e.jsx(I,{item:!0,xs:12,sm:3,md:2,lg:1.5,children:e.jsx(cr,{ItemList:kt,DefaultValue:ks,clickItem:ce})}),e.jsxs(I,{item:!0,xs:12,sm:9,md:10,lg:10.5,children:[k=="AllSendItem"&&e.jsxs(a,{mb:1,sx:{background:"white",p:2},children:[le&&e.jsx(Rt,{}),A.length>0&&e.jsxs(a,{mb:0,sx:{background:"white"},children:[A.length>0?e.jsx(a,{style:{flex:1,textAlign:"center"},children:e.jsxs(w,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(a,{component:"span",fontWeight:"fontWeightBold",children:[it," to ",pe]})," ","out of"," ",e.jsx(a,{component:"span",fontWeight:"fontWeightBold",children:G})," ",G===1?"record":"records"]})}):e.jsx("span",{}),e.jsx(a,{children:e.jsx(lr,{HeaderArray:Qt,ItemList:A,ClickHeader:es,clickEdit:pt,clickchange:gt,clickTitle:jt,isPrincipal:ae})}),pe>19?e.jsx(ve,{rowsPerPage:_,ChangeRowsPerPage:xt,rowsPerPageOptions:rt,PageChange:ht,pagecount:dt}):e.jsx("span",{})]}),A.length==0&&!le?e.jsx(w,{variant:"body1",sx:{textAlign:"center",marginTop:4,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:e.jsx("b",{children:"No Records Found."})}):e.jsx("span",{})]}),k=="Received SMS"&&e.jsxs(a,{mb:1,sx:{background:"white",p:2},children:[e.jsxs(I,{container:!0,item:!0,spacing:2,children:[e.jsx(I,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(de,{sx:{backgroundColor:P[100],display:"flex",alignItems:"center",p:2,borderRadius:"10px"},children:[e.jsx(We,{sx:{color:P[600],fontSize:36,mr:2}}),e.jsxs(a,{children:[e.jsx(w,{variant:"h6",color:"blue",children:"Free SMS"}),e.jsx(w,{variant:"h4",children:j.AllowedSMSCount??0})]})]})}),e.jsx(I,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(de,{sx:{backgroundColor:U[100],display:"flex",alignItems:"center",p:2,borderRadius:"10px"},children:[e.jsx(We,{sx:{color:U[600],fontSize:36,mr:2}}),e.jsxs(a,{children:[e.jsx(w,{variant:"h6",color:"green",children:"Sent SMS"}),e.jsx(w,{variant:"h4",children:j.SentSMSCount??0})]})]})}),e.jsx(I,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(de,{sx:{backgroundColor:P[100],display:"flex",alignItems:"center",p:2,borderRadius:"10px"},children:[e.jsx(qe,{sx:{color:P[600],fontSize:36,mr:2}}),e.jsxs(a,{children:[e.jsx(w,{variant:"h6",color:"blue",children:"Balance SMS"}),e.jsx(w,{variant:"h4",children:"0"})]})]})}),e.jsx(I,{item:!0,xs:12,sm:6,md:3,children:e.jsxs(de,{sx:{backgroundColor:B[100],display:"flex",alignItems:"center",p:2,borderRadius:"10px"},children:[e.jsx(qe,{sx:{color:B[600],fontSize:36,mr:1}}),e.jsxs(a,{children:[e.jsx(w,{variant:"h6",color:"red",children:"Exceeded SMS"}),e.jsx(w,{variant:"h4",children:j.ExceededSMSCount??0})]})]})})]}),e.jsx(a,{mb:1,sx:{p:1,textAlign:"center"},children:e.jsx(w,{variant:"h6",children:e.jsxs("strong",{children:[" Mobile Number : ",E]})})}),e.jsx(ir,{})]}),k=="Send Item"&&e.jsxs(a,{mb:1,sx:{background:"white",p:2},children:[le&&e.jsx(Rt,{}),A.length>0&&e.jsxs(a,{mb:1,sx:{background:"white"},children:[A.length>0?e.jsx("div",{style:{flex:1,textAlign:"center"},children:e.jsxs(w,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(a,{component:"span",fontWeight:"fontWeightBold",children:[it," to ",pe]})," ","out of"," ",e.jsx(a,{component:"span",fontWeight:"fontWeightBold",children:G})," ",G===1?"record":"records"]})}):e.jsx("span",{}),e.jsx(ar,{HeaderArray:qt,ItemList:A,ClickHeader:Zt,clickEdit:pt,clickchange:gt,clickTitle:jt,isPrincipal:ae}),pe>19?e.jsx(ve,{rowsPerPage:_,ChangeRowsPerPage:xt,rowsPerPageOptions:rt,PageChange:ht,pagecount:dt}):e.jsx("span",{})]}),A.length==0&&!le?e.jsx(w,{variant:"body1",sx:{textAlign:"center",marginTop:4,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:e.jsx("b",{children:"No Records Found."})}):e.jsx("span",{})]}),k==="Scheduled SMS"&&e.jsxs(a,{mb:1,sx:{background:"white",p:2},children:[e.jsx(a,{sx:{background:"white",p:1,mb:1},children:e.jsx(Ks,{LegendArray:Ms})}),Ve.length>0&&e.jsxs(a,{mb:1,sx:{background:"white"},children:[Ve.length>0?e.jsx("div",{style:{flex:1,textAlign:"center"},children:e.jsxs(w,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(a,{component:"span",fontWeight:"fontWeightBold",children:[ms," to ",bt]})," ","out of"," ",e.jsx(a,{component:"span",fontWeight:"fontWeightBold",children:fe})," ",fe===1?"record":"records"]})}):e.jsx("span",{}),e.jsx(dr,{HeaderArray:fs,ItemList:Ve,ClickHeader:ws,clickchange:bs,clickTitle:ys}),bt>19?e.jsx(ve,{rowsPerPage:J,ChangeRowsPerPage:gs,rowsPerPageOptions:us,PageChange:js,pagecount:ps}):e.jsx("span",{})]}),A.length==0&&!le?e.jsx(w,{variant:"body1",sx:{textAlign:"center",marginTop:4,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:e.jsx("b",{children:"No Records Found."})}):e.jsx("span",{})]})]})]}),e.jsx("span",{style:{width:"95px",position:"fixed",bottom:"70px",right:"60px"},children:e.jsx(zs,{style:{textDecoration:"none"},to:`/${location.pathname.split("/")[1]}/Teacher/ComposeSMS`,children:e.jsxs(xr,{onClick:Ht,sx:{fontSize:"10px",mr:1,mb:"60px",borderRadius:"15px",backgroundColor:"#38548A",color:"white"},children:[e.jsx(At,{}),e.jsx("br",{}),e.jsx("b",{children:"Compose"})]})})})]})]})}export{kr as default};

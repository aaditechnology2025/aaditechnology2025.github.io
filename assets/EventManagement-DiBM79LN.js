import{w as V,x as I,u as ue,A as J,r as s,E as me,c as A,cX as Ne,cY as oe,aB as M,t as z,cZ as Fe,m as h,c_ as Pe,c$ as ve,ct as Le,d0 as Be,d1 as Me,j as e,G as u,q as Re,aJ as R,aI as ie,bB as Ue,T as _e,p as Ge,a8 as le,as as Ye,L as T,d2 as He,K as Oe,J as ce,ax as ze,F as Ve,d3 as de,d4 as Je,d5 as $e,B as O}from"./index-d5YOjbb6.js";import{S as We}from"./SingleFile-BT4Sw5XK.js";import{S as Xe}from"./SelectListHierarchy-2EYf6pPL.js";import{d as qe}from"./Save-Ckr0NoeK.js";import{H as Ke,U as Ze}from"./UploadAnnualPlanner-0iqnuKzy.js";import{T as Qe}from"./TabularList-BSP9Bq14.js";import"./CloudUpload-DJN1zp2n.js";import"./Errormessage-RPRSgLGN.js";const et=({EventId:a,AddNewEventClicked:m,SaveClicked:v})=>{let{SelectedDate:o,StandardId:n,DivisionId:i}=V();o=I(o),n=I(n),i=I(i);const r=ue(),x=J(),f=Number(localStorage.getItem("localSchoolId")),d=Number(sessionStorage.getItem("AcademicYearId")),E=localStorage.getItem("FolderName"),c=Number(sessionStorage.getItem("Id")),p=localStorage.getItem("TeacherId"),{showAlert:y,closeAlert:g}=s.useContext(me),U=["JPG","PNG","BMP","JPEG","PDF"],Ee=1e6,[_,w]=s.useState(""),[$,N]=s.useState(""),[D,F]=s.useState(null),[C,P]=s.useState(null),[b,L]=s.useState([]),[ge,G]=s.useState(!1),[W,X]=s.useState(""),[Se,q]=s.useState(""),[K,Z]=s.useState("");s.useState("");const[fe,Q]=s.useState(""),[ee,k]=s.useState(""),[te,j]=s.useState(""),[he,nt]=s.useState(""),se={asSchoolId:f,asAcademicYearId:d,asEventId:a},Ie=A(t=>t.EventsManagement.AllClassesAndDivisionss1),ne=A(t=>t.EventsManagement.AllClassesAndDivisionss),Y=A(t=>t.EventsManagement.SaveUpdateEventt),S=A(t=>t.EventsManagement.EventDetailss),H=A(t=>t.EventsManagement.DeleteEventImagee),xe=t=>{L(t)},De=t=>{X(t.Name),q(t.Value)};s.useEffect(()=>{B(),r(Ne({asSchoolId:f,asAcademicYearId:d}))},[]),s.useEffect(()=>{m>0&&B()},[m]),s.useEffect(()=>{v>0&&re()},[v]),s.useEffect(()=>{a!=0&&r(oe(se))},[a]),s.useEffect(()=>{S!==null?(w(S.Event_Name),N(S.Event_Description),F(M(S.Event_Start_Date)),P(M(S.Event_End_Date)),G(S.Display_On_Homepage=="True")):(a=0,w(""),N(""),F(M(o)),P(M(o)),G(!1),L(b.map(t=>({...t,IsActive:!1}))))},[S]),s.useEffect(()=>{L(ne)},[ne]),s.useEffect(()=>{Y!==""&&(z.success(Y,{toastId:"success1"}),r(Fe()),B(),x("/RITeSchool/Common/AnnualPlanner/"+h(o)+"/"+h(n)+"/"+h(i),{state:{fromInternal:!0}}))},[Y]);const ae=t=>{if(!t)return!1;new Date(sessionStorage.getItem("StartDate")),new Date(sessionStorage.getItem("EndDate"));const l=new Date(t),Te=new Date("2024-04-01"),ye=new Date("2025-03-31");return l<Te||l>ye};s.useEffect(()=>{D&&C&&(Pe(D,C)?k("Start date should not be greater than end date."):ae(D)?k("Event start date must be within current academic year (i.e between "+sessionStorage.getItem("StartDate")+" and "+sessionStorage.getItem("EndDate")+")."):k(""),ae(C)?j("Event end date must be within current academic year (i.e between "+sessionStorage.getItem("StartDate")+" and "+sessionStorage.getItem("EndDate")+")."):j(""))},[D,C]);const B=()=>{r(ve()),a=0,w(""),N(""),F(null),P(null),G(!1),q(""),X(""),L(b.map(t=>({...t,IsActive:!1}))),k(""),j("")},Ce=()=>{let t="<StandardDivisions>";return Array.isArray(b)&&b.map(l=>{l.IsActive&&(t=t+' <Division StandardDivisionId="'+l.Id+'" />')}),t+="</StandardDivisions>",t},Ae=()=>{let t=!1;return b.map(l=>{l.IsActive&&(t=!0)}),t},pe=()=>{let t=!1;if(_==""?(Z("Title should not be blank."),t=!0):Z(""),D===""||D===null?(k("Start date should not be blank."),t=!0):ee!=""?t=!0:j(""),C===""||C===null?(j("End date should not be blank."),t=!0):te!=""?t=!0:j(""),Ae()?Q(""):(Q("At least one class should be associated."),t=!0),!t){const l={asEventId:a,asEventName:_,asEventDescription:$,asEventStartDate:D,asEventEndDate:C,asDisplayOnHomepage:ge,asEventImageName:W,asSchoolId:f,asAcademicYearId:d,asInsertedById:c.toString(),asUpdatedById:p,asStandardDivisions:Ce(),asSaveFeature:"Event Planner",asFolderName:E,asBase64String:Se};be(l)}},re=()=>{y({title:"Please Confirm",message:"Are you sure you want to save event?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{g()},onConfirm:()=>{pe(),g()}})},be=s.useCallback(Le(t=>{r(Be(t))},500),[r]),je={asSchoolId:f,asAcademicYearId:d,asEventId:Number(a),asUserId:Number(c)},we=()=>{y({title:"Please Confirm",message:"Are you sure you want to delete event image?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:g,onConfirm:()=>{r(He(je)),g()}})};s.useEffect(()=>{H!=""&&(z.success(H),r(Me()),r(oe(se)))},[H]);const ke=()=>{window.open(localStorage.getItem("SiteURL")+"/RITeSchool/DOWNLOADS/Event Planner/"+S.Event_Image)};return e.jsx(e.Fragment,{children:e.jsxs(u,{container:!0,spacing:2,children:[e.jsxs(u,{xs:12,md:6,item:!0,children:[e.jsx(Re,{label:e.jsxs("span",{children:["Title ",e.jsx("span",{style:{color:"red"},children:"*"})]}),multiline:!0,rows:1,value:_,onChange:t=>{const l=t.target.value;l===""?w(""):l.trim()!==""&&w(l)},fullWidth:!0,inputProps:{maxLength:100},sx:{resize:"both"}}),K&&e.jsx(R,{Error:K})]}),e.jsxs(u,{item:!0,xs:12,md:3,children:[e.jsx(ie,{DateValue:D,onDateChange:F,label:"Start Date",size:"medium"}),e.jsx(R,{Error:ee})]}),e.jsxs(u,{item:!0,xs:12,md:3,children:[e.jsx(ie,{DateValue:C,onDateChange:P,label:"End Date",size:"medium"}),e.jsx(R,{Error:te})]}),e.jsx(u,{xs:12,md:12,item:!0,children:e.jsx(Ue,{label:"Description",value:$,onChange:N,mandatory:!1})}),e.jsxs(u,{item:!0,xs:12,md:12,children:[e.jsx(Xe,{ItemList:b,ParentList:Ie,ClickChild:xe}),e.jsx(R,{Error:fe})]}),e.jsxs(u,{container:!0,xs:6,md:6,item:!0,children:[e.jsx(_e,{fontSize:"10px",pt:1,pr:3,ml:2,children:"Select Photo :"}),e.jsx(u,{item:!0,sx:{pl:{xs:2,md:0}},children:e.jsx(We,{ValidFileTypes:U,MaxfileSize:Ee,ChangeFile:De,errorMessage:he,FilePath:S==null?"":S.Event_Image,FileName:W,viewIcon:!0,deleteIcon:!0,clickFileName:ke,clickDelete:we,isMandatory:!1})})]}),e.jsx(u,{item:!0,xs:12,md:12,children:e.jsxs(Ge,{direction:"row",gap:2,alignItems:"center",children:[e.jsx(le,{onClick:B,sx:{color:"red",":hover":{backgroundColor:Ye[100]}},children:"Clear"}),e.jsx(le,{onClick:re,sx:{color:"green",":hover":{backgroundColor:T[100]}},children:"Save"})]})})]})})},tt=({ClickAddNewEvent:a,ClickSave:m})=>{const v=J();let{SelectedDate:o,StandardId:n,DivisionId:i}=V();o=I(o),n=I(n),i=I(i);const[r,x]=s.useState(!1),d=[{Id:2,Icon:e.jsx(Oe,{}),Title:"        Event management for your school. Add events to be held in your school for the current academic year.",Action:"Help",sx:{color:"white",backgroundColor:ce[500],"&:hover":{backgroundColor:ce[600]}}},{Id:4,Icon:e.jsx(ze,{}),Title:"Add New Event",Action:"AddNewEvent",sx:{color:"white",backgroundColor:T[500],"&:hover":{backgroundColor:T[600]}}},{Id:3,Icon:e.jsx(qe,{}),Title:"Save",Action:"Save",sx:{color:"white",backgroundColor:T[500],"&:hover":{backgroundColor:T[600]}}}],E=c=>{c=="EventsOverview"&&v("/RITeSchool/Common/EventOverview",{state:{fromInternal:!0}}),c=="Save"&&m(),c=="AddNewEvent"&&a()};return""+h(o)+h(n)+h(i),e.jsxs(e.Fragment,{children:[e.jsx(Ve,{navLinks:[{title:"Annual Planner",path:"/RITeSchool/Common/AnnualPlanner/"+h(o)+"/"+h(n)+"/"+h(i)},{title:"Event(s) Management",path:""}],rightActions:e.jsx(e.Fragment,{children:e.jsx(Ke,{IconList:d,ClickIcon:E})})}),r&&e.jsx(Ze,{openAnnualPlannerDialog:r,setOpenAnnualPlannerDialog:x})]})},st=({clickEventEdit:a,SelectedDate:m,StandardId:v,DivisionId:o})=>{J();const n=ue(),i=Number(localStorage.getItem("localSchoolId")),r=Number(sessionStorage.getItem("AcademicYearId")),x=Number(sessionStorage.getItem("Id")),{showAlert:f,closeAlert:d}=s.useContext(me),E=A(g=>g.EventsManagement.EventListt),c=A(g=>g.EventsManagement.DeleteEventt),p={asEventDate:m,asSchoolId:i,asAcademicYearId:r,asStandardId:v,asDivisionId:o};s.useEffect(()=>{n(de(p))},[]),s.useEffect(()=>{E.length>0&&a(E[0].Id)},[E]),s.useEffect(()=>{c!==""&&(z.success(c,{toastId:"success1"}),n(Je()),n(de(p)),n(ve()))},[c]);const y=g=>{const U={asSchoolId:i,asEventId:Number(g),asUserId:Number(x)};f({title:"Please Confirm",message:"Are you sure you want to delete the event?  ",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{d()},onConfirm:()=>{n($e(U)),d()}})};return e.jsx(u,{container:!0,spacing:2,pb:1,children:e.jsx(u,{item:!0,xs:12,children:e.jsx(Qe,{ItemList:E,clickEdit:a,clickDelete:y})})})},mt=()=>{let{SelectedDate:a,StandardId:m,DivisionId:v}=V();a=I(a),m=I(m),v=I(v);const[o,n]=s.useState(0),[i,r]=s.useState(0),[x,f]=s.useState(0),d=p=>{n(p)},E=()=>{f(x+1)},c=()=>{r(i+1),n(0)};return e.jsx(e.Fragment,{children:e.jsxs(O,{sx:{px:2},children:[e.jsx(tt,{ClickAddNewEvent:c,ClickSave:E}),e.jsx(O,{sx:{backgroundColor:"white"},p:2,children:e.jsxs(O,{mt:1.5,sx:{backgroundColor:"white"},children:[e.jsx(st,{clickEventEdit:d,SelectedDate:a,StandardId:m,DivisionId:v}),e.jsx(et,{EventId:o,AddNewEventClicked:i,SaveClicked:x})]})})]})})};export{mt as default};

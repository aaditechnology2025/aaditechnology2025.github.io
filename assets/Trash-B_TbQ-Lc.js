import{r as o,c as m,u as O,db as $,j as s,B as R,n as H,bb as q,t as J,dc as K,dd as Q}from"./index-d5YOjbb6.js";import{d as V}from"./Delete-CrUR97S5.js";import{d as W}from"./KeyboardArrowUpRounded-Ddmjzrt1.js";import{d as X}from"./Replay-BNkOI0gZ.js";import{M as Z}from"./MoveToTrash-CffFWm0b.js";import{E as ee}from"./ErrorMessages-D1wiRwH0.js";import{L as se}from"./List3-DyfSymjJ.js";import{B as E}from"./ButtonStyle-DaPKUawX.js";import"./CheckboxImg-DSBDgE-_.js";import"./RadioButtonUnchecked-DyWPxD5p.js";const te=2;function Ie(){const[u,y]=o.useState(te),[r,k]=o.useState(),[t,ae]=o.useState([]),[L,p]=o.useState("none"),[v,w]=o.useState(!1),i=m(e=>e.MessageCenter.TrashList),F=m(e=>e.MessageCenter.Loading),A=m(e=>e.MessageCenter.FilterData),T=O();i!=null&&(t.length==0&&v==!1&&i.forEach(e=>{e!=null&&t.push(e)}),A==!0?t.length!=0&&i.length!=0?(t.length=0,i.forEach(e=>{e!=null&&t.push(e)})):t.length=0:r!=null&&t.length!=0&&v==!0&&r.GetTrashMessagesResult!=null&&r.GetTrashMessagesResult.length!=0&&r.GetTrashMessagesResult[0].DetailsId!=t[0].DetailsId&&r.GetTrashMessagesResult.forEach(e=>{e!=null&&t.push(e)}));const f=localStorage.getItem("localSchoolId"),D=sessionStorage.getItem("Id"),S=sessionStorage.getItem("RoleId"),M=sessionStorage.getItem("AcademicYearId"),j={asUserId:D,asAcademicYearId:M,asUserRoleId:S,asSchoolId:f,abIsSMSCenter:"0",asFilter:"",asPageIndex:1,asMonthId:"0",asOperator:"",asDate:""};o.useEffect(()=>{T($(j))},[]);const[P,g]=o.useState(!0),[l,c]=o.useState({DetailInfo:[],recieverInfo:[]}),U=window.location.pathname.replace("/RITeSchool/MessageCenter/msgCenter/",""),B=e=>{g(!0);const{value:a,name:d,checked:I}=e;var h="";d=="0"?h=a:h=d;const{DetailInfo:b,recieverInfo:C}=l;c(I?{DetailInfo:[...b,a],recieverInfo:[...C,h]}:{DetailInfo:b.filter(x=>x!==a),recieverInfo:C.filter(x=>x!==h)})},N=()=>{const e=l.DetailInfo.join(";"),a=l.recieverInfo.join(";"),d={asSchoolId:f,asMessageRecieverDetailsId:a,asMessageDetailsId:e,asIsArchive:"Y",asIsCompeteDelete:1,asFlag:"Trash"};Z.MoveToTrash(d).then(I=>{U=="Trash"&&(J.success("Message deleted successfully"),T(K(j))),g(!1),c({DetailInfo:[],recieverInfo:[]})}).catch(I=>{alert("error network")})},G=()=>{g(!1),c({DetailInfo:[],recieverInfo:[]})},n=document.getElementById("ScrollableDiv"),Y=()=>{y(u+1)},_=()=>{if(n.scrollTop>=400&&p("flex"),n.scrollTop<400&&p("none"),n.scrollHeight-n.scrollTop<=570){w(!0);const e={asUserId:D,asAcademicYearId:M,asUserRoleId:S,asSchoolId:f,abIsSMSCenter:"0",asFilter:"",asPageIndex:u,asMonthId:"0",asOperator:"",asDate:""};Q.GetTrashList(e).then(a=>{k(a.data)}).catch(a=>{alert("error network")}),Y()}},z=e=>{n.scrollTo({top:0,behavior:"smooth"}),setTimeout(()=>{p("none")},10)};return s.jsxs(s.Fragment,{children:[l.DetailInfo.length!==0?s.jsxs(s.Fragment,{children:[s.jsx(R,{sx:{px:2},children:s.jsxs(R,{display:"flex",justifyContent:"flex-end",children:[s.jsx(E,{color:"primary",endIcon:s.jsx(V,{}),onClick:()=>N(),children:"DELETE"}),"  ",s.jsx(E,{color:"secondary",endIcon:s.jsx(X,{}),onClick:()=>G(),children:"RESET"})]})}),s.jsx("br",{})]}):null,s.jsxs("div",{id:"ScrollableDiv",onScroll:_,style:{position:"absolute",width:"100%",paddingBottom:"100px",height:"570px",overflow:"auto"},children:[F?s.jsx(H,{}):t===null||t.length==0||t==null?s.jsx(ee,{Error:"No message found"}):s.jsx(s.Fragment,{children:t.map((e,a)=>s.jsx(se,{data:e,handleChange:B,check:P,FromRoute:"/Trash"},a))}),s.jsx(q,{sx:{display:L,position:"fixed",bottom:"95px",zIndex:"4",left:"15px",p:"2px",width:50,height:50,backgroundColor:"white",boxShadow:"5px 5px 10px rgba(163, 177, 198, 0.4), -5px -5px 10px rgba(255, 255, 255, 0.3) !important"},onClick:z,children:s.jsx(W,{fontSize:"large",color:"success"})})]})]})}export{Ie as default};

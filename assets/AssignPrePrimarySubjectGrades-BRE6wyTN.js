import{ag as me,u as xe,c as u,r as a,kN as be,kO as D,t as ge,kP as he,j as s,B as v,F as Se,m as S,p as pe,G as i,q as A,H as B,I as z,L as $,bR as T,T as k,ai as je,aj as Ie,ak as fe,al as X,am as x,hh as ye,an as Pe,ii as Le,fz as Oe,kQ as we}from"./index-d5YOjbb6.js";import{S as Ce}from"./Save-QCBiFkbm.js";import{Q as ve}from"./QuestionMark-C2Y4lgD8.js";const Ge=()=>{const E=me(),{EditStatusId:n,ClassName:M,Assesment:V,SelectTerm:b,SubjectName:Y,SubjectId:p,StandardDivisionId:G,selectTeacher:j}=E.state||{},I=Number(localStorage.getItem("localSchoolId")),f=Number(sessionStorage.getItem("AcademicYearId")),g=xe(),H=u(e=>e.AssignPrePrimaryGrades.ISXseedStudentsList),W=u(e=>e.AssignPrePrimaryGrades.ISXseedSubjectSectionList),N=u(e=>e.AssignPrePrimaryGrades.ISXseedGradesList),o=u(e=>e.AssignPrePrimaryGrades.ISListLearningOutcomeDetails),m=u(e=>e.AssignPrePrimaryGrades.ISListObsDetails),y=u(e=>e.AssignPrePrimaryGrades.ISInsertStudentGradesMsg);u(e=>e.AssignPrePrimaryGrades.Loading),localStorage.getItem("localSchoolId");const[d,Q]=a.useState("0"),[l,J]=a.useState("0"),[q,P]=a.useState("0"),[h,L]=a.useState({}),[U,K]=a.useState(""),[Z,_]=a.useState(""),[ee,F]=a.useState(!1),[O,w]=a.useState(""),[se,te]=a.useState(""),[ae,re]=a.useState(""),C={padding:"0.5em 1em"};a.useEffect(()=>{m.length>0&&(K(m[0].LearningOutcomeObsId),_(m[0].subRemark),w(m[0].obs),re(m[0].obs))},[m]),a.useEffect(()=>{const e={asSchoolId:Number(I),asAcademicYearId:Number(f),asStandardDivisionId:Number(G),asAssessmentId:Number(b),asSubjectId:Number(p)};g(be(e))},[]);const R={asSchoolId:Number(I),asAcademicYearId:Number(f),asAssessmentId:Number(b),asSubjectSectionConfigurationId:Number(l),asYearwiseStudentId:Number(d),asSubjectId:Number(p)};a.useEffect(()=>{d!=="0"&&l!=="0"&&(g(D(R)),P("0"))},[d,l]),a.useEffect(()=>{y!==""&&(ge.success(y),g(he()),g(D(R)),P("0"))},[y]),a.useEffect(()=>{if(o.length>0){const e=o.reduce((r,t)=>(r[t.Text1]=`${t.Text4}-${t.Text5}`,r),{});L(e),te(JSON.stringify(e))}},[o]);function ne(e){J(e)}function ie(e){Q(e)}function oe(e){P(e.Value);const r=o.reduce((t,c)=>(t[c.Text1]=`${e.Value}-${c.Text5}`,t),{});L(r)}const de=(e,r,t)=>{L(c=>({...c,[e]:`${r}-${t}`}))};function le(){const e={asSchoolId:Number(I),asAcademicYearId:Number(f),asYearwiseStudentId:Number(d),asLearningOutcomeXML:ce(),asInsertedById:Number(sessionStorage.getItem("Id")),asSubjectSectionConfigurationId:Number(l),asObservation:O,asAssessmentId:Number(b),asLearningOutcomesObservationId:Number(U),asSubjectRemark:Z,asSubjectId:Number(p)};(se!==JSON.stringify(h)||ae!==O)&&g(we(e))}function ce(){let e="";return o.forEach(r=>{const t=r.Text1,c=h[t].split("-")[0],ue=h[t].split("-")[1];e+=`<LearningOutcomes GradeId='${c}' LearningOutcomeConfigId='${t}' LearningOutcomeGradeId='${ue}'/>`}),e=`<LearningOutcomes>${e}</LearningOutcomes>`,e}return s.jsxs(v,{sx:{px:2},children:[s.jsx(Se,{navLinks:[{title:j==="RP"?"Pre-Primary Pro...":"Assign Pre-Pri...",path:j==="RP"?`/RITeSchool/Teacher/PrePrimaryResult/${S(b)}/${S(G)}`:"/RITeSchool/Teacher/AssignPrePrimaryGrades/"+S(b)+"/"+S(j)},{title:"Pre-Primary Progress Report Subject Grades",path:""}],rightActions:s.jsx(s.Fragment,{children:s.jsxs(pe,{direction:{xs:"column",sm:"row"},justifyContent:"space-between",alignItems:"right",gap:1,sx:{mt:{xs:0,sm:0},flexWrap:{xs:"nowrap",sm:"nowrap"}},children:[s.jsx(i,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-end"},children:s.jsx(A,{label:"Class",value:M,sx:{bgcolor:"#F0F0F0",width:{xs:"40vw",sm:"13vw"},"& .MuiInputBase-input":{cursor:"default"}},size:"small",InputProps:{readOnly:!0}})}),s.jsx(i,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-end"},children:s.jsx(A,{label:"Assessment",value:V,sx:{bgcolor:"#F0F0F0",width:{xs:"40vw",sm:"12vw"},"& .MuiInputBase-input":{cursor:"default"}},size:"small",InputProps:{readOnly:!0}})}),s.jsx(i,{item:!0,xs:12,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-end"},children:s.jsx(A,{label:"Subject Name",value:Y,sx:{bgcolor:"#F0F0F0",width:{xs:"40vw",sm:"12vw"},"& .MuiInputBase-input":{cursor:"default"}},size:"small",InputProps:{readOnly:!0}})}),s.jsxs(i,{item:!0,xs:12,gap:1,display:"flex",justifyContent:{xs:"flex-start",sm:"flex-end "},children:[n!=="3"&&n!=="3P"&&d!=="0"&&l!=="0"&&d!==""&&l!==""&&s.jsx(B,{title:"Save",children:s.jsx(z,{onClick:le,sx:{background:$[500],color:"white","&:hover":{backgroundColor:$[600]}},children:s.jsx(Ce,{})})}),s.jsx(B,{title:`Assign grades to each student in the class for the selected subject section and click on "Save".
                                Once grades are submitted to class-teacher you can modify it from xseed results.`,children:s.jsx(z,{sx:{bgcolor:"grey.500",color:"white","&:hover":{bgcolor:"grey.600"}},children:s.jsx(ve,{})})})]})]})})}),s.jsxs(i,{container:!0,spacing:2,children:[s.jsx(i,{item:!0,xs:8,sm:5,md:4,lg:3,children:s.jsx(T,{ItemList:H,defaultValue:d,label:"Student ",sx:{minWidth:"24vw"},size:"small",onChange:ie,mandatory:!0})}),s.jsx(i,{item:!0,xs:8,sm:5,md:4,lg:3,children:s.jsx(T,{ItemList:W,defaultValue:l,label:"Subject Section",sx:{minWidth:"24vw"},size:"small",onChange:ne,mandatory:!0})})]}),n==="3"&&s.jsx(k,{variant:"body1",sx:{textAlign:"center",marginBottom:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white",mt:2},children:s.jsx("b",{children:"Student grades are already submitted."})}),n==="3P"&&s.jsx(k,{variant:"body1",sx:{textAlign:"center",marginBottom:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white",mt:2},children:s.jsx("b",{children:"Results for this assessment has been published. You need to unpublish the assessment to update the grades."})}),d!=="0"&&l!=="0"&&o.length>0&&s.jsxs(v,{sx:{background:"white",p:2,mt:2},children:[s.jsx(je,{component:v,children:s.jsxs(Ie,{"aria-label":"simple table",sx:{border:e=>`1px solid ${e.palette.divider}`},children:[s.jsx(fe,{children:s.jsxs(X,{children:[s.jsx(x,{sx:{textTransform:"capitalize",backgroundColor:e=>e.palette.secondary.main,color:"white",pt:"10px",pb:"10px",minWidth:"60vw"},children:s.jsx("b",{children:"Learning Outcome"})}),s.jsx(x,{sx:{textTransform:"capitalize",backgroundColor:e=>e.palette.secondary.main,color:"white",pt:"10px",pb:"10px"},children:s.jsx("b",{children:"Grade"})}),s.jsx(x,{sx:{textTransform:"capitalize",backgroundColor:e=>e.palette.secondary.main,color:"white",pt:"10px",pb:"10px"},children:s.jsx(ye,{ItemList:N,defaultValue:q,label:"",sx:{maxWidth:"20vw",backgroundColor:"white"},size:"small",disabled:n==="3"||n==="3P",DisableClearable:!0,onChange:oe,mandatory:!0})})]})}),s.jsx(Pe,{children:o.length>0&&o.map((e,r)=>{var t;return s.jsxs(X,{children:[s.jsx(x,{sx:{...C},children:e.Text2}),s.jsx(x,{sx:{...C}}),s.jsx(x,{sx:{...C},children:s.jsx(T,{ItemList:N,defaultValue:(t=h[e.Text1])==null?void 0:t.split("-")[0],label:"",sx:{width:"20vw",backgroundColor:"white",ml:.2},size:"small",disabled:n==="3"||n==="3P",DisableClearable:!0,onChange:c=>de(e.Text1,c,e.Text5),mandatory:!0})})]},r)})})]})}),Le()&&s.jsxs(i,{container:!0,spacing:2,mt:0,alignItems:"center",children:[s.jsx(i,{item:!0,xs:12,sm:6,children:s.jsx(k,{variant:"h5",component:"h3",sx:{marginLeft:"18px"},children:"Facilitator's Observation :"})}),s.jsx(i,{item:!0,xs:12,sm:6,container:!0,justifyContent:"flex-end",children:s.jsx(Oe,{minRows:2,maxRows:4,disabled:n==="3"||n==="3P",style:{backgroundColor:"white",minWidth:"70vw",resize:"vertical",border:"1px solid #d1d5db",outline:ee?"1px solid grey":"none"},value:O,onChange:e=>{const r=e.target.value;r.trim()!==""?w(r):w("")},onFocus:()=>F(!0),onBlur:()=>F(!1),maxLength:1e3})})]})]})]})};export{Ge as default};

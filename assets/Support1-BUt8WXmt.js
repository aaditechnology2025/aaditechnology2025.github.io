import{S as ee,r as s,j as e,G as o,H as v,a8 as te,p as se,bw as re,B as E,I as B,ab as oe,as as le,at as ae,T as C,bx as ne,A as ie,u as ce,E as ue,c as $,by as de,t as me,bz as xe,F as pe,J as D,K as he,L as q,bA as be,q as L,aJ as A,bB as ge,bC as je,bD as fe}from"./index-d5YOjbb6.js";import{d as Se}from"./CloudUpload-DJN1zp2n.js";import{E as ye}from"./Errormessage-RPRSgLGN.js";const Ee=(r,u,d)=>{var i;const j=(i=r==null?void 0:r.name)==null?void 0:i.split(".").at(-1),p=u.map(l=>l.toLowerCase());return!j||!p.includes(j.toLowerCase())?"Invalid file format.":(r==null?void 0:r.size)>d?`File size should be less than ${d/1e6} KB.`:null},Ce=({ValidFileTypes:r,MaxfileSize:u,ChangeFile:d,errorMessage:j="",clickDelete:p=void 0,clickFileName:i=void 0,FileName:l="",FilePath:M="",width:I="300px",viewIcon:w=!1,deleteIcon:k=!1,FileLabel:n="",isMandatory:f=!0,height:F="auto"})=>{ee();const h=s.useRef(null),[m,S]=s.useState("");s.useEffect(()=>{l===""&&(h.current.value=null)},[l]);const R=async c=>{const x=c.target.files;for(let a=0;a<x.length;a++){const y=Ee(x[a],r,u);if(y)S(y),d({Name:"",Value:"",FileExtension:"",ErrorMsg:y}),h.current.value=null;else{const b=await ne(x[a]);S(""),d({Name:x[a].name,Value:b.slice(b.indexOf(",")+1),FileExtension:x[a].name.split(".").at(-1),ErrorMsg:""})}}};return e.jsxs(o,{container:!0,children:[e.jsxs(o,{item:!0,xs:9,sm:12,md:12,lg:12,sx:{display:"flex",alignItems:m?"flex-start":"center",justifyContent:"left",height:"auto"},children:[e.jsx(v,{title:"Supports only "+r.join(", ")+" file types up to "+u/1e6+" KB.",children:e.jsx(te,{sx:{width:I,height:F,border:c=>`1px dashed ${c.colors.primary.main}`,gap:1,position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between"},color:"primary",children:e.jsxs(se,{direction:"row",alignItems:"center",gap:1,sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[l?e.jsx(re,{}):e.jsx(Se,{}),l===""?n||"Attachment":l,f&&e.jsx("span",{style:{color:"red"},children:"*"}),e.jsx(E,{sx:{textAlign:"center"},children:e.jsx("input",{ref:h,type:"file",onChange:R,style:{opacity:0,position:"absolute",top:0,left:0,right:0,bottom:0,cursor:"pointer"}})})]})})}),M!==""&&e.jsxs(o,{item:!0,xs:3,sm:3,md:3,sx:{display:"flex",ml:1},children:[w&&e.jsx(v,{title:"View",children:e.jsx(B,{color:"primary",onClick:i,children:e.jsx(oe,{style:{fontSize:30}})})}),k&&e.jsx(v,{title:"Delete",children:e.jsx(B,{sx:{"&:hover":{color:"red",backgroundColor:le[100]}},onClick:p,children:e.jsx(ae,{style:{fontSize:30}})})})]})]}),m&&e.jsx(o,{item:!0,xs:12,sx:{display:"flex",alignItems:"flex-start",justifyContent:"flex-start",pt:2},children:e.jsx(C,{sx:{ml:0},children:e.jsx(ye,{Error:m})})})]})},ke=()=>{ie();const r=ce(),u=Number(localStorage.getItem("localSchoolId")),d=Number(sessionStorage.getItem("AcademicYearId")),j=sessionStorage.getItem("RoleId"),p=Number(localStorage.getItem("UserId")),[i,l]=s.useState(""),[M,I]=s.useState(""),[w,k]=s.useState(""),[n,f]=s.useState(""),[F,h]=s.useState(sessionStorage.getItem("MobileNumber")),[m,S]=s.useState(""),[R,c]=s.useState(""),[x,a]=s.useState(""),[y,b]=s.useState(""),[V,P]=s.useState(""),z=localStorage.getItem("FolderName"),W=["XLS","XLSX","DOC","DOCX","PDF","JPG","JPEG"],_=2e8,{showAlert:G,closeAlert:T}=s.useContext(ue),N=$(t=>t.Support.getUserDetails),[J,O]=s.useState(""),U=$(t=>t.Support.SaveSupport);s.useEffect(()=>{N&&f(N)},[N]),s.useEffect(()=>{const t={asSchoolId:u,asUserId:p,asRoleId:Number(j)};r(de(t))},[]);const X=()=>{const t={asSchoolId:u,asAcademicYrId:d,asFileName:w,asDescription:m,asEmailAddress:n,asUserId:p,asSaveFeature:"Support",asSubject:i,asMobileNo:F,asBase64String:M,asFolderName:z};G({title:"Please Confirm",message:"Are you sure you want to submit the support request?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:T,onConfirm:()=>{r(je(t)),T()}})},Y=t=>{const g=t.target.value;if(/^[0-9]*$/.test(g)&&g.length<=10){const Z=fe(g);h(g),b(Z)}else b("")},K=()=>{let t=!1;const g=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;n.trim()?n.length>100?(a("Email address should not exceed 100 characters."),t=!0):g.test(n)?a(""):(a("E-mail should be in a valid format (for example: john.smith@yahoo.com)."),t=!0):(a("Email address should not be blank."),t=!0),i.trim()?c(""):(c("Problem subject should not be blank."),t=!0),m.trim()?P(""):(P("Problem description should not be blank."),t=!0),t||X()},H=()=>{l(""),I(""),k(""),O(""),f(n),h(sessionStorage.getItem("MobileNumber")),S(""),c(""),a(""),b(""),P("")};s.useEffect(()=>{U&&(me.success(U),H(),r(xe()))},[U]);const Q=t=>{k(t.Name),I(t.Value)};return e.jsx(e.Fragment,{children:e.jsxs(E,{sx:{px:2},children:[e.jsx(pe,{navLinks:[{title:"Support",path:""}],rightActions:e.jsxs(e.Fragment,{children:[e.jsx(E,{children:e.jsx(v,{title:"Please write us your queries/ problem. We will try our level best to assist you.",children:e.jsx("span",{children:e.jsx(B,{sx:{color:"white",backgroundColor:D[500],height:"36px !important",":hover":{backgroundColor:D[600]}},children:e.jsx(he,{})})})})}),e.jsx(E,{children:e.jsx(v,{title:"Submit",children:e.jsx("span",{children:e.jsx(B,{sx:{color:"white",backgroundColor:q[500],height:"36px !important",":hover":{backgroundColor:q[600]}},onClick:K,children:e.jsx(be,{})})})})})]})}),e.jsxs(o,{sx:{backgroundColor:"white",mb:1,p:1},children:[e.jsx(C,{variant:"h4",gutterBottom:!0,pl:1,children:"Support Request"}),e.jsxs(o,{sx:{backgroundColor:"white",p:1},children:[e.jsxs(C,{variant:"h5",gutterBottom:!0,children:["Dear Teacher, ",e.jsx("br",{})]}),e.jsx(C,{variant:"body1",gutterBottom:!0,children:"Mention the Subject for your Support Request and Description of the problem in detail with exact steps if possible. You may attach a file as a supporting document. It will help our support member to understand the problem in full and speed up resolution of your request."})]})]}),e.jsxs(E,{sx:{backgroundColor:"white",mb:2,p:1},children:[e.jsx(o,{sx:{backgroundColor:"white",p:1},children:e.jsx(C,{variant:"h4",gutterBottom:!0,children:"Write to Us"})}),e.jsxs(o,{container:!0,spacing:2,p:1,children:[e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsx(L,{fullWidth:!0,variant:"outlined",label:e.jsxs("span",{children:["E-mail Address ",e.jsx("span",{style:{color:"red"},children:"*"})]}),value:n,onChange:t=>f(t.target.value)}),e.jsx(A,{Error:x})]}),e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsx(L,{fullWidth:!0,label:"Mobile Number :",variant:"outlined",value:F,onChange:Y}),e.jsx(A,{Error:y})]}),e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsx(L,{fullWidth:!0,label:e.jsxs("span",{children:["Problem Subject ",e.jsx("span",{style:{color:"red"},children:"*"})]}),variant:"outlined",value:i,onChange:t=>l(t.target.value)}),e.jsx(A,{Error:R})]}),e.jsx(o,{item:!0,xs:12,md:6,children:e.jsx(Ce,{ValidFileTypes:W,MaxfileSize:_,ChangeFile:Q,errorMessage:J,FileName:w,FileLabel:"Attachment ",height:"52px",width:"100%",isMandatory:!1})}),e.jsxs(o,{item:!0,xs:12,children:[e.jsx(ge,{label:"Description",value:m,onChange:S,mandatory:!0}),e.jsx(A,{Error:V})]})]})]})]})})};export{ke as default};

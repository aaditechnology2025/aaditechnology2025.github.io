import{j as t,de as Bt,w as Rt,x as ye,A as Mt,u as Pt,ag as Ut,r as s,E as Vt,c as h,mN as Ot,mO as Gt,aL as Fe,mP as Ae,mQ as Ht,mR as zt,t as he,mS as $t,mT as Wt,mU as Yt,B as l,F as _t,m as Jt,H as A,I as w,as as xe,L as we,G as r,T as P,q as fe,aJ as i,bR as qt,ab as Le,at as Qt,iU as Kt,ce as D,bQ as C,mV as Xt,aM as Zt,mW as es,aB as Be}from"./index-d5YOjbb6.js";import{d as ts}from"./Close-DJWwbmdJ.js";import{d as ss}from"./Save-Ckr0NoeK.js";import{R as as}from"./index-BRkymV3U.js";/* empty css                   */import{S as Re}from"./SingleFile-BT4Sw5XK.js";import{R as os}from"./RadioButton1-DBrHHsQv.js";import{S as rs}from"./SelectListHierarchy-2EYf6pPL.js";import{T as Me}from"./TimepickerTwofields-BVuL9CW4.js";import{F as ls}from"./FormGroup-XtcIGgvX.js";import"./CloudUpload-DJN1zp2n.js";import"./Errormessage-RPRSgLGN.js";import"./ButtonStyle-DaPKUawX.js";import"./RadioGroup-CytjzwBe.js";import"./Radio-CCPcjMAp.js";const Pe=({DateValue:o,onDateChange:j,label:N,size:c,fullWidth:m=!0})=>t.jsx(t.Fragment,{children:t.jsx(Bt,{value:o?new Date(o):null,onChange:j,format:"dd MMM yyyy",label:N?t.jsxs(t.Fragment,{children:[N," ",N&&t.jsx("span",{style:{color:"red"},children:"*"})]}):N===""?"":"Select Date",views:["year","month","day"],slotProps:{textField:{variant:"outlined",fullWidth:m,size:c||"medium",inputProps:{readOnly:!0}}}})}),Es=()=>{let{NoticeId:o,selectDisplayType:j}=Rt();o=ye(o),j=ye(j);const N=Mt(),c=Pt();Ut();const m=Number(localStorage.getItem("localSchoolId")),Ue=Number(sessionStorage.getItem("AcademicYearId")),Se=Number(localStorage.getItem("UserId")),Ve=localStorage.getItem("FolderName"),[d,U]=s.useState("1");s.useState("");const[x,L]=s.useState(""),[u,ge]=s.useState("B"),[f,V]=s.useState(new Date().toISOString().split("T")[0]),[b,O]=s.useState(new Date().toISOString().split("T")[0]),[G,H]=s.useState("00:00"),[z,$]=s.useState("23:59"),[I,W]=s.useState(""),[Y,_]=s.useState(""),[Oe,J]=s.useState(""),[pe,B]=s.useState(""),[Ge,q]=s.useState(""),[E,R]=s.useState(""),[He,ze]=s.useState(""),[$e,We]=s.useState(""),[je,Q]=s.useState([]),[Ne,K]=s.useState(""),[k,X]=s.useState(""),[is,be]=s.useState(""),[Ie,T]=s.useState(!1),[Ye,Z]=s.useState(""),[_e,ee]=s.useState(""),[Je,te]=s.useState(""),[qe,se]=s.useState(""),[Qe,v]=s.useState(""),[Ke,ae]=s.useState(""),[Xe,oe]=s.useState(""),[Ze,re]=s.useState(""),[et,le]=s.useState(""),[tt,ie]=s.useState("");s.useState(!1),s.useState(""),s.useState("");const[st,S]=s.useState(!1);s.useState("");const{showAlert:at,closeAlert:Ee}=s.useContext(Vt),[n,g]=s.useState({admin:!1,teacher:!1,student:!1,adminStaff:!1,otherStaff:!1}),ot=[{Value:"1",Name:"File"},{Value:"2",Name:"Text"}],rt=[{Id:1,Name:"Both",Value:"B"},{Id:2,Name:"Control Panel",Value:"C"},{Id:3,Name:"Home Page",Value:"H"}],lt=["PDF","PNG","JPEG","JPG","BMP"],it=3e6,nt=["JPG","JPEG","PNG","BMP"],ct=3e6,ne=h(e=>e.SchoolNoticeForm.AllClassesAndDivisionss),dt=h(e=>e.SchoolNoticeForm.AllClassesAndDivisionss1),De=h(e=>e.SchoolNoticeForm.SaveSchoolNotice),ce=h(e=>e.SchoolNoticeForm.DeleteImageMsg),M=h(e=>e.SchoolNoticeForm.EditSchoolNotice),de=h(e=>e.SchoolNoticeForm.UserRoleselected),me=h(e=>e.SchoolNoticeForm.SelectedStandardAndDivisionCheckBoxx),Ce=h(e=>e.SchoolNoticeForm.getSchoolNoticeIdByName);s.useEffect(()=>{c(Ot({asSchoolId:m,asAcademicYearId:Ue}));const a={asSchoolId:Number(m),asNoticeId:Number(o)};c(Gt(a))},[]);const y=e=>{let a=!1;return de.map(p=>{p.UserRoleId==e&&(a=!0)}),a};s.useEffect(()=>{if(de.length>0){let e={admin:y("1"),teacher:y("2"),student:y("3"),adminStaff:y("6"),otherStaff:y("7")};g(e);const a=Object.values(e).every(p=>p);S(a)}},[de]),s.useEffect(()=>{o==null&&(S(!1),g({admin:!1,teacher:!1,student:!1,adminStaff:!1,otherStaff:!1}))},[o]);const mt=e=>{let a=!1;return me.map(p=>{p.StandardDivisionId==e&&(a=!0)}),a};s.useEffect(()=>{me.length>0&&Q(ne.map(e=>({...e,IsActive:mt(e.Value)})))},[me]),s.useEffect(()=>{j=="true"?(U("2"),T(!0)):(U("1"),T(!1))},[j]),s.useEffect(()=>{if(o!=null&&M.length>0&&M[0]!=null){const e=M[0];L(e.Text1),V(Fe(e.Text2)),H(Ae(e.Text2)),O(Fe(e.Text3)),$(Ae(e.Text3)),ge(e.Text4),X(e.Text5),W(e.Text6),K(e.Text7),_(e.Text8),be(e.Text9),T(e.IsText),R(e.NoticeImage)}},[M]),s.useEffect(()=>{if(o){const e={asSchoolId:m,asNoticeId:Number(o)};c(Ht(e)),c(zt(e))}},[o]);const ue=()=>{let e=[];return je.map(a=>{a.IsActive&&e.push(a.Id)}),e.toString()};ue();const ut=e=>{const a={asSchoolId:Number(m),asNoticeId:Number(e),asIsText:0};E&&at({title:"Please Confirm",message:"Are you sure you want to delete Event Image?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{Ee()},onConfirm:()=>{c(Xt(a)),Ee()}})};s.useEffect(()=>{ce!==""&&(he.success(ce),c($t()),R(""))},[ce]);const ke=()=>{let e="";return e=n.admin?"1,":"",e=e+(n.teacher?"2,":""),e=e+(n.student?"3,":""),e=e+(n.adminStaff?"6,":""),e=e+(n.otherStaff?"7,":""),e=e==""?"":e.substring(0,e.length-1),e};s.useEffect(()=>{const e={asSchoolId:Number(m),asNoticeName:x,asStartDate:f+" "+G,asEndDate:b+" "+z};c(Wt(e))},[x,f,b]);const ht={NoticeId:Number(o||0),asUserRoleIds:ke(),asClassIds:ue(),asSaveFeature:"School Notices",asFolderName:Ve,asBase64String:He,asBase64String2:$e,NoticeName:x,DisplayLocation:u,StartDate:f+" "+G,EndDate:b+" "+z,SortOrder:Number(k),FileName:I==""?null:I,IsSelected:!0,IsText:Ie,NoticeContent:Y,UserId:Se,SchoolId:Number(m),InertedById:Se,NoticeDescription:Ne,NoticeImage:E==""?null:E},xt=()=>{let e=!1;d=="1"&&(x==""?(Z("Link name should not be blank."),e=!0):Z("")),d=="2"&&(x==""?(te("Notice name should not be blank."),e=!0):te("")),ke()?ie(""):(ie("At least one user role should be selected."),e=!0),!ue()&&n.student==!0?(q("At least one class should be selected."),e=!0):q(""),f===""?(re("Please choose a valid start date."),e=!0):re(""),f===null?(ae("Start Date should not be blank."),e=!0):ae(""),Zt(b,f)?(le("End date should be greater than start date."),e=!0):le(""),b==null?(oe("End Date should not be blank."),e=!0):oe(""),d=="1"&&(I==""?(B("Select file to upload."),e=!0):B("")),d=="2"&&(Y==""?(J("Notice content should not be blank."),e=!0):J("")),k===""?(v("Sort order should not be blank."),e=!0):/^\d+$/.test(k)?parseInt(k,10)===0?(v("Sort order cannot be 0."),e=!0):v(""):(v("Sort order should only contain numbers."),e=!0),o||(d=="1"&&(Ce!=null?(ee("Link name already exists."),e=!0):ee("")),d=="2"&&(Ce!=null?(se("Notice name already exists."),e=!0):se(""))),e||c(es(ht))};s.useEffect(()=>{De!=""&&(o?he.success("Notice updated successfully.",{toastId:"success1"}):he.success("School notice added successfully.",{toastId:"success1"}),c(Yt()),N("/RITeSchool/Teacher/SchoolNoticeBasescreen",{state:{fromInternal:!0}}))},[De]);const ft={toolbar:[[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],["bold","italic","underline","strike","blockquote"],[{script:"sub"},{script:"super"}],[{list:"ordered"},{list:"bullet"},{indent:"-1"},{indent:"+1"}],[{color:[]},{background:[]}],["link","image","video"],["clean"]]},St=["header","font","size","bold","italic","underline","strike","blockquote","list","bullet","indent","color","background","link","image","video","script"],gt=e=>{U(e),e=="1"?T(!1):T(!0)},pt=e=>{_(e)},jt=e=>{const{checked:a}=e.target;S(a),g({admin:a,teacher:a,student:a,adminStaff:a,otherStaff:a})},F=e=>{const{name:a,checked:p}=e.target;g(At=>{const ve={...At,[a]:p},wt=Object.values(ve).every(Lt=>Lt);return S(wt),ve})},Nt=()=>{L(""),V(new Date().toISOString().split("T")[0]),O(new Date().toISOString().split("T")[0]),H("00:00"),$("23:59"),X(""),W(""),K(""),_(""),be(""),R(""),S(!1),g({admin:!1,teacher:!1,student:!1,adminStaff:!1,otherStaff:!1}),Z(""),te(""),ee(""),se(""),B(""),ie(""),v(""),q(""),le(""),oe(""),re(""),ae(""),J("")};s.useEffect(()=>{Q(ne)},[ne]);const bt=e=>{Q(e)},It=e=>{H(e)},Et=e=>{$(e)},Dt=e=>{ge(e),e==="H"?(S(!0),g({admin:!0,teacher:!0,student:!0,adminStaff:!0,otherStaff:!0})):(S(!1),g({admin:!1,teacher:!1,student:!1,adminStaff:!1,otherStaff:!1}))},Ct=e=>{V(Be(e))},kt=e=>{O(Be(e))},Tt=e=>{W(e.Name),ze(e.Value),B("")},vt=e=>{R(e.Name),We(e.Value)};let Te=localStorage.getItem("SiteURL")+"/RITeSchool/DOWNLOADS/School Notices/";const yt=()=>{if(E){const e=`${Te}${E}`;window.open(e,"_blank")}},Ft=()=>{if(I){const e=`${Te}${I}`;window.open(e,"_blank")}};return t.jsx(t.Fragment,{children:t.jsxs(l,{sx:{px:2},children:[t.jsx(_t,{navLinks:[{title:"School Notice",path:"/RITeSchool/Teacher/SchoolNoticeBasescreen/"+Jt(Ie)},{title:`${d==="1"?"File":"Text"}`,path:"/RITeSchool/Teacher/AddSchoolNotceFT"}],rightActions:t.jsxs(t.Fragment,{children:[t.jsx(l,{children:t.jsx(A,{title:"Clear",children:t.jsx(w,{sx:{color:"white",backgroundColor:xe[500],height:"36px !important",":hover":{backgroundColor:xe[600]}},onClick:Nt,children:t.jsx(ts,{})})})}),t.jsx(l,{children:t.jsx(A,{title:o!=null?"Update":"Save",children:t.jsx(w,{type:"submit",sx:{color:"white",backgroundColor:we[500],height:"36px !important",":hover":{backgroundColor:we[600]}},onClick:xt,children:t.jsx(ss,{})})})})]})}),t.jsx(r,{sx:{backgroundColor:"white",mb:1,p:1},children:t.jsxs(l,{sx:{display:"flex",alignItems:"center"},children:[t.jsx(P,{variant:"h5",children:"Notice Display Type : "}),t.jsx(os,{Array:ot,ClickRadio:gt,defaultValue:d,Label:""})]})}),t.jsx(l,{sx:{p:2,background:"white"},children:t.jsxs(r,{container:!0,spacing:2,children:[d==="1"?t.jsxs(r,{item:!0,xs:12,sm:4,md:4,lg:6,children:[t.jsx(fe,{fullWidth:!0,label:t.jsxs("span",{children:["Link Name ",t.jsx("span",{style:{color:"red"},children:"*"})]}),multiline:!0,rows:1,value:x,onChange:e=>{const a=e.target.value;a.length<=50&&L(a)}}),t.jsxs(l,{children:[t.jsx(i,{Error:Ye}),t.jsx(i,{Error:_e})]})]}):t.jsxs(r,{item:!0,xs:12,sm:4,md:4,lg:6,children:[t.jsx(fe,{fullWidth:!0,label:t.jsxs("span",{children:["Notice Name ",t.jsx("span",{style:{color:"red"},children:"*"})]}),multiline:!0,rows:1,value:x,onChange:e=>{const a=e.target.value;a.length<=50&&L(a)}}),t.jsx(i,{Error:Je}),t.jsx(i,{Error:qe})]}),t.jsx(r,{item:!0,xs:12,sm:4,md:4,lg:3,children:t.jsx(qt,{sx:{minWidth:"20vw"},ItemList:rt,defaultValue:u,onChange:Dt,label:"Display Location"})}),t.jsxs(r,{item:!0,xs:12,sm:4,md:4,lg:3,children:[t.jsx(fe,{fullWidth:!0,label:t.jsxs("span",{children:["Sort Order ",t.jsx("span",{style:{color:"red"},children:"*"})]}),multiline:!0,rows:1,value:k,onChange:e=>{const a=e.target.value;a.length<=3&&X(a)}}),t.jsx(i,{Error:Qe})]}),t.jsxs(r,{item:!0,xs:12,sm:4,md:4,lg:3,children:[t.jsx(Pe,{DateValue:f,onDateChange:Ct,label:"Start Date",size:"medium"}),t.jsx(i,{Error:Ze}),t.jsx(i,{Error:Ke})]}),t.jsx(r,{item:!0,xs:12,sm:4,md:4,lg:3,children:t.jsx(Me,{Item:G,label:"Start Time",isMandatory:!1,ClickItem:It,size:"medium",tooltipMessage:"e.g. 10:00 AM"})}),t.jsxs(r,{item:!0,xs:12,sm:4,md:4,lg:3,children:[t.jsx(Pe,{DateValue:b,onDateChange:kt,label:"End Date",size:"medium"}),t.jsx(i,{Error:et}),t.jsx(i,{Error:Xe})]}),t.jsx(r,{item:!0,xs:12,sm:4,md:4,lg:3,children:t.jsx(Me,{Item:z,label:"End Time",isMandatory:!1,ClickItem:Et,size:"medium",tooltipMessage:"e.g. 04:00 PM"})}),d==="1"&&t.jsxs(t.Fragment,{children:[t.jsxs(r,{item:!0,xs:10,sm:3,md:3,lg:2.5,children:[t.jsx(Re,{ValidFileTypes:lt,MaxfileSize:it,ChangeFile:Tt,errorMessage:"",FileName:I,FileLabel:"Attachment",width:"100%",height:"52px",isMandatory:!0}),pe&&t.jsx(i,{Error:pe})]}),o!=null&&t.jsx(r,{item:!0,xs:1,sm:1,md:1,lg:.5,children:t.jsx(A,{title:"View",children:t.jsx(w,{onClick:Ft,sx:{color:"#223354",mt:.7,"&:hover":{color:"#223354",cursor:"pointer"}},children:t.jsx(Le,{})})})})]}),t.jsx(r,{item:!0,xs:8,sm:2.3,md:2.5,lg:2,children:t.jsx(Re,{ValidFileTypes:nt,MaxfileSize:ct,ChangeFile:vt,errorMessage:"",FileName:E,FileLabel:"Select Image",width:"100%",height:"52px",isMandatory:!1})}),o!=null&&t.jsx(r,{item:!0,xs:4,sm:1.7,md:1.5,lg:1,children:t.jsxs(t.Fragment,{children:[t.jsx(A,{title:"View",children:t.jsx(w,{onClick:yt,sx:{color:"#223354",mt:.7,"&:hover":{color:"#223354",cursor:"pointer"}},children:t.jsx(Le,{})})}),t.jsx(A,{title:"Delete",children:t.jsx(w,{onClick:()=>ut(Number(o)),sx:{color:"#223354",mt:.7,"&:hover":{color:"red",backgroundColor:xe[100]}},children:t.jsx(Qt,{})})})]})}),t.jsx(r,{item:!0,xs:12,children:t.jsx(Kt,{label:t.jsx(t.Fragment,{children:"Description"}),multiline:!0,value:Ne,onChange:e=>{K(e.target.value)},fullWidth:!0,sx:{resize:"both"}})}),t.jsx(r,{container:!0,spacing:2,pl:1,children:t.jsxs(r,{item:!0,xs:12,sm:12,md:2,mt:2,ml:1,children:[t.jsxs(P,{variant:"h5",p:1,children:["Applicable to: ",t.jsx("span",{style:{color:"red"},children:"*"})]}),t.jsxs(ls,{children:[t.jsx(l,{bgcolor:"lightgrey",pl:2,justifyContent:"flex-start",width:{xs:"100%",sm:"100%",md:"200px"},sx:{display:"flex",alignItems:"center"},children:t.jsx(D,{control:t.jsx(C,{checked:st,onChange:jt,disabled:u==="H"}),label:t.jsx(P,{variant:"h6",children:"Select All"})})}),t.jsxs(l,{gap:1,sx:{ml:1,pl:1,display:"flex",flexDirection:{xs:"column",sm:"column",md:"row"},alignItems:{xs:"flex-start",md:"center"}},children:[t.jsx(l,{width:{xs:"100%",sm:"100%",md:"auto"},children:t.jsx(D,{control:t.jsx(C,{checked:n.admin,onChange:F,disabled:u==="H",name:"admin"}),label:"Admin"})}),t.jsx(l,{width:{xs:"100%",sm:"100%",md:"auto"},children:t.jsx(D,{control:t.jsx(C,{checked:n.teacher,onChange:F,disabled:u==="H",name:"teacher"}),label:"Teacher"})}),t.jsx(l,{width:{xs:"100%",sm:"100%",md:"auto"},children:t.jsx(D,{control:t.jsx(C,{checked:n.student,onChange:F,disabled:u==="H",name:"student"}),label:"Student"})}),t.jsx(l,{width:{xs:"100%",sm:"100%",md:"125px"},children:t.jsx(D,{control:t.jsx(C,{checked:n.adminStaff,onChange:F,disabled:u==="H",name:"adminStaff"}),label:"Admin Staff"})}),t.jsx(l,{width:{xs:"100%",sm:"100%",md:"200px"},children:t.jsx(D,{control:t.jsx(C,{checked:n.otherStaff,onChange:F,disabled:u==="H",name:"otherStaff"}),label:"Other Staff"})})]}),t.jsx(i,{Error:tt})]})]})}),t.jsx(r,{container:!0,pl:2,children:n.student&&t.jsxs(r,{item:!0,xs:12,md:12,mt:1,children:[t.jsxs(P,{variant:"h4",py:1,children:["Associated Classes  ",t.jsx("span",{style:{color:"red"},children:"*"})]}),t.jsx(rs,{ItemList:je,ParentList:dt,ClickChild:bt}),t.jsx(i,{Error:Ge})]})}),d==="1"?null:t.jsx(r,{item:!0,md:12,children:t.jsxs(l,{children:[t.jsx(as,{className:"ql-editor",value:Y,onChange:pt,modules:ft,formats:St,style:{height:"300px",marginBottom:"20px"}}),t.jsx(i,{Error:Oe})]})})]})})]})})};export{Es as default};

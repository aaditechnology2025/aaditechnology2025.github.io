import{j as e,B as c,G as i,H as F,a8 as _,p as $,T as U,q as de,aJ as w,bv as De,aj as we,ak as Fe,al as ae,am as v,an as _e,I as W,as as he,at as Me,bQ as P,w as oe,x as re,u as Ve,r as o,c as S,cX as Le,o_ as Te,o$ as Be,t as Ue,p0 as We,oU as $e,F as Oe,J as ne,L as k,ce as Q,p1 as Re}from"./index-d5YOjbb6.js";import{d as ie}from"./Save-Ckr0NoeK.js";import{d as ce}from"./CloudUpload-DJN1zp2n.js";import{Q as ze}from"./QuestionMark-C2Y4lgD8.js";const He=({files:n,commentError:d,comment:m,setFiles:y,setComment:h,setFileList:x,fileList:A,handleFileChange:b,handleAddFile:I})=>{const l="Select Images",a=t=>{const g=A.filter((E,O)=>O!==t);x(g)};return e.jsxs(c,{pt:2,children:[e.jsxs(i,{container:!0,spacing:2,children:[e.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:4,xl:2,children:e.jsx(F,{title:"Supports files of types - .BMP, .JPG, .JPEG, .PNG with total size upto 10 MB.",children:e.jsxs(_,{sx:{width:"auto",height:52,border:t=>`1px dashed ${t.palette.primary.main}`,gap:1,position:"relative",display:"flex",alignItems:"center",justifyContent:"space-between",color:"primary.main"},component:"label",children:[e.jsxs($,{direction:"row",alignItems:"center",gap:1,sx:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[n.length>0?e.jsx(ce,{sx:{color:"#38548A"}}):e.jsx(ce,{sx:{color:"#38548A"}}),e.jsx(U,{variant:"body2",noWrap:!0,children:n.length>0?n.map(t=>t.name).join(", "):l})]}),e.jsx("input",{type:"file",multiple:!0,style:{display:"none"},onChange:b})]})})}),e.jsxs(i,{item:!0,xs:12,sm:6,md:4,lg:5,xl:4,children:[e.jsx(de,{label:"Comment",variant:"outlined",value:m,onChange:t=>h(t.target.value.slice(0,200)),inputProps:{maxLength:200},fullWidth:!0}),e.jsx(w,{Error:d})]}),e.jsx(i,{item:!0,xs:12,sm:6,md:4,lg:3,xl:2,children:e.jsx(_,{onClick:I,sx:{mt:1,color:"#38548A","&:hover":{color:"#38548A",backgroundColor:De[100]}},children:"Add Photos"})})]}),A.length>0&&e.jsxs(we,{sx:{mt:3,border:1,borderColor:"grey.300"},children:[e.jsx(Fe,{children:e.jsxs(ae,{children:[e.jsx(v,{children:e.jsx(U,{color:"primary",children:e.jsx("strong",{children:"File Names"})})}),e.jsx(v,{children:e.jsx(U,{color:"primary",children:e.jsx("strong",{children:"Comment"})})}),e.jsx(v,{children:e.jsx(U,{color:"primary",children:e.jsx("strong",{children:"Delete"})})})]})}),e.jsx(_e,{children:A.map((t,g)=>e.jsxs(ae,{children:[e.jsxs(v,{children:["  ",e.jsx($,{direction:"row",spacing:1,flexWrap:"wrap",children:t.fileNames})]}),e.jsx(v,{children:t.comment}),e.jsx(v,{children:e.jsx(W,{onClick:()=>a(g),sx:{color:"#38548A	","&:hover":{color:"red",backgroundColor:he[100]}},children:e.jsx(F,{title:"Delete",children:e.jsx(Me,{})})})})]},g))})]})]})},Xe=({ItemList:n,ParentList:d,ClickChild:m})=>{const y=l=>{let a=[];a=n.map(t=>t.Id===l?{...t,IsActive:!t.IsActive}:t),m(a)},h=l=>{d.map(a=>a.Id===l?{...a,IsActive:!a.IsActive}:a),A(l)},x=l=>{let a=[];a=n.map(t=>({...t,IsActive:l})),m(a)},A=l=>{let a=[];a=n.map(t=>t.ParentId==l?{...t,IsActive:!b(l)}:t),m(a)},b=l=>{let a=!0;return n.map(t=>{t.ParentId==l&&!t.IsActive&&(a=!1)}),a},I=()=>{let l=!0;return n.map(a=>{a.IsActive||(l=!1)}),l};return e.jsxs(e.Fragment,{children:[e.jsxs(c,{sx:{backgroundColor:"lightgrey"},children:[e.jsx(P,{checked:I(),onChange:l=>{x(l.target.checked)}}),e.jsx("strong",{children:"Applicable to all staff members and selected Classes "})]}),e.jsx($,{direction:"row",gap:.7,flexWrap:"wrap",children:d.map((l,a)=>e.jsxs(c,{children:[e.jsxs(c,{sx:{borderBottom:"1px solid grey",fontWeight:"bold"},children:[e.jsx(P,{checked:b(l.Id),onChange:()=>{h(l.Id)}}),l.Name]}),n.filter(t=>t.ParentId==l.Id).map((t,g)=>e.jsxs(c,{children:[e.jsx(P,{checked:t.IsActive,onChange:()=>{y(t.Id)}}),t.Name]},g))]},a))})]})},Z=[{Value:"1",Name:"Pre-Primary"},{Value:"2",Name:"Primary"},{Value:"3",Name:"Secondary"}],Ke=()=>{let{galleryName:n}=oe();n=re(n),console.log(n,"galleryName");const d=Ve();o.useState(null);const[m,y]=o.useState([]),[h,x]=o.useState(""),[A,b]=o.useState(""),[I,l]=o.useState(""),[a,t]=o.useState(""),[g,E]=o.useState(""),[O,M]=o.useState(""),[u,f]=o.useState([]),[q,G]=o.useState(!1),[xe,me]=o.useState(!1),[V,N]=o.useState([]),[R,L]=o.useState(""),[ge,z]=o.useState(""),[H,T]=o.useState([]);console.log(u,"fileListðŸ‘ŒðŸ‘ŒðŸ‘Œ",q);const D=Number(localStorage.getItem("localSchoolId")),K=Number(sessionStorage.getItem("AcademicYearId")),ue=Number(localStorage.getItem("UserId")),pe=S(s=>s.EventsManagement.AllClassesAndDivisionss1),ee=S(s=>s.EventsManagement.AllClassesAndDivisionss),X=S(s=>s.PhotoGalllary.IManagePhotoGalleryMsg);S(s=>s.Photo.ISGetPhotoDetils),S(s=>s.PhotoGalllary.IStandardDivisionName),S(s=>s.PhotoGalllary.ISections);const je=S(s=>s.PhotoGalllary.IDivisions);console.log(je,"USDivisions");let{Video_Id:se}=oe();se=re(se);const fe={asSchoolId:D,asAcademicYearId:K};o.useEffect(()=>{d(Le(fe))},[]);const Ce={asSchoolId:D,asSortExp:"ORDER by Update_Date desc",asStartIndex:0,asPageSize:20,asAcademicYearId:K,asGalleryNameFilter:""},Se={asGalleryName:"Special Assembly On Palkhi",asSchoolId:D};o.useEffect(()=>{d(Te(Se))},[]);const ye={asGalleryName:"Special Assembly On Palkhi",asSchoolId:D};o.useEffect(()=>{d(Be(ye))},[]),o.useEffect(()=>{n!=""&&x(n)},[]);const J=String((()=>{let s=[];return m.map(r=>{r.IsActive&&s.push(r.Id)}),s.toString()})());o.useEffect(()=>{y(ee)},[ee]);const Ae=s=>{y(s)},be=s=>{x(s),b(s)},ve=s=>{const p=["image/bmp","image/jpg","application/jpeg","image/png"];if(s.target.files){const j=Array.from(s.target.files),C=j.filter(B=>{const te=B.size<=10485760,le=p.includes(B.type);return te||t("Total file size should be less than 10 MB"),le||t("Please upload a valid file format."),te&&le});C.length,j.length,N(C)}};console.log(V,"files123");const ke=()=>{if(V.length===0){t("At least one file should be selected.");return}if(!R.trim()){z("Please add a comment.");return}const s={fileNames:V.map(r=>r.name),comment:R};T([...H,s]),N([]),L("")},Pe=()=>{let s=0,r="<PhotoGallery>";return H.forEach(p=>{p.fileNames.forEach(j=>{s++,r+=`<PhotoGallery Image_Path="${j}" Image_SrNo="${s}" Comment="${p.comment}" />`})}),r+="</PhotoGallery>",r},Y=async()=>{let s=!0;if(l(""),t(""),M(""),E(""),h.trim()||(l("Gallery name should not be blank."),s=!1),J.trim()||(M("At least one class should be selected."),s=!1),u.length===0&&(E("At least one section should be associated for photo gallery."),s=!1),!s)return;const r={asSchool_Id:D,asOrg_Gallery_Name:"",asGallery_Name:h,asGallery_DetailsXML:Pe(),asInserted_By_id:ue,asAssociatedSection:u.toString(),asClassesIds:J,Gallery_ID:0,asSaveFeature:"Homework",asFolderName:"PPSN Website",asBase64String:"",additionalAttachmentFile:[]};d(Re(r)),xe===!0?(x(h),f(u)):(G(!1),f([]),x("")),L(""),N([]),T([]),l(""),t(""),M(""),E(""),z("")};o.useEffect(()=>{X!==""&&(Ue.success(X),d(We()),d($e(Ce)))},[h,J,u,X]);const Ie=s=>{const{value:r,checked:p}=s.target;f(p?j=>{const C=[...j,r];return C.length===Z.length&&G(!0),C}:j=>{const C=j.filter(B=>B!==r);return G(!1),C})},Ee=s=>{const{checked:r}=s.target;G(r),f(r?Z.map(p=>p.Value):[])},Ge=s=>{const{checked:r}=s.target;me(r)},Ne=()=>{f([]),N([]),T([]),x(""),L(""),l(""),t(""),M(""),E(""),G(!1),z(""),y([])};return e.jsxs(c,{px:2,children:[e.jsx(Oe,{navLinks:[{title:"Photo Video Gallery",path:"/RITeSchool/Teacher/PhotoVideoGalleryBaseScreen"},{title:"Add Photo Gallery",path:""}],rightActions:e.jsxs(e.Fragment,{children:[e.jsx(F,{title:"Create new photo galleries or add photos to existing gallery. You can also view all gallery photos by clicking on Slideshow.",children:e.jsx(W,{sx:{color:"white",backgroundColor:ne[500],"&:hover":{backgroundColor:ne[600]}},children:e.jsx(ze,{})})}),h!==""?e.jsx(e.Fragment,{children:e.jsx(F,{title:"Update Photo",children:e.jsx(W,{sx:{color:"white",backgroundColor:k[500],"&:hover":{backgroundColor:k[600]}},children:e.jsx(ie,{})})})}):e.jsx(F,{title:"Save",children:e.jsx(W,{sx:{color:"white",backgroundColor:k[500],"&:hover":{backgroundColor:k[600]}},onClick:Y,children:e.jsx(ie,{})})})]})}),e.jsxs(c,{padding:2,sx:{backgroundColor:"white"},children:[e.jsxs(i,{container:!0,spacing:2,children:[e.jsxs(i,{item:!0,xs:12,sm:6,children:[e.jsx(de,{fullWidth:!0,inputProps:{maxLength:50},label:e.jsxs("span",{children:["Gallery Name ",e.jsx("span",{style:{color:"red"},children:" *"})]}),variant:"outlined",onChange:s=>{be(s.target.value.slice(0,50))},value:h}),e.jsx(c,{children:e.jsx(w,{Error:I})})]}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(Q,{onChange:Ge,control:e.jsx(P,{}),label:"Add More Photos"})})]}),e.jsx(i,{container:!0,spacing:2,mt:2,ml:.5,children:e.jsxs(i,{xs:12,sm:10,children:[e.jsx(He,{files:V,comment:R,setFiles:N,setComment:L,commentError:ge,setFileList:T,fileList:H,handleFileChange:ve,handleAddFile:ke}),e.jsx(w,{Error:a})]})}),e.jsx(c,{pt:2,children:e.jsxs(c,{children:[e.jsx(Xe,{ItemList:m,ParentList:pe,ClickChild:Ae}),e.jsx(w,{Error:O})]})}),e.jsx(c,{sx:{backgroundColor:"lightgrey",pl:1,mt:2},children:e.jsx(Q,{sx:{mr:0},control:e.jsx(P,{checked:q,onChange:Ee}),label:"Associated Sections"})}),e.jsx(i,{container:!0,spacing:2,alignItems:"center",children:e.jsxs(i,{item:!0,xs:12,children:[e.jsx(c,{pl:1,children:Z.map(s=>e.jsx(Q,{control:e.jsx(P,{value:s.Value,checked:u==null?void 0:u.includes(s.Value),onChange:Ie}),label:s.Name},s.Value))}),e.jsx(w,{Error:g})]})}),e.jsx(i,{item:!0,xs:12,md:12,mt:2,children:e.jsxs($,{direction:"row",gap:2,alignItems:"center",children:[e.jsx(_,{onClick:Ne,sx:{color:"red",":hover":{backgroundColor:he[100]}},children:"Clear"}),h!==""?e.jsx(_,{onClick:Y,sx:{color:"green",":hover":{backgroundColor:k[100]}},children:"Update"}):e.jsx(_,{onClick:Y,sx:{color:"green",":hover":{backgroundColor:k[100]}},children:"Save"})]})})]})]})};export{Ke as default};

import{j as e,B as a,T as c,af as K,c1 as pe,ag as Q,ah as q,ai as C,aj as n,ak as V,I as y,ap as je,aq as Ie,u as fe,ad as De,r as s,z as ye,c as g,os as Ce,ot as R,ou as W,t as z,ov as we,ow as Ne,C as ve,o as H,E as B,F as U,J as X,K as ke,bH as J,av as Ae,ox as Te,oy as Me}from"./index-CpZD2H93.js";import{d as Re}from"./Square-CVQpjtQG.js";import{Q as Be}from"./QuestionMark-B_7MKkiz.js";import{S as Fe}from"./SearchTwoTone-BuZBJscN.js";const Ye=({itemList:i=[],onDelete:h})=>e.jsx(a,{children:i.length===0?e.jsx(c,{variant:"h6",align:"center",color:"blue",sx:{textAlign:"center",marginTop:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:"No Sibling Details are added."}):e.jsx(K,{component:pe,children:e.jsxs(Q,{"aria-label":"simple table",sx:{border:r=>`1px solid ${r.palette.grey[300]}`},children:[e.jsx(q,{children:e.jsxs(C,{sx:{background:r=>r.palette.secondary.main,color:r=>r.palette.common.white},children:[e.jsx(n,{sx:{color:"white",py:1.5},children:e.jsx("b",{children:"Reg. No."})}),e.jsx(n,{sx:{color:"white",py:1.5},children:e.jsx("b",{children:"Student Name"})}),e.jsx(n,{sx:{color:"white",py:1.5},children:e.jsx("b",{children:"Class"})}),e.jsx(n,{sx:{color:"white",py:1.5,textAlign:"center"},children:e.jsx("b",{children:"Delete"})})]})}),e.jsx(V,{children:i.map(r=>e.jsxs(C,{children:[e.jsx(n,{sx:{py:.5},children:r.RegNo}),e.jsx(n,{sx:{py:.5},children:r.StudentName}),e.jsx(n,{sx:{py:.5},children:r.Standard_Name}),e.jsx(n,{sx:{py:.5,textAlign:"center"},children:e.jsx(y,{sx:{color:"#38548A	","&:hover":{color:"red",backgroundColor:je[100]}},onClick:()=>h(r.StudentSiblingId),children:e.jsx(Ie,{})})})]},r.StudentSiblingId))})]})})}),We=()=>{const i=fe();De();const[h,r]=s.useState(""),m=localStorage.getItem("SchoolId"),b=Number(sessionStorage.getItem("AcademicYearId"));sessionStorage.getItem("Id");const F=localStorage.getItem("UserId"),Z=localStorage.getItem("studentData"),I=JSON.parse(Z),{showAlert:ee,closeAlert:Y}=s.useContext(ye),w=g(t=>t.Students.NavigationValues),p=I.YearWise_Student_Id??(w==null?void 0:w.YearWise_Student_Id),N=g(t=>t.GetStandardwiseMinMaxDOB.ISGetStudentDetailsForSibling),te=(N==null?void 0:N.StudentFullName)??(I==null?void 0:I.Name),se=g(t=>t.GetStandardwiseMinMaxDOB.ISGetStudentSiblingList),o=g(t=>t.GetStandardwiseMinMaxDOB.ISGetStudentsList),v=g(t=>t.GetStandardwiseMinMaxDOB.ISSaveStudentSiblingDetailsMsg),k=g(t=>t.GetStandardwiseMinMaxDOB.ISDeleteStudentSiblingDetailsMsg),A={asSchoolId:Number(m),asAcademicYearId:Number(b),asYearwiseStudentId:p};s.useEffect(()=>{const t={asSchoolId:Number(m),asAcademicYearId:Number(b),asYearwiseStudentId:p};i(Ce(t)),i(R(A))},[]);const[l,f]=s.useState([]),[D,E]=s.useState(1),[j,ne]=s.useState(0),[x,ae]=s.useState(20),[P,Pe]=s.useState("RegNo"),[L,Le]=s.useState(!0);s.useState("RegNo");const[T,ie]=s.useState(!1),[G,u]=s.useState(""),re=[20,50,100,200],le=(D-1)*x+1,_=Math.min(D*x,j),oe=Math.ceil(j/x),M=t=>{r(t),ie(!0),u("")},$={asSchoolId:Number(m),asAcademicYearId:Number(b),asYearwiseStudentId:p,asFilter:h.trim()||"",asStartIndex:(D-1)*x,asEndIndex:x,asSortExpression:`${P} ${L?"ASC":"DESC"}`};s.useEffect(()=>{T&&i(W($))},[D,x,P,L,h,T]);const de=t=>{if(t.target.checked){const d=o.map(S=>S.YearwiseStudentId);f(d)}else f([]);u("")},ce=t=>{const d=l.indexOf(t),S=[...l];d===-1?S.push(t):S.splice(d,1),f(S),u("")};s.useEffect(()=>{},[l]);const O=t=>l.indexOf(t)!==-1;s.useEffect(()=>{if(o.length>0){let t=Number(o[0].TotalRows);ne(t)}},[o]);const he=t=>{ae(parseInt(t.target.value,10)),E(1)},xe=t=>{E(t)},ue=()=>{let t=!1;const d=new Date().toLocaleDateString("en-CA"),ge=`<SiblingDetails>${l.map(be=>`<SiblingDetails Yearwise_Student_Id='${p}' YearwiseSiblingStudentId='${be}' Insert_Date='${d}' Update_Date='${d}' />`).join("")}</SiblingDetails>`,me={asSchoolId:Number(m),asAcademicYearId:Number(b),asStudentSiblingsXML:ge,asInsertedById:Number(F),asUpdatedById:Number(F)};!Array.isArray(l)||l.length===0?(u("At least one student should be selected to save as sibling."),t=!0):u(""),t||i(Te(me))};s.useEffect(()=>{v!==""&&(z.success(v),Promise.all([i(we()),i(R(A)),i(W($))]).then(()=>{f([]),u("")}))},[v]);const Se=t=>{const d={asSchoolId:Number(m),asAcademicYearId:Number(b),asYearwiseSiblingStudentId:p,asSiblingStudentId:Number(t)};ee({title:"Please Confirm",message:"Are you sure you want to delete this record?",variant:"warning",confirmButtonText:"Confirm",cancelButtonText:"Cancel",onCancel:()=>{Y()},onConfirm:()=>{i(Me(d)),Y()}})};return s.useEffect(()=>{k!==""&&(z.success(k),i(R(A)),i(Ne()))},[k]),e.jsxs(a,{sx:{px:2},children:[e.jsx(ve,{navLinks:[{title:"Students",path:"/RITeSchool/Teacher/Students"},{title:"Enter Students Details",path:"/RITeSchool/Teacher/StudentRegistrationForms"},{title:"Enter Student Sibling Details",path:"/RITeSchool/Teacher/EnterStudentSiblingDetails"}],rightActions:e.jsxs(e.Fragment,{children:[e.jsx(H,{sx:{width:"18vw",bgcolor:"#F0F0F0"},fullWidth:!0,name:"StudentName",label:"Student Name",value:te||"",InputLabelProps:{shrink:!0},variant:"outlined",size:"small",InputProps:{readOnly:!0}}),e.jsx(B,{title:"Add/Delete student sibling details.",children:e.jsx(y,{sx:{color:"white",backgroundColor:U[500],"&:hover":{backgroundColor:U[600]}},children:e.jsx(Be,{})})}),e.jsx(B,{title:"Save",children:e.jsx(y,{onClick:ue,sx:{color:"white",backgroundColor:X[500],"&:hover":{backgroundColor:X[600]}},children:e.jsx(ke,{})})})]})}),e.jsx(a,{sx:{background:"white",p:1,mb:1},children:e.jsxs(a,{sx:{display:"flex",gap:"20px",alignItems:"center"},children:[e.jsx(c,{variant:"h4",sx:{mb:0,lineHeight:"normal",alignSelf:"center",paddingBottom:"2px"},children:"Legend"}),e.jsx(a,{sx:{display:"flex",gap:"20px"},children:e.jsxs(a,{sx:{display:"flex",gap:1,alignItems:"center"},children:[e.jsx(Re,{style:{color:"#F0F0F0",fontSize:25,position:"relative",top:"-2px",border:"1px solid black",boxSizing:"border-box"}}),e.jsx(c,{variant:"h6",children:"Deactivated User "})]})})]})}),e.jsxs(a,{sx:{backgroundColor:"white",padding:"1rem"},children:[e.jsx(c,{variant:"h4",sx:{py:1},children:"Sibling Details:"}),e.jsx(Ye,{itemList:se,onDelete:Se})]}),e.jsxs(a,{sx:{backgroundColor:"white",pt:1,marginTop:"1rem",pl:2},children:[G&&e.jsx(c,{variant:"h5",style:{color:"red"},children:G}),e.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",width:"100%"},children:[e.jsx(c,{variant:"h4",sx:{alignSelf:"center"},children:"Search for Sibling:"}),e.jsxs(a,{sx:{display:"flex",alignItems:"center",paddingRight:"1rem"},children:[e.jsx(H,{sx:{width:"15vw"},fullWidth:!0,label:e.jsxs("span",{children:["Search by Name / Reg. No.",e.jsx("span",{style:{color:"red"},children:" "})]}),variant:"outlined",size:"small",value:h,onChange:t=>M(t.target.value),onKeyPress:t=>{t.key==="Enter"&&M(h)}}),e.jsx(B,{title:"Search",children:e.jsx(y,{onClick:()=>M(h),sx:{background:t=>t.palette.primary.main,color:"white",marginLeft:"0.5rem","&:hover":{backgroundColor:t=>t.palette.primary.dark}},children:e.jsx(Fe,{})})})]})]})]}),T&&e.jsx(e.Fragment,{children:o.length>0?e.jsx(e.Fragment,{children:e.jsxs(a,{sx:{background:"white",padding:"1rem"},children:[j>0?e.jsx("div",{style:{flex:1,textAlign:"center"},children:e.jsxs(c,{variant:"subtitle1",sx:{margin:"16px 0",textAlign:"center"},children:[e.jsxs(a,{component:"span",fontWeight:"fontWeightBold",children:[le," to ",_]})," ","out of"," ",e.jsx(a,{component:"span",fontWeight:"fontWeightBold",children:j})," ",j===1?"record":"records"]})}):e.jsx("span",{children:" "}),e.jsxs(K,{component:a,children:[e.jsxs(Q,{"aria-label":"simple table",sx:{border:t=>`2px solid ${t.palette.grey[300]}`},children:[e.jsx(q,{children:e.jsxs(C,{sx:{background:t=>t.palette.secondary.main,color:t=>t.palette.common.white},children:[e.jsx(n,{sx:{color:"white",py:1},children:e.jsx(J,{size:"small",indeterminate:l.length>0&&l.length<o.length,checked:o.length>0&&l.length===o.length,onChange:de})}),e.jsx(n,{sx:{color:"white",py:1},children:"Reg. No."}),e.jsx(n,{sx:{color:"white",py:1},children:"Student Name"}),e.jsx(n,{sx:{color:"white",py:1},children:"Class"})]})}),e.jsx(V,{children:o.map(t=>e.jsxs(C,{selected:O(t.YearwiseStudentId),children:[e.jsx(n,{sx:{py:.5},children:e.jsx(J,{size:"small",checked:O(t.YearwiseStudentId),onChange:()=>ce(t.YearwiseStudentId)})}),e.jsx(n,{sx:{py:.5},children:t.RegNo}),e.jsx(n,{sx:{py:.5},children:t.StudentName}),e.jsx(n,{sx:{py:.5},children:t.ClassName})]},t.YearwiseStudentId))})]}),_>19?e.jsx(Ae,{rowsPerPage:x,ChangeRowsPerPage:he,rowsPerPageOptions:re,PageChange:xe,pagecount:oe}):e.jsx("span",{})]})]})}):e.jsx(a,{sx:{backgroundColor:"#D2FDFC"},children:e.jsx(c,{variant:"h6",align:"center",color:"blue",sx:{textAlign:"center",marginTop:1,backgroundColor:"#324b84",padding:1,borderRadius:2,color:"white"},children:"No record found."})})})]})};export{We as default};
